
START 4746639: Thu 12 Oct 2023 02:22:01 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/annotated/cleaned2_train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/annotated/cleaned2_test_annotated_dataset.jsonl', dev='../../data/qa_token_classification/annotated/cleaned2_dev_annotated_dataset.jsonl', batch=8, epochs=10, lr=3e-05, save='fi_fi_3e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 50
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 68
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 1.04, 'learning_rate': 2.423076923076923e-05, 'epoch': 1.92}
              precision    recall  f1-score   support

       NSWER       0.00      0.00      0.00        40
     UESTION       0.00      0.00      0.00        46

   micro avg       0.00      0.00      0.00        86
   macro avg       0.00      0.00      0.00        86
weighted avg       0.00      0.00      0.00        86

{'eval_loss': 0.9052482843399048, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.5737647877522617, 'eval_runtime': 0.5426, 'eval_samples_per_second': 92.152, 'eval_steps_per_second': 7.372, 'epoch': 1.92}
{'loss': 0.6478, 'learning_rate': 1.8461538461538465e-05, 'epoch': 3.85}
              precision    recall  f1-score   support

       NSWER       0.05      0.23      0.08        40
     UESTION       0.07      0.17      0.10        46

   micro avg       0.06      0.20      0.09        86
   macro avg       0.06      0.20      0.09        86
weighted avg       0.06      0.20      0.09        86

{'eval_loss': 0.7064797282218933, 'eval_precision': 0.05782312925170068, 'eval_recall': 0.19767441860465115, 'eval_f1': 0.08947368421052633, 'eval_accuracy': 0.7210623985154256, 'eval_runtime': 0.5261, 'eval_samples_per_second': 95.034, 'eval_steps_per_second': 7.603, 'epoch': 3.85}
{'loss': 0.3519, 'learning_rate': 1.2692307692307693e-05, 'epoch': 5.77}
              precision    recall  f1-score   support

       NSWER       0.10      0.40      0.16        40
     UESTION       0.09      0.28      0.14        46

   micro avg       0.09      0.34      0.15        86
   macro avg       0.09      0.34      0.15        86
weighted avg       0.09      0.34      0.15        86

{'eval_loss': 0.7872616648674011, 'eval_precision': 0.09385113268608414, 'eval_recall': 0.3372093023255814, 'eval_f1': 0.14683544303797466, 'eval_accuracy': 0.700649501275806, 'eval_runtime': 0.5413, 'eval_samples_per_second': 92.366, 'eval_steps_per_second': 7.389, 'epoch': 5.77}
{'loss': 0.1365, 'learning_rate': 6.923076923076923e-06, 'epoch': 7.69}
              precision    recall  f1-score   support

       NSWER       0.13      0.42      0.20        40
     UESTION       0.14      0.33      0.19        46

   micro avg       0.14      0.37      0.20        86
   macro avg       0.14      0.38      0.20        86
weighted avg       0.14      0.37      0.20        86

{'eval_loss': 0.9571672081947327, 'eval_precision': 0.13617021276595745, 'eval_recall': 0.37209302325581395, 'eval_f1': 0.19937694704049846, 'eval_accuracy': 0.697981906750174, 'eval_runtime': 0.5326, 'eval_samples_per_second': 93.878, 'eval_steps_per_second': 7.51, 'epoch': 7.69}
{'loss': 0.0642, 'learning_rate': 1.153846153846154e-06, 'epoch': 9.62}
              precision    recall  f1-score   support

       NSWER       0.14      0.45      0.21        40
     UESTION       0.29      0.59      0.39        46

   micro avg       0.20      0.52      0.29        86
   macro avg       0.21      0.52      0.30        86
weighted avg       0.22      0.52      0.31        86

{'eval_loss': 1.049667477607727, 'eval_precision': 0.20179372197309417, 'eval_recall': 0.5232558139534884, 'eval_f1': 0.2912621359223301, 'eval_accuracy': 0.7125956854558108, 'eval_runtime': 0.5351, 'eval_samples_per_second': 93.438, 'eval_steps_per_second': 7.475, 'epoch': 9.62}
{'train_runtime': 46.7679, 'train_samples_per_second': 21.382, 'train_steps_per_second': 2.78, 'train_loss': 0.4323270667057771, 'epoch': 10.0}
saved model
              precision    recall  f1-score   support

       NSWER       0.04      0.16      0.06        58
     UESTION       0.08      0.25      0.12        73

   micro avg       0.06      0.21      0.09       131
   macro avg       0.06      0.20      0.09       131
weighted avg       0.06      0.21      0.09       131

{'epoch': 10.0,
 'eval_accuracy': 0.6936561659290116,
 'eval_f1': 0.0923076923076923,
 'eval_loss': 0.7469608783721924,
 'eval_precision': 0.05947136563876652,
 'eval_recall': 0.20610687022900764,
 'eval_runtime': 0.7039,
 'eval_samples_per_second': 96.609,
 'eval_steps_per_second': 7.104}
Accuracy: 0.6936561659290116
END 4746639: Thu 12 Oct 2023 02:23:29 PM EEST
