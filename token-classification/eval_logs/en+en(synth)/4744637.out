START 4744637: Thu 12 Oct 2023 10:57:34 AM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2'], test='../../data/qa_token_classification/dataset_punct2', dev='../../data/qa_token_classification/dataset_punct2', batch=8, epochs=10, lr=3e-05, save=None, dataset=None)
0
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1114, 'learning_rate': 2.95544466227054e-05, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.60      0.77      0.67      1659
     UESTION       0.61      0.78      0.68      1683

   micro avg       0.61      0.77      0.68      3342
   macro avg       0.61      0.77      0.68      3342
weighted avg       0.61      0.77      0.68      3342

{'eval_loss': 0.14547714591026306, 'eval_precision': 0.6053064099553885, 'eval_recall': 0.7713943746259725, 'eval_f1': 0.6783317984475726, 'eval_accuracy': 0.9575316721689323, 'eval_runtime': 24.1401, 'eval_samples_per_second': 69.718, 'eval_steps_per_second': 4.391, 'epoch': 0.15}
{'loss': 0.0741, 'learning_rate': 2.91088932454108e-05, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.76      0.86      0.81      1659
     UESTION       0.76      0.86      0.80      1683

   micro avg       0.76      0.86      0.80      3342
   macro avg       0.76      0.86      0.80      3342
weighted avg       0.76      0.86      0.80      3342

{'eval_loss': 0.08041752874851227, 'eval_precision': 0.7583465818759937, 'eval_recall': 0.8563734290843806, 'eval_f1': 0.8043844856661047, 'eval_accuracy': 0.9754076478409004, 'eval_runtime': 24.0786, 'eval_samples_per_second': 69.896, 'eval_steps_per_second': 4.402, 'epoch': 0.3}
{'loss': 0.0648, 'learning_rate': 2.86633398681162e-05, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.82      0.87      0.84      1659
     UESTION       0.82      0.87      0.84      1683

   micro avg       0.82      0.87      0.84      3342
   macro avg       0.82      0.87      0.84      3342
weighted avg       0.82      0.87      0.84      3342

{'eval_loss': 0.10559879243373871, 'eval_precision': 0.8203169213355971, 'eval_recall': 0.8674446439257929, 'eval_f1': 0.8432228039557883, 'eval_accuracy': 0.9760816643714862, 'eval_runtime': 24.1775, 'eval_samples_per_second': 69.61, 'eval_steps_per_second': 4.384, 'epoch': 0.45}
{'loss': 0.0566, 'learning_rate': 2.82177864908216e-05, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.81      0.89      0.85      1659
     UESTION       0.80      0.88      0.84      1683

   micro avg       0.81      0.88      0.84      3342
   macro avg       0.81      0.88      0.84      3342
weighted avg       0.81      0.88      0.84      3342

{'eval_loss': 0.08442007750272751, 'eval_precision': 0.8057455540355677, 'eval_recall': 0.8812088569718731, 'eval_f1': 0.8417893382878376, 'eval_accuracy': 0.9785794903377748, 'eval_runtime': 24.0637, 'eval_samples_per_second': 69.939, 'eval_steps_per_second': 4.405, 'epoch': 0.59}
{'loss': 0.0538, 'learning_rate': 2.7772233113527e-05, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.83      0.89      0.86      1659
     UESTION       0.82      0.88      0.85      1683

   micro avg       0.83      0.88      0.85      3342
   macro avg       0.83      0.88      0.85      3342
weighted avg       0.83      0.88      0.85      3342

{'eval_loss': 0.07635395228862762, 'eval_precision': 0.8263187429854096, 'eval_recall': 0.8812088569718731, 'eval_f1': 0.8528815522733854, 'eval_accuracy': 0.9798297249219594, 'eval_runtime': 24.3544, 'eval_samples_per_second': 69.104, 'eval_steps_per_second': 4.352, 'epoch': 0.74}
{'loss': 0.0553, 'learning_rate': 2.7326679736232404e-05, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.87      0.89      0.88      1659
     UESTION       0.86      0.89      0.88      1683

   micro avg       0.86      0.89      0.88      3342
   macro avg       0.86      0.89      0.88      3342
weighted avg       0.86      0.89      0.88      3342

{'eval_loss': 0.08410438150167465, 'eval_precision': 0.8649041255084253, 'eval_recall': 0.8907839616995811, 'eval_f1': 0.8776533018867926, 'eval_accuracy': 0.9817777648554565, 'eval_runtime': 24.4719, 'eval_samples_per_second': 68.773, 'eval_steps_per_second': 4.331, 'epoch': 0.89}
{'loss': 0.0506, 'learning_rate': 2.68811263589378e-05, 'epoch': 1.04}
              precision    recall  f1-score   support

       NSWER       0.85      0.90      0.87      1659
     UESTION       0.85      0.89      0.87      1683

   micro avg       0.85      0.89      0.87      3342
   macro avg       0.85      0.89      0.87      3342
weighted avg       0.85      0.89      0.87      3342

{'eval_loss': 0.06985767930746078, 'eval_precision': 0.8484246380925348, 'eval_recall': 0.8943746259724715, 'eval_f1': 0.8707938820101966, 'eval_accuracy': 0.9831390139270317, 'eval_runtime': 24.1246, 'eval_samples_per_second': 69.763, 'eval_steps_per_second': 4.394, 'epoch': 1.04}
{'loss': 0.0401, 'learning_rate': 2.64355729816432e-05, 'epoch': 1.19}
              precision    recall  f1-score   support

       NSWER       0.83      0.89      0.86      1659
     UESTION       0.83      0.89      0.86      1683

   micro avg       0.83      0.89      0.86      3342
   macro avg       0.83      0.89      0.86      3342
weighted avg       0.83      0.89      0.86      3342

{'eval_loss': 0.0825900062918663, 'eval_precision': 0.8306745032185838, 'eval_recall': 0.8880909634949132, 'eval_f1': 0.8584237165582067, 'eval_accuracy': 0.976969780270611, 'eval_runtime': 24.0372, 'eval_samples_per_second': 70.016, 'eval_steps_per_second': 4.41, 'epoch': 1.19}
{'loss': 0.0396, 'learning_rate': 2.59900196043486e-05, 'epoch': 1.34}
              precision    recall  f1-score   support

       NSWER       0.86      0.90      0.88      1659
     UESTION       0.86      0.89      0.87      1683

   micro avg       0.86      0.90      0.88      3342
   macro avg       0.86      0.90      0.88      3342
weighted avg       0.86      0.90      0.88      3342

{'eval_loss': 0.07007898390293121, 'eval_precision': 0.8563662374821173, 'eval_recall': 0.895571514063435, 'eval_f1': 0.8755302033055433, 'eval_accuracy': 0.9826632375525006, 'eval_runtime': 24.2481, 'eval_samples_per_second': 69.407, 'eval_steps_per_second': 4.371, 'epoch': 1.34}
{'loss': 0.0382, 'learning_rate': 2.5544466227054e-05, 'epoch': 1.49}
              precision    recall  f1-score   support

       NSWER       0.86      0.90      0.88      1659
     UESTION       0.86      0.89      0.88      1683

   micro avg       0.86      0.90      0.88      3342
   macro avg       0.86      0.90      0.88      3342
weighted avg       0.86      0.90      0.88      3342

{'eval_loss': 0.08579759299755096, 'eval_precision': 0.8570610140360928, 'eval_recall': 0.8952722920406941, 'eval_f1': 0.8757500365871506, 'eval_accuracy': 0.9804059429755583, 'eval_runtime': 24.3975, 'eval_samples_per_second': 68.982, 'eval_steps_per_second': 4.345, 'epoch': 1.49}
{'loss': 0.0375, 'learning_rate': 2.5098912849759405e-05, 'epoch': 1.63}
              precision    recall  f1-score   support

       NSWER       0.87      0.90      0.88      1659
     UESTION       0.87      0.90      0.88      1683

   micro avg       0.87      0.90      0.88      3342
   macro avg       0.87      0.90      0.88      3342
weighted avg       0.87      0.90      0.88      3342

{'eval_loss': 0.09015589207410812, 'eval_precision': 0.8696407879490151, 'eval_recall': 0.8982645122681029, 'eval_f1': 0.883720930232558, 'eval_accuracy': 0.9821240243280319, 'eval_runtime': 23.9329, 'eval_samples_per_second': 70.322, 'eval_steps_per_second': 4.429, 'epoch': 1.63}
{'loss': 0.0394, 'learning_rate': 2.46533594724648e-05, 'epoch': 1.78}
              precision    recall  f1-score   support

       NSWER       0.86      0.90      0.88      1659
     UESTION       0.86      0.90      0.88      1683

   micro avg       0.86      0.90      0.88      3342
   macro avg       0.86      0.90      0.88      3342
weighted avg       0.86      0.90      0.88      3342

{'eval_loss': 0.07126032561063766, 'eval_precision': 0.8586059743954481, 'eval_recall': 0.9030520646319569, 'eval_f1': 0.8802683389237275, 'eval_accuracy': 0.9832526716165031, 'eval_runtime': 24.0026, 'eval_samples_per_second': 70.117, 'eval_steps_per_second': 4.416, 'epoch': 1.78}
{'train_runtime': 6150.9923, 'train_samples_per_second': 218.921, 'train_steps_per_second': 27.366, 'train_loss': 0.05512840779622396, 'epoch': 1.78}
              precision    recall  f1-score   support

       NSWER       0.86      0.89      0.88      5623
     UESTION       0.85      0.89      0.87      5693

   micro avg       0.86      0.89      0.87     11316
   macro avg       0.86      0.89      0.87     11316
weighted avg       0.86      0.89      0.87     11316

{'epoch': 1.78,
 'eval_accuracy': 0.9820394433136584,
 'eval_f1': 0.8732248008313127,
 'eval_loss': 0.06630601733922958,
 'eval_precision': 0.8560271646859083,
 'eval_recall': 0.8911276069282432,
 'eval_runtime': 82.5388,
 'eval_samples_per_second': 68.974,
 'eval_steps_per_second': 4.313}
Accuracy: 0.9820394433136584
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	3e-5	num_train_epochs	10	END 4744637: Thu 12 Oct 2023 12:46:39 PM EEST
