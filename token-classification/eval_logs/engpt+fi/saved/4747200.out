
START 4747200: Thu 12 Oct 2023 02:59:35 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl'], test='../../data/qa_token_classification/annotated/cleaned2_test_annotated_dataset.jsonl', dev='../../data/qa_token_classification/annotated/cleaned2_dev_annotated_dataset.jsonl', batch=8, epochs=10, lr=2e-05, save='engpt_fi_2e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138082
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138082
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 50
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 68
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1342, 'learning_rate': 1.9710329644864146e-05, 'epoch': 0.14}
              precision    recall  f1-score   support

       NSWER       0.01      0.03      0.01        40
     UESTION       0.02      0.04      0.02        46

   micro avg       0.01      0.03      0.02        86
   macro avg       0.01      0.03      0.02        86
weighted avg       0.01      0.03      0.02        86

{'eval_loss': 0.9171821475028992, 'eval_precision': 0.011857707509881422, 'eval_recall': 0.03488372093023256, 'eval_f1': 0.017699115044247787, 'eval_accuracy': 0.538854094177685, 'eval_runtime': 0.5583, 'eval_samples_per_second': 89.562, 'eval_steps_per_second': 7.165, 'epoch': 0.14}
{'loss': 0.0833, 'learning_rate': 1.942065928972829e-05, 'epoch': 0.29}
              precision    recall  f1-score   support

       NSWER       0.12      0.17      0.14        40
     UESTION       0.13      0.20      0.16        46

   micro avg       0.13      0.19      0.15        86
   macro avg       0.13      0.19      0.15        86
weighted avg       0.13      0.19      0.15        86

{'eval_loss': 0.8120493292808533, 'eval_precision': 0.12598425196850394, 'eval_recall': 0.18604651162790697, 'eval_f1': 0.15023474178403756, 'eval_accuracy': 0.7120157736024124, 'eval_runtime': 0.5472, 'eval_samples_per_second': 91.368, 'eval_steps_per_second': 7.309, 'epoch': 0.29}
{'loss': 0.0754, 'learning_rate': 1.9130988934592435e-05, 'epoch': 0.43}
              precision    recall  f1-score   support

       NSWER       0.07      0.15      0.09        40
     UESTION       0.16      0.24      0.19        46

   micro avg       0.10      0.20      0.14        86
   macro avg       0.11      0.19      0.14        86
weighted avg       0.11      0.20      0.14        86

{'eval_loss': 0.5964962840080261, 'eval_precision': 0.10493827160493827, 'eval_recall': 0.19767441860465115, 'eval_f1': 0.13709677419354838, 'eval_accuracy': 0.7602644398051496, 'eval_runtime': 1.5577, 'eval_samples_per_second': 32.098, 'eval_steps_per_second': 2.568, 'epoch': 0.43}
{'loss': 0.0705, 'learning_rate': 1.884131857945658e-05, 'epoch': 0.58}
              precision    recall  f1-score   support

       NSWER       0.05      0.15      0.07        40
     UESTION       0.23      0.30      0.26        46

   micro avg       0.11      0.23      0.15        86
   macro avg       0.14      0.23      0.17        86
weighted avg       0.15      0.23      0.18        86

{'eval_loss': 0.596627950668335, 'eval_precision': 0.10869565217391304, 'eval_recall': 0.23255813953488372, 'eval_f1': 0.14814814814814814, 'eval_accuracy': 0.7468104848063094, 'eval_runtime': 1.5418, 'eval_samples_per_second': 32.429, 'eval_steps_per_second': 2.594, 'epoch': 0.58}
{'loss': 0.0652, 'learning_rate': 1.8551648224320723e-05, 'epoch': 0.72}
              precision    recall  f1-score   support

       NSWER       0.01      0.05      0.02        40
     UESTION       0.10      0.11      0.11        46

   micro avg       0.04      0.08      0.05        86
   macro avg       0.06      0.08      0.06        86
weighted avg       0.06      0.08      0.07        86

{'eval_loss': 0.8703194260597229, 'eval_precision': 0.035897435897435895, 'eval_recall': 0.08139534883720931, 'eval_f1': 0.049822064056939494, 'eval_accuracy': 0.6247970308513106, 'eval_runtime': 0.5415, 'eval_samples_per_second': 92.337, 'eval_steps_per_second': 7.387, 'epoch': 0.72}
{'loss': 0.0641, 'learning_rate': 1.8261977869184867e-05, 'epoch': 0.87}
              precision    recall  f1-score   support

       NSWER       0.29      0.42      0.34        40
     UESTION       0.20      0.37      0.26        46

   micro avg       0.24      0.40      0.30        86
   macro avg       0.25      0.40      0.30        86
weighted avg       0.24      0.40      0.30        86

{'eval_loss': 0.697784423828125, 'eval_precision': 0.23776223776223776, 'eval_recall': 0.3953488372093023, 'eval_f1': 0.296943231441048, 'eval_accuracy': 0.7727905358385525, 'eval_runtime': 0.5722, 'eval_samples_per_second': 87.389, 'eval_steps_per_second': 6.991, 'epoch': 0.87}
{'loss': 0.0635, 'learning_rate': 1.7972307514049015e-05, 'epoch': 1.01}
              precision    recall  f1-score   support

       NSWER       0.23      0.50      0.32        40
     UESTION       0.26      0.46      0.33        46

   micro avg       0.25      0.48      0.33        86
   macro avg       0.25      0.48      0.33        86
weighted avg       0.25      0.48      0.33        86

{'eval_loss': 0.6056137681007385, 'eval_precision': 0.2469879518072289, 'eval_recall': 0.47674418604651164, 'eval_f1': 0.32539682539682535, 'eval_accuracy': 0.7846207376478775, 'eval_runtime': 0.5386, 'eval_samples_per_second': 92.841, 'eval_steps_per_second': 7.427, 'epoch': 1.01}
{'loss': 0.0494, 'learning_rate': 1.768263715891316e-05, 'epoch': 1.16}
              precision    recall  f1-score   support

       NSWER       0.26      0.42      0.32        40
     UESTION       0.28      0.37      0.32        46

   micro avg       0.27      0.40      0.32        86
   macro avg       0.27      0.40      0.32        86
weighted avg       0.27      0.40      0.32        86

{'eval_loss': 0.5561201572418213, 'eval_precision': 0.2677165354330709, 'eval_recall': 0.3953488372093023, 'eval_f1': 0.3192488262910798, 'eval_accuracy': 0.7367200185571793, 'eval_runtime': 0.6138, 'eval_samples_per_second': 81.463, 'eval_steps_per_second': 6.517, 'epoch': 1.16}
{'loss': 0.0514, 'learning_rate': 1.7392966803777304e-05, 'epoch': 1.3}
              precision    recall  f1-score   support

       NSWER       0.10      0.20      0.13        40
     UESTION       0.41      0.41      0.41        46

   micro avg       0.22      0.31      0.26        86
   macro avg       0.26      0.31      0.27        86
weighted avg       0.27      0.31      0.28        86

{'eval_loss': 0.957958996295929, 'eval_precision': 0.216, 'eval_recall': 0.313953488372093, 'eval_f1': 0.2559241706161137, 'eval_accuracy': 0.6602876362792856, 'eval_runtime': 0.521, 'eval_samples_per_second': 95.962, 'eval_steps_per_second': 7.677, 'epoch': 1.3}
{'loss': 0.0487, 'learning_rate': 1.7103296448641448e-05, 'epoch': 1.45}
              precision    recall  f1-score   support

       NSWER       0.21      0.65      0.32        40
     UESTION       0.46      0.59      0.51        46

   micro avg       0.29      0.62      0.40        86
   macro avg       0.34      0.62      0.42        86
weighted avg       0.34      0.62      0.43        86

{'eval_loss': 0.7676005363464355, 'eval_precision': 0.29444444444444445, 'eval_recall': 0.6162790697674418, 'eval_f1': 0.39849624060150374, 'eval_accuracy': 0.7272094641614475, 'eval_runtime': 1.5841, 'eval_samples_per_second': 31.563, 'eval_steps_per_second': 2.525, 'epoch': 1.45}
{'loss': 0.0468, 'learning_rate': 1.6813626093505592e-05, 'epoch': 1.59}
              precision    recall  f1-score   support

       NSWER       0.22      0.35      0.27        40
     UESTION       0.25      0.30      0.28        46

   micro avg       0.24      0.33      0.27        86
   macro avg       0.24      0.33      0.27        86
weighted avg       0.24      0.33      0.27        86

{'eval_loss': 0.6888037323951721, 'eval_precision': 0.23529411764705882, 'eval_recall': 0.32558139534883723, 'eval_f1': 0.2731707317073171, 'eval_accuracy': 0.7034330781721179, 'eval_runtime': 0.5573, 'eval_samples_per_second': 89.723, 'eval_steps_per_second': 7.178, 'epoch': 1.59}
{'loss': 0.0496, 'learning_rate': 1.6523955738369737e-05, 'epoch': 1.74}
              precision    recall  f1-score   support

       NSWER       0.09      0.28      0.13        40
     UESTION       0.13      0.30      0.18        46

   micro avg       0.11      0.29      0.15        86
   macro avg       0.11      0.29      0.16        86
weighted avg       0.11      0.29      0.16        86

{'eval_loss': 0.5673516988754272, 'eval_precision': 0.10548523206751055, 'eval_recall': 0.29069767441860467, 'eval_f1': 0.15479876160990713, 'eval_accuracy': 0.7393876130828114, 'eval_runtime': 0.5633, 'eval_samples_per_second': 88.762, 'eval_steps_per_second': 7.101, 'epoch': 1.74}
{'loss': 0.0451, 'learning_rate': 1.623428538323388e-05, 'epoch': 1.88}
              precision    recall  f1-score   support

       NSWER       0.12      0.23      0.15        40
     UESTION       0.19      0.33      0.24        46

   micro avg       0.15      0.28      0.20        86
   macro avg       0.16      0.28      0.20        86
weighted avg       0.16      0.28      0.20        86

{'eval_loss': 0.5795838832855225, 'eval_precision': 0.15483870967741936, 'eval_recall': 0.27906976744186046, 'eval_f1': 0.19917012448132781, 'eval_accuracy': 0.7238459754117375, 'eval_runtime': 0.5267, 'eval_samples_per_second': 94.923, 'eval_steps_per_second': 7.594, 'epoch': 1.88}
{'train_runtime': 6415.5546, 'train_samples_per_second': 215.23, 'train_steps_per_second': 26.905, 'train_loss': 0.06516536043607271, 'epoch': 1.88}
saved model
              precision    recall  f1-score   support

       NSWER       0.29      0.43      0.34        58
     UESTION       0.46      0.56      0.51        73

   micro avg       0.38      0.50      0.43       131
   macro avg       0.37      0.50      0.43       131
weighted avg       0.38      0.50      0.43       131

{'epoch': 1.88,
 'eval_accuracy': 0.8153258699991321,
 'eval_f1': 0.4299674267100977,
 'eval_loss': 0.4796077609062195,
 'eval_precision': 0.375,
 'eval_recall': 0.5038167938931297,
 'eval_runtime': 0.7846,
 'eval_samples_per_second': 86.67,
 'eval_steps_per_second': 6.373}
Accuracy: 0.8153258699991321
END 4747200: Thu 12 Oct 2023 04:53:40 PM EEST
