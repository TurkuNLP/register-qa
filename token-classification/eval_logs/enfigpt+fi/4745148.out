START 4745148: Thu 12 Oct 2023 11:56:32 AM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl', '../../data/qa_token_classification/annotated/train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/annotated/test_annotated_dataset.jsonl', dev='../../data/qa_token_classification/annotated/dev_annotated_dataset.jsonl', batch=8, epochs=10, lr=2e-05, save=None, dataset=None)
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
in dictionary: 2
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138182
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138182
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 50
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 68
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1302, 'learning_rate': 1.9710530886354428e-05, 'epoch': 0.14}
              precision    recall  f1-score   support

       NSWER       0.00      0.00      0.00        40
     UESTION       0.03      0.04      0.04        46

   micro avg       0.02      0.02      0.02        86
   macro avg       0.02      0.02      0.02        86
weighted avg       0.02      0.02      0.02        86

{'eval_loss': 1.331284761428833, 'eval_precision': 0.023255813953488372, 'eval_recall': 0.023255813953488372, 'eval_f1': 0.02325581395348837, 'eval_accuracy': 0.49367248797772717, 'eval_runtime': 0.5197, 'eval_samples_per_second': 96.203, 'eval_steps_per_second': 7.696, 'epoch': 0.14}
{'loss': 0.0864, 'learning_rate': 1.9421061772708855e-05, 'epoch': 0.29}
              precision    recall  f1-score   support

       NSWER       0.00      0.00      0.00        40
     UESTION       0.15      0.17      0.16        46

   micro avg       0.05      0.09      0.07        86
   macro avg       0.08      0.09      0.08        86
weighted avg       0.08      0.09      0.09        86

{'eval_loss': 1.1932322978973389, 'eval_precision': 0.05128205128205128, 'eval_recall': 0.09302325581395349, 'eval_f1': 0.06611570247933884, 'eval_accuracy': 0.5169577322196912, 'eval_runtime': 0.5608, 'eval_samples_per_second': 89.166, 'eval_steps_per_second': 7.133, 'epoch': 0.29}
{'loss': 0.0769, 'learning_rate': 1.913159265906328e-05, 'epoch': 0.43}
              precision    recall  f1-score   support

       NSWER       0.04      0.12      0.06        40
     UESTION       0.13      0.24      0.17        46

   micro avg       0.07      0.19      0.10        86
   macro avg       0.08      0.18      0.11        86
weighted avg       0.09      0.19      0.11        86

{'eval_loss': 0.7301750779151917, 'eval_precision': 0.07079646017699115, 'eval_recall': 0.18604651162790697, 'eval_f1': 0.10256410256410256, 'eval_accuracy': 0.675904834219185, 'eval_runtime': 0.5177, 'eval_samples_per_second': 96.576, 'eval_steps_per_second': 7.726, 'epoch': 0.43}
{'loss': 0.0699, 'learning_rate': 1.8842123545417705e-05, 'epoch': 0.58}
              precision    recall  f1-score   support

       NSWER       0.11      0.17      0.13        40
     UESTION       0.08      0.17      0.11        46

   micro avg       0.09      0.17      0.12        86
   macro avg       0.09      0.17      0.12        86
weighted avg       0.09      0.17      0.12        86

{'eval_loss': 0.8005848526954651, 'eval_precision': 0.08823529411764706, 'eval_recall': 0.1744186046511628, 'eval_f1': 0.11718750000000001, 'eval_accuracy': 0.7071627436092128, 'eval_runtime': 0.5306, 'eval_samples_per_second': 94.24, 'eval_steps_per_second': 7.539, 'epoch': 0.58}
{'loss': 0.0692, 'learning_rate': 1.855265443177213e-05, 'epoch': 0.72}
              precision    recall  f1-score   support

       NSWER       0.28      0.47      0.35        40
     UESTION       0.20      0.46      0.28        46

   micro avg       0.23      0.47      0.31        86
   macro avg       0.24      0.47      0.32        86
weighted avg       0.24      0.47      0.31        86

{'eval_loss': 0.6199201345443726, 'eval_precision': 0.23255813953488372, 'eval_recall': 0.46511627906976744, 'eval_f1': 0.31007751937984496, 'eval_accuracy': 0.7556314856998229, 'eval_runtime': 0.5507, 'eval_samples_per_second': 90.787, 'eval_steps_per_second': 7.263, 'epoch': 0.72}
{'loss': 0.061, 'learning_rate': 1.8263185318126558e-05, 'epoch': 0.87}
              precision    recall  f1-score   support

       NSWER       0.25      0.38      0.30        40
     UESTION       0.30      0.46      0.36        46

   micro avg       0.28      0.42      0.33        86
   macro avg       0.28      0.42      0.33        86
weighted avg       0.28      0.42      0.33        86

{'eval_loss': 0.7181476354598999, 'eval_precision': 0.27906976744186046, 'eval_recall': 0.4186046511627907, 'eval_f1': 0.33488372093023255, 'eval_accuracy': 0.7885345482156416, 'eval_runtime': 0.5397, 'eval_samples_per_second': 92.643, 'eval_steps_per_second': 7.411, 'epoch': 0.87}
{'loss': 0.0599, 'learning_rate': 1.7973716204480985e-05, 'epoch': 1.01}
              precision    recall  f1-score   support

       NSWER       0.17      0.33      0.22        40
     UESTION       0.31      0.41      0.35        46

   micro avg       0.23      0.37      0.28        86
   macro avg       0.24      0.37      0.29        86
weighted avg       0.24      0.37      0.29        86

{'eval_loss': 0.8397260904312134, 'eval_precision': 0.22857142857142856, 'eval_recall': 0.37209302325581395, 'eval_f1': 0.2831858407079646, 'eval_accuracy': 0.7395596051632498, 'eval_runtime': 0.5454, 'eval_samples_per_second': 91.683, 'eval_steps_per_second': 7.335, 'epoch': 1.01}
{'loss': 0.0478, 'learning_rate': 1.7684247090835408e-05, 'epoch': 1.16}
              precision    recall  f1-score   support

       NSWER       0.25      0.35      0.29        40
     UESTION       0.24      0.37      0.29        46

   micro avg       0.24      0.36      0.29        86
   macro avg       0.24      0.36      0.29        86
weighted avg       0.24      0.36      0.29        86

{'eval_loss': 0.7351997494697571, 'eval_precision': 0.2440944881889764, 'eval_recall': 0.36046511627906974, 'eval_f1': 0.29107981220657275, 'eval_accuracy': 0.7566438876233865, 'eval_runtime': 0.5401, 'eval_samples_per_second': 92.568, 'eval_steps_per_second': 7.405, 'epoch': 1.16}
{'loss': 0.0502, 'learning_rate': 1.7394777977189838e-05, 'epoch': 1.3}
              precision    recall  f1-score   support

       NSWER       0.35      0.62      0.45        40
     UESTION       0.33      0.48      0.39        46

   micro avg       0.34      0.55      0.42        86
   macro avg       0.34      0.55      0.42        86
weighted avg       0.34      0.55      0.42        86

{'eval_loss': 0.6067600846290588, 'eval_precision': 0.34306569343065696, 'eval_recall': 0.5465116279069767, 'eval_f1': 0.42152466367713004, 'eval_accuracy': 0.7871424955707416, 'eval_runtime': 0.5881, 'eval_samples_per_second': 85.023, 'eval_steps_per_second': 6.802, 'epoch': 1.3}
{'loss': 0.0501, 'learning_rate': 1.710530886354426e-05, 'epoch': 1.45}
              precision    recall  f1-score   support

       NSWER       0.26      0.60      0.36        40
     UESTION       0.30      0.46      0.36        46

   micro avg       0.28      0.52      0.36        86
   macro avg       0.28      0.53      0.36        86
weighted avg       0.28      0.52      0.36        86

{'eval_loss': 0.7157625555992126, 'eval_precision': 0.2777777777777778, 'eval_recall': 0.5232558139534884, 'eval_f1': 0.3629032258064516, 'eval_accuracy': 0.7863831941280689, 'eval_runtime': 0.5559, 'eval_samples_per_second': 89.943, 'eval_steps_per_second': 7.195, 'epoch': 1.45}
{'loss': 0.0456, 'learning_rate': 1.6815839749898688e-05, 'epoch': 1.59}
              precision    recall  f1-score   support

       NSWER       0.18      0.30      0.23        40
     UESTION       0.40      0.46      0.42        46

   micro avg       0.28      0.38      0.32        86
   macro avg       0.29      0.38      0.33        86
weighted avg       0.30      0.38      0.33        86

{'eval_loss': 0.9700332880020142, 'eval_precision': 0.2796610169491525, 'eval_recall': 0.38372093023255816, 'eval_f1': 0.3235294117647059, 'eval_accuracy': 0.6798278916729942, 'eval_runtime': 0.5296, 'eval_samples_per_second': 94.419, 'eval_steps_per_second': 7.554, 'epoch': 1.59}
{'loss': 0.049, 'learning_rate': 1.6526370636253114e-05, 'epoch': 1.74}
              precision    recall  f1-score   support

       NSWER       0.09      0.20      0.13        40
     UESTION       0.12      0.20      0.15        46

   micro avg       0.11      0.20      0.14        86
   macro avg       0.11      0.20      0.14        86
weighted avg       0.11      0.20      0.14        86

{'eval_loss': 0.7549999952316284, 'eval_precision': 0.10559006211180125, 'eval_recall': 0.19767441860465115, 'eval_f1': 0.13765182186234817, 'eval_accuracy': 0.693621867881549, 'eval_runtime': 0.54, 'eval_samples_per_second': 92.6, 'eval_steps_per_second': 7.408, 'epoch': 1.74}
{'loss': 0.0472, 'learning_rate': 1.623690152260754e-05, 'epoch': 1.88}
              precision    recall  f1-score   support

       NSWER       0.15      0.28      0.19        40
     UESTION       0.27      0.26      0.27        46

   micro avg       0.19      0.27      0.22        86
   macro avg       0.21      0.27      0.23        86
weighted avg       0.21      0.27      0.23        86

{'eval_loss': 0.9949570298194885, 'eval_precision': 0.19327731092436976, 'eval_recall': 0.26744186046511625, 'eval_f1': 0.224390243902439, 'eval_accuracy': 0.731586940015186, 'eval_runtime': 0.5275, 'eval_samples_per_second': 94.792, 'eval_steps_per_second': 7.583, 'epoch': 1.88}
{'loss': 0.045, 'learning_rate': 1.5947432408961964e-05, 'epoch': 2.03}
              precision    recall  f1-score   support

       NSWER       0.22      0.57      0.32        40
     UESTION       0.34      0.52      0.41        46

   micro avg       0.27      0.55      0.36        86
   macro avg       0.28      0.55      0.36        86
weighted avg       0.28      0.55      0.37        86

{'eval_loss': 0.6281022429466248, 'eval_precision': 0.26857142857142857, 'eval_recall': 0.5465116279069767, 'eval_f1': 0.36015325670498083, 'eval_accuracy': 0.7808149835484688, 'eval_runtime': 0.5482, 'eval_samples_per_second': 91.215, 'eval_steps_per_second': 7.297, 'epoch': 2.03}
{'train_runtime': 6360.5281, 'train_samples_per_second': 217.249, 'train_steps_per_second': 27.157, 'train_loss': 0.06345318276541574, 'epoch': 2.03}
              precision    recall  f1-score   support

       NSWER       0.32      0.56      0.41        59
     UESTION       0.40      0.49      0.44        73

   micro avg       0.36      0.52      0.43       132
   macro avg       0.36      0.53      0.43       132
weighted avg       0.37      0.52      0.43       132

{'epoch': 2.03,
 'eval_accuracy': 0.8220043367587442,
 'eval_f1': 0.4259259259259259,
 'eval_loss': 0.4585931897163391,
 'eval_precision': 0.359375,
 'eval_recall': 0.5227272727272727,
 'eval_runtime': 0.7761,
 'eval_samples_per_second': 87.617,
 'eval_steps_per_second': 6.442}
Accuracy: 0.8220043367587442
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	2e-5	num_train_epochs	10	END 4745148: Thu 12 Oct 2023 01:47:33 PM EEST
