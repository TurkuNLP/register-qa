START 4745146: Thu 12 Oct 2023 11:56:25 AM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl', '../../data/qa_token_classification/annotated/train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/annotated/test_annotated_dataset.jsonl', dev='../../data/qa_token_classification/annotated/dev_annotated_dataset.jsonl', batch=8, epochs=10, lr=3e-05, save=None, dataset=None)
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
in dictionary: 2
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138182
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138182
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 50
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 68
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1311, 'learning_rate': 2.9565796329531642e-05, 'epoch': 0.14}
              precision    recall  f1-score   support

       NSWER       0.06      0.20      0.10        40
     UESTION       0.07      0.13      0.09        46

   micro avg       0.06      0.16      0.09        86
   macro avg       0.07      0.17      0.09        86
weighted avg       0.07      0.16      0.09        86

{'eval_loss': 0.854907751083374, 'eval_precision': 0.06481481481481481, 'eval_recall': 0.16279069767441862, 'eval_f1': 0.09271523178807947, 'eval_accuracy': 0.6278157428499114, 'eval_runtime': 0.5637, 'eval_samples_per_second': 88.707, 'eval_steps_per_second': 7.097, 'epoch': 0.14}
{'loss': 0.091, 'learning_rate': 2.9131592659063277e-05, 'epoch': 0.29}
              precision    recall  f1-score   support

       NSWER       0.11      0.30      0.17        40
     UESTION       0.12      0.20      0.15        46

   micro avg       0.12      0.24      0.16        86
   macro avg       0.12      0.25      0.16        86
weighted avg       0.12      0.24      0.16        86

{'eval_loss': 1.1433038711547852, 'eval_precision': 0.11666666666666667, 'eval_recall': 0.2441860465116279, 'eval_f1': 0.15789473684210525, 'eval_accuracy': 0.6693242217160212, 'eval_runtime': 1.5799, 'eval_samples_per_second': 31.647, 'eval_steps_per_second': 2.532, 'epoch': 0.29}
{'loss': 0.0811, 'learning_rate': 2.869738898859492e-05, 'epoch': 0.43}
              precision    recall  f1-score   support

       NSWER       0.11      0.30      0.16        40
     UESTION       0.14      0.17      0.15        46

   micro avg       0.12      0.23      0.16        86
   macro avg       0.12      0.24      0.16        86
weighted avg       0.12      0.23      0.16        86

{'eval_loss': 0.6578248739242554, 'eval_precision': 0.11976047904191617, 'eval_recall': 0.23255813953488372, 'eval_f1': 0.15810276679841895, 'eval_accuracy': 0.724373576309795, 'eval_runtime': 0.5362, 'eval_samples_per_second': 93.248, 'eval_steps_per_second': 7.46, 'epoch': 0.43}
{'loss': 0.0786, 'learning_rate': 2.8263185318126557e-05, 'epoch': 0.58}
              precision    recall  f1-score   support

       NSWER       0.11      0.23      0.15        40
     UESTION       0.28      0.35      0.31        46

   micro avg       0.18      0.29      0.22        86
   macro avg       0.19      0.29      0.23        86
weighted avg       0.20      0.29      0.23        86

{'eval_loss': 0.6034834980964661, 'eval_precision': 0.18248175182481752, 'eval_recall': 0.29069767441860467, 'eval_f1': 0.2242152466367713, 'eval_accuracy': 0.7714502657555049, 'eval_runtime': 1.5651, 'eval_samples_per_second': 31.948, 'eval_steps_per_second': 2.556, 'epoch': 0.58}
{'loss': 0.0726, 'learning_rate': 2.78289816476582e-05, 'epoch': 0.72}
              precision    recall  f1-score   support

       NSWER       0.16      0.30      0.21        40
     UESTION       0.30      0.35      0.32        46

   micro avg       0.22      0.33      0.26        86
   macro avg       0.23      0.32      0.27        86
weighted avg       0.23      0.33      0.27        86

{'eval_loss': 0.7389441728591919, 'eval_precision': 0.2204724409448819, 'eval_recall': 0.32558139534883723, 'eval_f1': 0.26291079812206575, 'eval_accuracy': 0.728802834725386, 'eval_runtime': 0.5375, 'eval_samples_per_second': 93.019, 'eval_steps_per_second': 7.442, 'epoch': 0.72}
{'loss': 0.0646, 'learning_rate': 2.7394777977189834e-05, 'epoch': 0.87}
              precision    recall  f1-score   support

       NSWER       0.17      0.23      0.19        40
     UESTION       0.25      0.28      0.26        46

   micro avg       0.21      0.26      0.23        86
   macro avg       0.21      0.25      0.23        86
weighted avg       0.21      0.26      0.23        86

{'eval_loss': 0.6343843340873718, 'eval_precision': 0.205607476635514, 'eval_recall': 0.2558139534883721, 'eval_f1': 0.22797927461139897, 'eval_accuracy': 0.7580359402682865, 'eval_runtime': 0.5503, 'eval_samples_per_second': 90.86, 'eval_steps_per_second': 7.269, 'epoch': 0.87}
{'loss': 0.0666, 'learning_rate': 2.6960574306721475e-05, 'epoch': 1.01}
              precision    recall  f1-score   support

       NSWER       0.12      0.25      0.16        40
     UESTION       0.28      0.46      0.35        46

   micro avg       0.20      0.36      0.26        86
   macro avg       0.20      0.35      0.26        86
weighted avg       0.21      0.36      0.26        86

{'eval_loss': 0.6210715770721436, 'eval_precision': 0.19745222929936307, 'eval_recall': 0.36046511627906974, 'eval_f1': 0.25514403292181076, 'eval_accuracy': 0.7415844090103771, 'eval_runtime': 0.5428, 'eval_samples_per_second': 92.113, 'eval_steps_per_second': 7.369, 'epoch': 1.01}
{'loss': 0.0524, 'learning_rate': 2.6526370636253113e-05, 'epoch': 1.16}
              precision    recall  f1-score   support

       NSWER       0.13      0.30      0.18        40
     UESTION       0.21      0.48      0.29        46

   micro avg       0.17      0.40      0.24        86
   macro avg       0.17      0.39      0.24        86
weighted avg       0.17      0.40      0.24        86

{'eval_loss': 0.6034354567527771, 'eval_precision': 0.17346938775510204, 'eval_recall': 0.3953488372093023, 'eval_f1': 0.2411347517730496, 'eval_accuracy': 0.7343710453049861, 'eval_runtime': 0.5427, 'eval_samples_per_second': 92.128, 'eval_steps_per_second': 7.37, 'epoch': 1.16}
{'loss': 0.0576, 'learning_rate': 2.609216696578475e-05, 'epoch': 1.3}
              precision    recall  f1-score   support

       NSWER       0.22      0.15      0.18        40
     UESTION       0.43      0.41      0.42        46

   micro avg       0.35      0.29      0.32        86
   macro avg       0.33      0.28      0.30        86
weighted avg       0.33      0.29      0.31        86

{'eval_loss': 0.9468511939048767, 'eval_precision': 0.352112676056338, 'eval_recall': 0.29069767441860467, 'eval_f1': 0.3184713375796178, 'eval_accuracy': 0.6560364464692483, 'eval_runtime': 0.5672, 'eval_samples_per_second': 88.156, 'eval_steps_per_second': 7.053, 'epoch': 1.3}
{'loss': 0.0558, 'learning_rate': 2.565796329531639e-05, 'epoch': 1.45}
              precision    recall  f1-score   support

       NSWER       0.23      0.38      0.28        40
     UESTION       0.34      0.43      0.38        46

   micro avg       0.28      0.41      0.33        86
   macro avg       0.29      0.40      0.33        86
weighted avg       0.29      0.41      0.34        86

{'eval_loss': 0.6426317691802979, 'eval_precision': 0.28225806451612906, 'eval_recall': 0.4069767441860465, 'eval_f1': 0.33333333333333337, 'eval_accuracy': 0.7389268539610225, 'eval_runtime': 0.5648, 'eval_samples_per_second': 88.532, 'eval_steps_per_second': 7.083, 'epoch': 1.45}
{'loss': 0.0522, 'learning_rate': 2.522375962484803e-05, 'epoch': 1.59}
              precision    recall  f1-score   support

       NSWER       0.00      0.00      0.00        40
     UESTION       0.00      0.02      0.01        46

   micro avg       0.00      0.01      0.00        86
   macro avg       0.00      0.01      0.00        86
weighted avg       0.00      0.01      0.00        86

{'eval_loss': 0.8696578741073608, 'eval_precision': 0.001002004008016032, 'eval_recall': 0.011627906976744186, 'eval_f1': 0.0018450184501845018, 'eval_accuracy': 0.5978233358643381, 'eval_runtime': 0.5255, 'eval_samples_per_second': 95.148, 'eval_steps_per_second': 7.612, 'epoch': 1.59}
{'loss': 0.0527, 'learning_rate': 2.4789555954379666e-05, 'epoch': 1.74}
              precision    recall  f1-score   support

       NSWER       0.19      0.40      0.26        40
     UESTION       0.18      0.43      0.25        46

   micro avg       0.18      0.42      0.25        86
   macro avg       0.18      0.42      0.25        86
weighted avg       0.18      0.42      0.25        86

{'eval_loss': 0.6380541920661926, 'eval_precision': 0.18181818181818182, 'eval_recall': 0.4186046511627907, 'eval_f1': 0.2535211267605634, 'eval_accuracy': 0.7562642369020501, 'eval_runtime': 0.5408, 'eval_samples_per_second': 92.454, 'eval_steps_per_second': 7.396, 'epoch': 1.74}
{'loss': 0.0507, 'learning_rate': 2.4355352283911308e-05, 'epoch': 1.88}
              precision    recall  f1-score   support

       NSWER       0.19      0.33      0.24        40
     UESTION       0.37      0.50      0.42        46

   micro avg       0.28      0.42      0.33        86
   macro avg       0.28      0.41      0.33        86
weighted avg       0.29      0.42      0.34        86

{'eval_loss': 0.5611534118652344, 'eval_precision': 0.27692307692307694, 'eval_recall': 0.4186046511627907, 'eval_f1': 0.33333333333333337, 'eval_accuracy': 0.755125284738041, 'eval_runtime': 0.5363, 'eval_samples_per_second': 93.232, 'eval_steps_per_second': 7.459, 'epoch': 1.88}
{'loss': 0.0498, 'learning_rate': 2.3921148613442946e-05, 'epoch': 2.03}
              precision    recall  f1-score   support

       NSWER       0.16      0.12      0.14        40
     UESTION       0.15      0.11      0.12        46

   micro avg       0.15      0.12      0.13        86
   macro avg       0.15      0.12      0.13        86
weighted avg       0.15      0.12      0.13        86

{'eval_loss': 1.6723268032073975, 'eval_precision': 0.15384615384615385, 'eval_recall': 0.11627906976744186, 'eval_f1': 0.13245033112582782, 'eval_accuracy': 0.5868134649455834, 'eval_runtime': 1.5293, 'eval_samples_per_second': 32.695, 'eval_steps_per_second': 2.616, 'epoch': 2.03}
{'loss': 0.0378, 'learning_rate': 2.3486944942974588e-05, 'epoch': 2.17}
              precision    recall  f1-score   support

       NSWER       0.33      0.33      0.33        40
     UESTION       0.22      0.24      0.23        46

   micro avg       0.27      0.28      0.28        86
   macro avg       0.28      0.28      0.28        86
weighted avg       0.28      0.28      0.28        86

{'eval_loss': 0.785735011100769, 'eval_precision': 0.2727272727272727, 'eval_recall': 0.27906976744186046, 'eval_f1': 0.2758620689655172, 'eval_accuracy': 0.7294355859276133, 'eval_runtime': 0.5162, 'eval_samples_per_second': 96.854, 'eval_steps_per_second': 7.748, 'epoch': 2.17}
{'loss': 0.0399, 'learning_rate': 2.3052741272506223e-05, 'epoch': 2.32}
              precision    recall  f1-score   support

       NSWER       0.17      0.40      0.24        40
     UESTION       0.31      0.35      0.33        46

   micro avg       0.22      0.37      0.28        86
   macro avg       0.24      0.37      0.28        86
weighted avg       0.24      0.37      0.29        86

{'eval_loss': 0.663278341293335, 'eval_precision': 0.2206896551724138, 'eval_recall': 0.37209302325581395, 'eval_f1': 0.27705627705627706, 'eval_accuracy': 0.760946595798532, 'eval_runtime': 0.5631, 'eval_samples_per_second': 88.801, 'eval_steps_per_second': 7.104, 'epoch': 2.32}
{'loss': 0.0388, 'learning_rate': 2.2618537602037864e-05, 'epoch': 2.46}
              precision    recall  f1-score   support

       NSWER       0.11      0.28      0.16        40
     UESTION       0.29      0.48      0.36        46

   micro avg       0.19      0.38      0.25        86
   macro avg       0.20      0.38      0.26        86
weighted avg       0.20      0.38      0.26        86

{'eval_loss': 0.6211528778076172, 'eval_precision': 0.1864406779661017, 'eval_recall': 0.38372093023255816, 'eval_f1': 0.25095057034220536, 'eval_accuracy': 0.7746140217666414, 'eval_runtime': 0.5525, 'eval_samples_per_second': 90.504, 'eval_steps_per_second': 7.24, 'epoch': 2.46}
{'loss': 0.0387, 'learning_rate': 2.2184333931569502e-05, 'epoch': 2.61}
              precision    recall  f1-score   support

       NSWER       0.21      0.45      0.29        40
     UESTION       0.30      0.46      0.37        46

   micro avg       0.25      0.45      0.32        86
   macro avg       0.26      0.45      0.33        86
weighted avg       0.26      0.45      0.33        86

{'eval_loss': 0.5147790312767029, 'eval_precision': 0.2532467532467532, 'eval_recall': 0.45348837209302323, 'eval_f1': 0.32499999999999996, 'eval_accuracy': 0.8086560364464692, 'eval_runtime': 0.5418, 'eval_samples_per_second': 92.286, 'eval_steps_per_second': 7.383, 'epoch': 2.61}
{'loss': 0.0428, 'learning_rate': 2.175013026110114e-05, 'epoch': 2.75}
              precision    recall  f1-score   support

       NSWER       0.26      0.53      0.35        40
     UESTION       0.26      0.43      0.33        46

   micro avg       0.26      0.48      0.34        86
   macro avg       0.26      0.48      0.34        86
weighted avg       0.26      0.48      0.34        86

{'eval_loss': 0.5392338037490845, 'eval_precision': 0.26282051282051283, 'eval_recall': 0.47674418604651164, 'eval_f1': 0.3388429752066116, 'eval_accuracy': 0.7543659832953683, 'eval_runtime': 0.5269, 'eval_samples_per_second': 94.891, 'eval_steps_per_second': 7.591, 'epoch': 2.75}
{'loss': 0.0385, 'learning_rate': 2.131592659063278e-05, 'epoch': 2.89}
              precision    recall  f1-score   support

       NSWER       0.41      0.65      0.50        40
     UESTION       0.38      0.54      0.45        46

   micro avg       0.40      0.59      0.47        86
   macro avg       0.40      0.60      0.48        86
weighted avg       0.39      0.59      0.47        86

{'eval_loss': 0.5728435516357422, 'eval_precision': 0.3953488372093023, 'eval_recall': 0.5930232558139535, 'eval_f1': 0.4744186046511628, 'eval_accuracy': 0.80055682105796, 'eval_runtime': 0.5618, 'eval_samples_per_second': 88.999, 'eval_steps_per_second': 7.12, 'epoch': 2.89}
{'loss': 0.035, 'learning_rate': 2.088172292016442e-05, 'epoch': 3.04}
              precision    recall  f1-score   support

       NSWER       0.11      0.33      0.17        40
     UESTION       0.24      0.39      0.30        46

   micro avg       0.16      0.36      0.23        86
   macro avg       0.18      0.36      0.23        86
weighted avg       0.18      0.36      0.24        86

{'eval_loss': 0.7006945610046387, 'eval_precision': 0.164021164021164, 'eval_recall': 0.36046511627906974, 'eval_f1': 0.22545454545454546, 'eval_accuracy': 0.7307010883320678, 'eval_runtime': 0.5341, 'eval_samples_per_second': 93.613, 'eval_steps_per_second': 7.489, 'epoch': 3.04}
{'loss': 0.0267, 'learning_rate': 2.044751924969606e-05, 'epoch': 3.18}
              precision    recall  f1-score   support

       NSWER       0.27      0.53      0.36        40
     UESTION       0.23      0.39      0.29        46

   micro avg       0.25      0.45      0.32        86
   macro avg       0.25      0.46      0.32        86
weighted avg       0.25      0.45      0.32        86

{'eval_loss': 0.9012556672096252, 'eval_precision': 0.25, 'eval_recall': 0.45348837209302323, 'eval_f1': 0.3223140495867769, 'eval_accuracy': 0.75348013161225, 'eval_runtime': 1.5714, 'eval_samples_per_second': 31.819, 'eval_steps_per_second': 2.546, 'epoch': 3.18}
{'loss': 0.0294, 'learning_rate': 2.0013315579227697e-05, 'epoch': 3.33}
              precision    recall  f1-score   support

       NSWER       0.26      0.38      0.31        40
     UESTION       0.36      0.50      0.42        46

   micro avg       0.31      0.44      0.37        86
   macro avg       0.31      0.44      0.36        86
weighted avg       0.31      0.44      0.37        86

{'eval_loss': 0.8375802636146545, 'eval_precision': 0.3114754098360656, 'eval_recall': 0.4418604651162791, 'eval_f1': 0.3653846153846154, 'eval_accuracy': 0.6771703366236396, 'eval_runtime': 0.5199, 'eval_samples_per_second': 96.165, 'eval_steps_per_second': 7.693, 'epoch': 3.33}
{'train_runtime': 11561.8134, 'train_samples_per_second': 119.516, 'train_steps_per_second': 14.94, 'train_loss': 0.055838720835810124, 'epoch': 3.33}
              precision    recall  f1-score   support

       NSWER       0.23      0.46      0.31        59
     UESTION       0.36      0.55      0.43        73

   micro avg       0.30      0.51      0.37       132
   macro avg       0.30      0.50      0.37       132
weighted avg       0.30      0.51      0.38       132

{'epoch': 3.33,
 'eval_accuracy': 0.8208730083906854,
 'eval_f1': 0.37325905292479106,
 'eval_loss': 0.45959287881851196,
 'eval_precision': 0.29515418502202645,
 'eval_recall': 0.5075757575757576,
 'eval_runtime': 0.783,
 'eval_samples_per_second': 86.841,
 'eval_steps_per_second': 6.385}
Accuracy: 0.8208730083906854
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	3e-5	num_train_epochs	10	END 4745146: Thu 12 Oct 2023 03:14:12 PM EEST
