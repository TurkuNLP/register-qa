START 4753167: Fri 13 Oct 2023 12:18:34 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl'], test='../../data/qa_token_classification/annotated/en_test_dataset.jsonl', dev='../../data/qa_token_classification/annotated/en_dev_dataset.jsonl', batch=8, epochs=10, lr=3e-05, save=None)
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138082
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138082
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 40
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 60
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.136, 'learning_rate': 2.9565494467296216e-05, 'epoch': 0.14}
              precision    recall  f1-score   support

       NSWER       0.03      0.07      0.04        40
     UESTION       0.04      0.04      0.04        92

   micro avg       0.03      0.05      0.04       132
   macro avg       0.03      0.06      0.04       132
weighted avg       0.04      0.05      0.04       132

{'eval_loss': 4.944489002227783, 'eval_precision': 0.03414634146341464, 'eval_recall': 0.05303030303030303, 'eval_f1': 0.04154302670623145, 'eval_accuracy': 0.3176829268292683, 'eval_runtime': 0.5918, 'eval_samples_per_second': 67.59, 'eval_steps_per_second': 5.069, 'epoch': 0.14}
{'loss': 0.0935, 'learning_rate': 2.9130988934592434e-05, 'epoch': 0.29}
              precision    recall  f1-score   support

       NSWER       0.01      0.03      0.02        40
     UESTION       0.01      0.01      0.01        92

   micro avg       0.01      0.02      0.01       132
   macro avg       0.01      0.02      0.01       132
weighted avg       0.01      0.02      0.01       132

{'eval_loss': 3.8811287879943848, 'eval_precision': 0.010362694300518135, 'eval_recall': 0.015151515151515152, 'eval_f1': 0.012307692307692308, 'eval_accuracy': 0.2969512195121951, 'eval_runtime': 0.5836, 'eval_samples_per_second': 68.541, 'eval_steps_per_second': 5.141, 'epoch': 0.29}
{'loss': 0.0812, 'learning_rate': 2.8696483401888652e-05, 'epoch': 0.43}
              precision    recall  f1-score   support

       NSWER       0.01      0.03      0.01        40
     UESTION       0.03      0.05      0.04        92

   micro avg       0.02      0.05      0.03       132
   macro avg       0.02      0.04      0.03       132
weighted avg       0.03      0.05      0.03       132

{'eval_loss': 4.564630508422852, 'eval_precision': 0.02027027027027027, 'eval_recall': 0.045454545454545456, 'eval_f1': 0.028037383177570093, 'eval_accuracy': 0.3404471544715447, 'eval_runtime': 0.5832, 'eval_samples_per_second': 68.591, 'eval_steps_per_second': 5.144, 'epoch': 0.43}
{'loss': 0.0821, 'learning_rate': 2.826197786918487e-05, 'epoch': 0.58}
              precision    recall  f1-score   support

       NSWER       0.04      0.07      0.06        40
     UESTION       0.03      0.02      0.02        92

   micro avg       0.04      0.04      0.04       132
   macro avg       0.04      0.05      0.04       132
weighted avg       0.03      0.04      0.03       132

{'eval_loss': 5.6617751121521, 'eval_precision': 0.036231884057971016, 'eval_recall': 0.03787878787878788, 'eval_f1': 0.037037037037037035, 'eval_accuracy': 0.3141260162601626, 'eval_runtime': 0.571, 'eval_samples_per_second': 70.055, 'eval_steps_per_second': 5.254, 'epoch': 0.58}
{'loss': 0.0738, 'learning_rate': 2.7827472336481085e-05, 'epoch': 0.72}
              precision    recall  f1-score   support

       NSWER       0.05      0.10      0.07        40
     UESTION       0.05      0.04      0.05        92

   micro avg       0.05      0.06      0.06       132
   macro avg       0.05      0.07      0.06       132
weighted avg       0.05      0.06      0.05       132

{'eval_loss': 4.25070333480835, 'eval_precision': 0.05228758169934641, 'eval_recall': 0.06060606060606061, 'eval_f1': 0.056140350877192984, 'eval_accuracy': 0.3651422764227642, 'eval_runtime': 0.6028, 'eval_samples_per_second': 66.355, 'eval_steps_per_second': 4.977, 'epoch': 0.72}
{'loss': 0.0732, 'learning_rate': 2.73929668037773e-05, 'epoch': 0.87}
              precision    recall  f1-score   support

       NSWER       0.06      0.10      0.07        40
     UESTION       0.04      0.04      0.04        92

   micro avg       0.04      0.06      0.05       132
   macro avg       0.05      0.07      0.06       132
weighted avg       0.04      0.06      0.05       132

{'eval_loss': 3.722184658050537, 'eval_precision': 0.04419889502762431, 'eval_recall': 0.06060606060606061, 'eval_f1': 0.051118210862619806, 'eval_accuracy': 0.4034552845528455, 'eval_runtime': 0.5672, 'eval_samples_per_second': 70.527, 'eval_steps_per_second': 5.29, 'epoch': 0.87}
{'loss': 0.0642, 'learning_rate': 2.695846127107352e-05, 'epoch': 1.01}
              precision    recall  f1-score   support

       NSWER       0.04      0.07      0.05        40
     UESTION       0.04      0.03      0.04        92

   micro avg       0.04      0.05      0.04       132
   macro avg       0.04      0.05      0.04       132
weighted avg       0.04      0.05      0.04       132

{'eval_loss': 6.23604679107666, 'eval_precision': 0.03870967741935484, 'eval_recall': 0.045454545454545456, 'eval_f1': 0.041811846689895474, 'eval_accuracy': 0.36829268292682926, 'eval_runtime': 0.5707, 'eval_samples_per_second': 70.094, 'eval_steps_per_second': 5.257, 'epoch': 1.01}
{'loss': 0.0582, 'learning_rate': 2.6523955738369736e-05, 'epoch': 1.16}
              precision    recall  f1-score   support

       NSWER       0.04      0.07      0.05        40
     UESTION       0.04      0.03      0.03        92

   micro avg       0.04      0.05      0.04       132
   macro avg       0.04      0.05      0.04       132
weighted avg       0.04      0.05      0.04       132

{'eval_loss': 5.575141429901123, 'eval_precision': 0.03636363636363636, 'eval_recall': 0.045454545454545456, 'eval_f1': 0.0404040404040404, 'eval_accuracy': 0.3201219512195122, 'eval_runtime': 0.5676, 'eval_samples_per_second': 70.467, 'eval_steps_per_second': 5.285, 'epoch': 1.16}
{'loss': 0.0567, 'learning_rate': 2.6089450205665954e-05, 'epoch': 1.3}
              precision    recall  f1-score   support

       NSWER       0.06      0.07      0.07        40
     UESTION       0.09      0.04      0.06        92

   micro avg       0.07      0.05      0.06       132
   macro avg       0.07      0.06      0.06       132
weighted avg       0.08      0.05      0.06       132

{'eval_loss': 6.38251256942749, 'eval_precision': 0.07291666666666667, 'eval_recall': 0.05303030303030303, 'eval_f1': 0.06140350877192983, 'eval_accuracy': 0.3363821138211382, 'eval_runtime': 0.607, 'eval_samples_per_second': 65.893, 'eval_steps_per_second': 4.942, 'epoch': 1.3}
{'loss': 0.0559, 'learning_rate': 2.565494467296217e-05, 'epoch': 1.45}
              precision    recall  f1-score   support

       NSWER       0.05      0.10      0.07        40
     UESTION       0.03      0.02      0.02        92

   micro avg       0.04      0.05      0.04       132
   macro avg       0.04      0.06      0.05       132
weighted avg       0.03      0.05      0.04       132

{'eval_loss': 6.96005916595459, 'eval_precision': 0.039473684210526314, 'eval_recall': 0.045454545454545456, 'eval_f1': 0.04225352112676056, 'eval_accuracy': 0.3067073170731707, 'eval_runtime': 0.5683, 'eval_samples_per_second': 70.385, 'eval_steps_per_second': 5.279, 'epoch': 1.45}
{'loss': 0.0552, 'learning_rate': 2.5220439140258387e-05, 'epoch': 1.59}
              precision    recall  f1-score   support

       NSWER       0.06      0.10      0.08        40
     UESTION       0.05      0.03      0.04        92

   micro avg       0.06      0.05      0.05       132
   macro avg       0.06      0.07      0.06       132
weighted avg       0.05      0.05      0.05       132

{'eval_loss': 6.608852386474609, 'eval_precision': 0.05511811023622047, 'eval_recall': 0.05303030303030303, 'eval_f1': 0.05405405405405406, 'eval_accuracy': 0.3727642276422764, 'eval_runtime': 0.5674, 'eval_samples_per_second': 70.498, 'eval_steps_per_second': 5.287, 'epoch': 1.59}
{'train_runtime': 4920.2734, 'train_samples_per_second': 280.639, 'train_steps_per_second': 35.081, 'train_loss': 0.07543922784978693, 'epoch': 1.59}
              precision    recall  f1-score   support

       NSWER       0.02      0.05      0.03        79
     UESTION       0.04      0.07      0.05       109

   micro avg       0.03      0.06      0.04       188
   macro avg       0.03      0.06      0.04       188
weighted avg       0.03      0.06      0.04       188

{'epoch': 1.59,
 'eval_accuracy': 0.36178146767044256,
 'eval_f1': 0.03927986906710311,
 'eval_loss': 4.60829496383667,
 'eval_precision': 0.028368794326241134,
 'eval_recall': 0.06382978723404255,
 'eval_runtime': 1.0098,
 'eval_samples_per_second': 59.419,
 'eval_steps_per_second': 3.961}
Accuracy: 0.36178146767044256
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	3e-5	num_train_epochs	10	END 4753167: Fri 13 Oct 2023 01:45:59 PM EEST
