
START 4753767: Fri 13 Oct 2023 01:12:46 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2'], test='../../data/qa_token_classification/annotated/en_test_dataset.jsonl', dev='../../data/qa_token_classification/annotated/en_dev_dataset.jsonl', batch=8, epochs=10, lr=3e-05, save='en_en-ann_3e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 40
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 60
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1169, 'learning_rate': 2.95544466227054e-05, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.04      0.10      0.05        40
     UESTION       0.02      0.02      0.02        92

   micro avg       0.03      0.05      0.03       132
   macro avg       0.03      0.06      0.04       132
weighted avg       0.02      0.05      0.03       132

{'eval_loss': 7.003517150878906, 'eval_precision': 0.02631578947368421, 'eval_recall': 0.045454545454545456, 'eval_f1': 0.03333333333333333, 'eval_accuracy': 0.3236788617886179, 'eval_runtime': 0.584, 'eval_samples_per_second': 68.497, 'eval_steps_per_second': 5.137, 'epoch': 0.15}
{'loss': 0.0757, 'learning_rate': 2.91088932454108e-05, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.05      0.07      0.06        40
     UESTION       0.03      0.02      0.02        92

   micro avg       0.04      0.04      0.04       132
   macro avg       0.04      0.05      0.04       132
weighted avg       0.03      0.04      0.03       132

{'eval_loss': 7.77423620223999, 'eval_precision': 0.037037037037037035, 'eval_recall': 0.03787878787878788, 'eval_f1': 0.03745318352059925, 'eval_accuracy': 0.3149390243902439, 'eval_runtime': 0.575, 'eval_samples_per_second': 69.571, 'eval_steps_per_second': 5.218, 'epoch': 0.3}
{'loss': 0.0617, 'learning_rate': 2.86633398681162e-05, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.07      0.12      0.09        40
     UESTION       0.04      0.03      0.04        92

   micro avg       0.05      0.06      0.06       132
   macro avg       0.05      0.08      0.06       132
weighted avg       0.05      0.06      0.05       132

{'eval_loss': 8.532851219177246, 'eval_precision': 0.05263157894736842, 'eval_recall': 0.06060606060606061, 'eval_f1': 0.056338028169014086, 'eval_accuracy': 0.3232723577235772, 'eval_runtime': 0.5766, 'eval_samples_per_second': 69.375, 'eval_steps_per_second': 5.203, 'epoch': 0.45}
{'loss': 0.0588, 'learning_rate': 2.82177864908216e-05, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.03      0.05      0.04        40
     UESTION       0.01      0.01      0.01        92

   micro avg       0.02      0.02      0.02       132
   macro avg       0.02      0.03      0.02       132
weighted avg       0.02      0.02      0.02       132

{'eval_loss': 9.773164749145508, 'eval_precision': 0.02127659574468085, 'eval_recall': 0.022727272727272728, 'eval_f1': 0.02197802197802198, 'eval_accuracy': 0.28485772357723577, 'eval_runtime': 0.5734, 'eval_samples_per_second': 69.76, 'eval_steps_per_second': 5.232, 'epoch': 0.59}
{'loss': 0.0584, 'learning_rate': 2.7772233113527e-05, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.04      0.07      0.05        40
     UESTION       0.03      0.02      0.02        92

   micro avg       0.03      0.04      0.03       132
   macro avg       0.03      0.05      0.04       132
weighted avg       0.03      0.04      0.03       132

{'eval_loss': 10.713913917541504, 'eval_precision': 0.032467532467532464, 'eval_recall': 0.03787878787878788, 'eval_f1': 0.03496503496503496, 'eval_accuracy': 0.30040650406504066, 'eval_runtime': 0.5714, 'eval_samples_per_second': 69.999, 'eval_steps_per_second': 5.25, 'epoch': 0.74}
{'loss': 0.0569, 'learning_rate': 2.7326679736232404e-05, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.05      0.05      0.05        40
     UESTION       0.04      0.02      0.03        92

   micro avg       0.04      0.03      0.04       132
   macro avg       0.04      0.04      0.04       132
weighted avg       0.04      0.03      0.03       132

{'eval_loss': 11.551431655883789, 'eval_precision': 0.043478260869565216, 'eval_recall': 0.030303030303030304, 'eval_f1': 0.03571428571428572, 'eval_accuracy': 0.2951219512195122, 'eval_runtime': 0.5715, 'eval_samples_per_second': 69.992, 'eval_steps_per_second': 5.249, 'epoch': 0.89}
{'train_runtime': 2560.6091, 'train_samples_per_second': 525.883, 'train_steps_per_second': 65.738, 'train_loss': 0.07138218485514324, 'epoch': 0.89}
saved model
              precision    recall  f1-score   support

       NSWER       0.02      0.04      0.03        79
     UESTION       0.03      0.05      0.04       109

   micro avg       0.03      0.04      0.03       188
   macro avg       0.03      0.04      0.03       188
weighted avg       0.03      0.04      0.03       188

{'epoch': 0.89,
 'eval_accuracy': 0.29388587912474495,
 'eval_f1': 0.03433476394849786,
 'eval_loss': 7.027770042419434,
 'eval_precision': 0.02877697841726619,
 'eval_recall': 0.0425531914893617,
 'eval_runtime': 0.8772,
 'eval_samples_per_second': 68.402,
 'eval_steps_per_second': 4.56}
Accuracy: 0.29388587912474495
END 4753767: Fri 13 Oct 2023 02:00:10 PM EEST
