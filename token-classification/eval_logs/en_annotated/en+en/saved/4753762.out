
START 4753762: Fri 13 Oct 2023 01:12:30 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2'], test='../../data/qa_token_classification/annotated/en_test_dataset.jsonl', dev='../../data/qa_token_classification/annotated/en_dev_dataset.jsonl', batch=8, epochs=10, lr=5e-05, save='en_en-ann_5e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 40
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 60
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1271, 'learning_rate': 4.925741103784234e-05, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.08      0.10      0.09        40
     UESTION       0.07      0.04      0.05        92

   micro avg       0.07      0.06      0.07       132
   macro avg       0.07      0.07      0.07       132
weighted avg       0.07      0.06      0.06       132

{'eval_loss': 6.907360076904297, 'eval_precision': 0.07476635514018691, 'eval_recall': 0.06060606060606061, 'eval_f1': 0.06694560669456066, 'eval_accuracy': 0.3330284552845528, 'eval_runtime': 0.6019, 'eval_samples_per_second': 66.458, 'eval_steps_per_second': 4.984, 'epoch': 0.15}
{'loss': 0.0864, 'learning_rate': 4.851482207568467e-05, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.05      0.07      0.06        40
     UESTION       0.01      0.01      0.01        92

   micro avg       0.03      0.03      0.03       132
   macro avg       0.03      0.04      0.04       132
weighted avg       0.03      0.03      0.03       132

{'eval_loss': 7.511540412902832, 'eval_precision': 0.03125, 'eval_recall': 0.030303030303030304, 'eval_f1': 0.03076923076923077, 'eval_accuracy': 0.32479674796747965, 'eval_runtime': 0.5782, 'eval_samples_per_second': 69.18, 'eval_steps_per_second': 5.188, 'epoch': 0.3}
{'loss': 0.0781, 'learning_rate': 4.7772233113527006e-05, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.04      0.07      0.05        40
     UESTION       0.04      0.03      0.04        92

   micro avg       0.04      0.05      0.04       132
   macro avg       0.04      0.05      0.05       132
weighted avg       0.04      0.05      0.04       132

{'eval_loss': 8.720101356506348, 'eval_precision': 0.041666666666666664, 'eval_recall': 0.045454545454545456, 'eval_f1': 0.043478260869565216, 'eval_accuracy': 0.3252032520325203, 'eval_runtime': 0.5748, 'eval_samples_per_second': 69.592, 'eval_steps_per_second': 5.219, 'epoch': 0.45}
{'loss': 0.0734, 'learning_rate': 4.7029644151369336e-05, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.04      0.07      0.05        40
     UESTION       0.04      0.03      0.03        92

   micro avg       0.04      0.05      0.04       132
   macro avg       0.04      0.05      0.04       132
weighted avg       0.04      0.05      0.04       132

{'eval_loss': 9.769876480102539, 'eval_precision': 0.03636363636363636, 'eval_recall': 0.045454545454545456, 'eval_f1': 0.0404040404040404, 'eval_accuracy': 0.33455284552845527, 'eval_runtime': 0.5572, 'eval_samples_per_second': 71.789, 'eval_steps_per_second': 5.384, 'epoch': 0.59}
{'loss': 0.0666, 'learning_rate': 4.628705518921167e-05, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.06      0.12      0.08        40
     UESTION       0.04      0.03      0.03        92

   micro avg       0.05      0.06      0.05       132
   macro avg       0.05      0.08      0.06       132
weighted avg       0.05      0.06      0.05       132

{'eval_loss': 10.025418281555176, 'eval_precision': 0.050314465408805034, 'eval_recall': 0.06060606060606061, 'eval_f1': 0.054982817869415807, 'eval_accuracy': 0.3170731707317073, 'eval_runtime': 0.5738, 'eval_samples_per_second': 69.708, 'eval_steps_per_second': 5.228, 'epoch': 0.74}
{'loss': 0.0638, 'learning_rate': 4.5544466227054e-05, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.06      0.10      0.08        40
     UESTION       0.04      0.03      0.04        92

   micro avg       0.05      0.05      0.05       132
   macro avg       0.05      0.07      0.06       132
weighted avg       0.05      0.05      0.05       132

{'eval_loss': 10.810708045959473, 'eval_precision': 0.050724637681159424, 'eval_recall': 0.05303030303030303, 'eval_f1': 0.05185185185185185, 'eval_accuracy': 0.3306910569105691, 'eval_runtime': 0.57, 'eval_samples_per_second': 70.173, 'eval_steps_per_second': 5.263, 'epoch': 0.89}
{'train_runtime': 2615.7906, 'train_samples_per_second': 514.789, 'train_steps_per_second': 64.351, 'train_loss': 0.08258038736979166, 'epoch': 0.89}
saved model
              precision    recall  f1-score   support

       NSWER       0.01      0.03      0.02        79
     UESTION       0.02      0.04      0.03       109

   micro avg       0.02      0.03      0.02       188
   macro avg       0.02      0.03      0.02       188
weighted avg       0.02      0.03      0.02       188

{'epoch': 0.89,
 'eval_accuracy': 0.3110532610989939,
 'eval_f1': 0.02303262955854126,
 'eval_loss': 7.21378755569458,
 'eval_precision': 0.018018018018018018,
 'eval_recall': 0.031914893617021274,
 'eval_runtime': 0.8482,
 'eval_samples_per_second': 70.74,
 'eval_steps_per_second': 4.716}
Accuracy: 0.3110532610989939
END 4753762: Fri 13 Oct 2023 02:01:43 PM EEST
