
START 4747123: Thu 12 Oct 2023 02:55:26 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/cleaned2_train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/annotated/cleaned2_test_annotated_dataset.jsonl', dev='../../data/qa_token_classification/annotated/cleaned2_dev_annotated_dataset.jsonl', batch=8, epochs=10, lr=1e-05, save='enfi_fi_1e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 50
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 68
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1229, 'learning_rate': 9.851588008311073e-06, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.06      0.15      0.08        40
     UESTION       0.02      0.04      0.03        46

   micro avg       0.04      0.09      0.05        86
   macro avg       0.04      0.10      0.05        86
weighted avg       0.04      0.09      0.05        86

{'eval_loss': 3.071262836456299, 'eval_precision': 0.03864734299516908, 'eval_recall': 0.09302325581395349, 'eval_f1': 0.0546075085324232, 'eval_accuracy': 0.47877522616562285, 'eval_runtime': 0.603, 'eval_samples_per_second': 82.918, 'eval_steps_per_second': 6.633, 'epoch': 0.15}
{'loss': 0.0737, 'learning_rate': 9.703176016622144e-06, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.03      0.15      0.05        40
     UESTION       0.01      0.07      0.02        46

   micro avg       0.02      0.10      0.04        86
   macro avg       0.02      0.11      0.04        86
weighted avg       0.02      0.10      0.04        86

{'eval_loss': 1.538604736328125, 'eval_precision': 0.021176470588235293, 'eval_recall': 0.10465116279069768, 'eval_f1': 0.035225048923679066, 'eval_accuracy': 0.4923451635351427, 'eval_runtime': 0.5942, 'eval_samples_per_second': 84.141, 'eval_steps_per_second': 6.731, 'epoch': 0.3}
{'loss': 0.058, 'learning_rate': 9.554764024933215e-06, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.03      0.15      0.05        40
     UESTION       0.01      0.04      0.01        46

   micro avg       0.02      0.09      0.03        86
   macro avg       0.02      0.10      0.03        86
weighted avg       0.02      0.09      0.03        86

{'eval_loss': 0.9582698345184326, 'eval_precision': 0.015414258188824663, 'eval_recall': 0.09302325581395349, 'eval_f1': 0.026446280991735537, 'eval_accuracy': 0.530039434006031, 'eval_runtime': 0.588, 'eval_samples_per_second': 85.032, 'eval_steps_per_second': 6.803, 'epoch': 0.45}
{'loss': 0.0625, 'learning_rate': 9.406352033244287e-06, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.03      0.12      0.05        40
     UESTION       0.01      0.07      0.02        46

   micro avg       0.02      0.09      0.03        86
   macro avg       0.02      0.10      0.03        86
weighted avg       0.02      0.09      0.03        86

{'eval_loss': 0.976284384727478, 'eval_precision': 0.018306636155606407, 'eval_recall': 0.09302325581395349, 'eval_f1': 0.030592734225621414, 'eval_accuracy': 0.5294595221526328, 'eval_runtime': 0.673, 'eval_samples_per_second': 74.294, 'eval_steps_per_second': 5.943, 'epoch': 0.59}
{'loss': 0.0479, 'learning_rate': 9.25794004155536e-06, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.06      0.15      0.08        40
     UESTION       0.02      0.04      0.03        46

   micro avg       0.04      0.09      0.05        86
   macro avg       0.04      0.10      0.05        86
weighted avg       0.04      0.09      0.05        86

{'eval_loss': 1.2584867477416992, 'eval_precision': 0.037037037037037035, 'eval_recall': 0.09302325581395349, 'eval_f1': 0.05298013245033112, 'eval_accuracy': 0.48619809788912083, 'eval_runtime': 1.6191, 'eval_samples_per_second': 30.881, 'eval_steps_per_second': 2.47, 'epoch': 0.74}
{'loss': 0.0466, 'learning_rate': 9.10952804986643e-06, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.00      0.00      0.00        40
     UESTION       0.01      0.07      0.02        46

   micro avg       0.01      0.03      0.01        86
   macro avg       0.01      0.03      0.01        86
weighted avg       0.01      0.03      0.01        86

{'eval_loss': 0.8638311624526978, 'eval_precision': 0.00505902192242833, 'eval_recall': 0.03488372093023256, 'eval_f1': 0.008836524300441826, 'eval_accuracy': 0.5768963117606124, 'eval_runtime': 1.591, 'eval_samples_per_second': 31.427, 'eval_steps_per_second': 2.514, 'epoch': 0.89}
{'loss': 0.0431, 'learning_rate': 8.961116058177501e-06, 'epoch': 1.04}
              precision    recall  f1-score   support

       NSWER       0.04      0.15      0.07        40
     UESTION       0.00      0.00      0.00        46

   micro avg       0.04      0.07      0.05        86
   macro avg       0.02      0.07      0.03        86
weighted avg       0.02      0.07      0.03        86

{'eval_loss': 1.0154021978378296, 'eval_precision': 0.039735099337748346, 'eval_recall': 0.06976744186046512, 'eval_f1': 0.05063291139240506, 'eval_accuracy': 0.5431454418928323, 'eval_runtime': 0.5486, 'eval_samples_per_second': 91.141, 'eval_steps_per_second': 7.291, 'epoch': 1.04}
{'loss': 0.0345, 'learning_rate': 8.812704066488573e-06, 'epoch': 1.19}
              precision    recall  f1-score   support

       NSWER       0.00      0.03      0.01        40
     UESTION       0.08      0.02      0.03        46

   micro avg       0.01      0.02      0.01        86
   macro avg       0.04      0.02      0.02        86
weighted avg       0.04      0.02      0.02        86

{'eval_loss': 0.9111560583114624, 'eval_precision': 0.007407407407407408, 'eval_recall': 0.023255813953488372, 'eval_f1': 0.011235955056179775, 'eval_accuracy': 0.5298074692646718, 'eval_runtime': 0.5417, 'eval_samples_per_second': 92.296, 'eval_steps_per_second': 7.384, 'epoch': 1.19}
{'loss': 0.0372, 'learning_rate': 8.664292074799646e-06, 'epoch': 1.34}
              precision    recall  f1-score   support

       NSWER       0.00      0.00      0.00        40
     UESTION       0.01      0.02      0.01        46

   micro avg       0.00      0.01      0.00        86
   macro avg       0.00      0.01      0.01        86
weighted avg       0.00      0.01      0.01        86

{'eval_loss': 0.8322344422340393, 'eval_precision': 0.002053388090349076, 'eval_recall': 0.011627906976744186, 'eval_f1': 0.003490401396160559, 'eval_accuracy': 0.6185339828346091, 'eval_runtime': 0.5793, 'eval_samples_per_second': 86.31, 'eval_steps_per_second': 6.905, 'epoch': 1.34}
{'loss': 0.0387, 'learning_rate': 8.515880083110716e-06, 'epoch': 1.48}
              precision    recall  f1-score   support

       NSWER       0.07      0.20      0.11        40
     UESTION       0.01      0.02      0.01        46

   micro avg       0.03      0.10      0.05        86
   macro avg       0.04      0.11      0.06        86
weighted avg       0.04      0.10      0.05        86

{'eval_loss': 1.9369540214538574, 'eval_precision': 0.03202846975088968, 'eval_recall': 0.10465116279069768, 'eval_f1': 0.04904632152588556, 'eval_accuracy': 0.5775922059846903, 'eval_runtime': 0.5798, 'eval_samples_per_second': 86.232, 'eval_steps_per_second': 6.899, 'epoch': 1.48}
{'loss': 0.0352, 'learning_rate': 8.367468091421787e-06, 'epoch': 1.63}
              precision    recall  f1-score   support

       NSWER       0.05      0.17      0.08        40
     UESTION       0.04      0.11      0.06        46

   micro avg       0.05      0.14      0.07        86
   macro avg       0.05      0.14      0.07        86
weighted avg       0.05      0.14      0.07        86

{'eval_loss': 1.3323755264282227, 'eval_precision': 0.04597701149425287, 'eval_recall': 0.13953488372093023, 'eval_f1': 0.069164265129683, 'eval_accuracy': 0.5760844351658548, 'eval_runtime': 0.587, 'eval_samples_per_second': 85.173, 'eval_steps_per_second': 6.814, 'epoch': 1.63}
{'loss': 0.0347, 'learning_rate': 8.21905609973286e-06, 'epoch': 1.78}
              precision    recall  f1-score   support

       NSWER       0.06      0.17      0.09        40
     UESTION       0.03      0.07      0.04        46

   micro avg       0.04      0.12      0.06        86
   macro avg       0.04      0.12      0.06        86
weighted avg       0.04      0.12      0.06        86

{'eval_loss': 1.2515604496002197, 'eval_precision': 0.044642857142857144, 'eval_recall': 0.11627906976744186, 'eval_f1': 0.06451612903225808, 'eval_accuracy': 0.6042681512410114, 'eval_runtime': 0.5866, 'eval_samples_per_second': 85.234, 'eval_steps_per_second': 6.819, 'epoch': 1.78}
{'loss': 0.0341, 'learning_rate': 8.07064410804393e-06, 'epoch': 1.93}
              precision    recall  f1-score   support

       NSWER       0.09      0.20      0.13        40
     UESTION       0.08      0.09      0.08        46

   micro avg       0.09      0.14      0.11        86
   macro avg       0.08      0.14      0.10        86
weighted avg       0.08      0.14      0.10        86

{'eval_loss': 2.1820976734161377, 'eval_precision': 0.08633093525179857, 'eval_recall': 0.13953488372093023, 'eval_f1': 0.10666666666666667, 'eval_accuracy': 0.5927858965437254, 'eval_runtime': 0.5619, 'eval_samples_per_second': 88.991, 'eval_steps_per_second': 7.119, 'epoch': 1.93}
{'loss': 0.0294, 'learning_rate': 7.922232116355003e-06, 'epoch': 2.08}
              precision    recall  f1-score   support

       NSWER       0.01      0.03      0.01        40
     UESTION       0.05      0.13      0.07        46

   micro avg       0.02      0.08      0.03        86
   macro avg       0.03      0.08      0.04        86
weighted avg       0.03      0.08      0.04        86

{'eval_loss': 1.3699922561645508, 'eval_precision': 0.021806853582554516, 'eval_recall': 0.08139534883720931, 'eval_f1': 0.03439803439803439, 'eval_accuracy': 0.5948735792159592, 'eval_runtime': 0.5271, 'eval_samples_per_second': 94.854, 'eval_steps_per_second': 7.588, 'epoch': 2.08}
{'train_runtime': 6251.1634, 'train_samples_per_second': 215.573, 'train_steps_per_second': 26.947, 'train_loss': 0.049893505205426895, 'epoch': 2.08}
saved model
              precision    recall  f1-score   support

       NSWER       0.03      0.10      0.04        58
     UESTION       0.02      0.07      0.03        73

   micro avg       0.02      0.08      0.04       131
   macro avg       0.02      0.09      0.04       131
weighted avg       0.02      0.08      0.04       131

{'epoch': 2.08,
 'eval_accuracy': 0.6826347305389222,
 'eval_f1': 0.03697478991596639,
 'eval_loss': 0.7766866683959961,
 'eval_precision': 0.023706896551724137,
 'eval_recall': 0.08396946564885496,
 'eval_runtime': 0.7376,
 'eval_samples_per_second': 92.188,
 'eval_steps_per_second': 6.779}
Accuracy: 0.6826347305389222
END 4747123: Thu 12 Oct 2023 04:44:01 PM EEST
