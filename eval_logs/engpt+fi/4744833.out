START 4744833: Thu 12 Oct 2023 11:16:06 AM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl'], test='../../data/qa_token_classification/annotated/test_annotated_dataset.jsonl', dev='../../data/qa_token_classification/annotated/dev_annotated_dataset.jsonl', batch=8, epochs=10, lr=2e-05, save=None, dataset=None)
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138082
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138082
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 50
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 68
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1386, 'learning_rate': 1.9710329644864146e-05, 'epoch': 0.14}
              precision    recall  f1-score   support

       NSWER       0.03      0.05      0.03        40
     UESTION       0.07      0.09      0.08        46

   micro avg       0.05      0.07      0.06        86
   macro avg       0.05      0.07      0.06        86
weighted avg       0.05      0.07      0.06        86

{'eval_loss': 0.9888586401939392, 'eval_precision': 0.045454545454545456, 'eval_recall': 0.06976744186046512, 'eval_f1': 0.055045871559633024, 'eval_accuracy': 0.5993419387496837, 'eval_runtime': 0.5601, 'eval_samples_per_second': 89.276, 'eval_steps_per_second': 7.142, 'epoch': 0.14}
{'loss': 0.088, 'learning_rate': 1.942065928972829e-05, 'epoch': 0.29}
              precision    recall  f1-score   support

       NSWER       0.03      0.05      0.04        40
     UESTION       0.06      0.04      0.05        46

   micro avg       0.04      0.05      0.04        86
   macro avg       0.04      0.05      0.04        86
weighted avg       0.04      0.05      0.04        86

{'eval_loss': 1.119116187095642, 'eval_precision': 0.038461538461538464, 'eval_recall': 0.046511627906976744, 'eval_f1': 0.042105263157894736, 'eval_accuracy': 0.6031384459630473, 'eval_runtime': 0.5115, 'eval_samples_per_second': 97.746, 'eval_steps_per_second': 7.82, 'epoch': 0.29}
{'loss': 0.0738, 'learning_rate': 1.9130988934592435e-05, 'epoch': 0.43}
              precision    recall  f1-score   support

       NSWER       0.08      0.20      0.12        40
     UESTION       0.18      0.33      0.23        46

   micro avg       0.13      0.27      0.17        86
   macro avg       0.13      0.26      0.18        86
weighted avg       0.14      0.27      0.18        86

{'eval_loss': 0.6482819318771362, 'eval_precision': 0.12849162011173185, 'eval_recall': 0.26744186046511625, 'eval_f1': 0.17358490566037738, 'eval_accuracy': 0.7231080739053404, 'eval_runtime': 0.5396, 'eval_samples_per_second': 92.665, 'eval_steps_per_second': 7.413, 'epoch': 0.43}
{'loss': 0.0709, 'learning_rate': 1.884131857945658e-05, 'epoch': 0.58}
              precision    recall  f1-score   support

       NSWER       0.17      0.35      0.23        40
     UESTION       0.24      0.43      0.31        46

   micro avg       0.21      0.40      0.27        86
   macro avg       0.21      0.39      0.27        86
weighted avg       0.21      0.40      0.27        86

{'eval_loss': 0.6239482760429382, 'eval_precision': 0.2085889570552147, 'eval_recall': 0.3953488372093023, 'eval_f1': 0.27309236947791166, 'eval_accuracy': 0.7217160212604404, 'eval_runtime': 0.5247, 'eval_samples_per_second': 95.284, 'eval_steps_per_second': 7.623, 'epoch': 0.58}
{'loss': 0.0657, 'learning_rate': 1.8551648224320723e-05, 'epoch': 0.72}
              precision    recall  f1-score   support

       NSWER       0.22      0.47      0.30        40
     UESTION       0.27      0.54      0.36        46

   micro avg       0.25      0.51      0.33        86
   macro avg       0.25      0.51      0.33        86
weighted avg       0.25      0.51      0.33        86

{'eval_loss': 0.757283627986908, 'eval_precision': 0.24581005586592178, 'eval_recall': 0.5116279069767442, 'eval_f1': 0.33207547169811324, 'eval_accuracy': 0.7209567198177677, 'eval_runtime': 1.5898, 'eval_samples_per_second': 31.45, 'eval_steps_per_second': 2.516, 'epoch': 0.72}
{'loss': 0.0633, 'learning_rate': 1.8261977869184867e-05, 'epoch': 0.87}
              precision    recall  f1-score   support

       NSWER       0.16      0.20      0.18        40
     UESTION       0.26      0.43      0.32        46

   micro avg       0.22      0.33      0.26        86
   macro avg       0.21      0.32      0.25        86
weighted avg       0.21      0.33      0.26        86

{'eval_loss': 1.0634651184082031, 'eval_precision': 0.21875, 'eval_recall': 0.32558139534883723, 'eval_f1': 0.2616822429906542, 'eval_accuracy': 0.6915970640344217, 'eval_runtime': 0.6799, 'eval_samples_per_second': 73.541, 'eval_steps_per_second': 5.883, 'epoch': 0.87}
{'loss': 0.0594, 'learning_rate': 1.7972307514049015e-05, 'epoch': 1.01}
              precision    recall  f1-score   support

       NSWER       0.17      0.40      0.24        40
     UESTION       0.35      0.41      0.38        46

   micro avg       0.23      0.41      0.30        86
   macro avg       0.26      0.41      0.31        86
weighted avg       0.26      0.41      0.31        86

{'eval_loss': 0.6092563271522522, 'eval_precision': 0.23333333333333334, 'eval_recall': 0.4069767441860465, 'eval_f1': 0.2966101694915254, 'eval_accuracy': 0.7363958491521134, 'eval_runtime': 1.0777, 'eval_samples_per_second': 46.393, 'eval_steps_per_second': 3.711, 'epoch': 1.01}
{'loss': 0.0496, 'learning_rate': 1.768263715891316e-05, 'epoch': 1.16}
              precision    recall  f1-score   support

       NSWER       0.18      0.17      0.18        40
     UESTION       0.29      0.22      0.25        46

   micro avg       0.24      0.20      0.22        86
   macro avg       0.24      0.20      0.21        86
weighted avg       0.24      0.20      0.22        86

{'eval_loss': 1.4309947490692139, 'eval_precision': 0.2361111111111111, 'eval_recall': 0.19767441860465115, 'eval_f1': 0.21518987341772153, 'eval_accuracy': 0.6748924322956213, 'eval_runtime': 0.5188, 'eval_samples_per_second': 96.384, 'eval_steps_per_second': 7.711, 'epoch': 1.16}
{'loss': 0.0526, 'learning_rate': 1.7392966803777304e-05, 'epoch': 1.3}
              precision    recall  f1-score   support

       NSWER       0.18      0.38      0.25        40
     UESTION       0.23      0.37      0.28        46

   micro avg       0.20      0.37      0.26        86
   macro avg       0.20      0.37      0.26        86
weighted avg       0.21      0.37      0.26        86

{'eval_loss': 0.5970670580863953, 'eval_precision': 0.20382165605095542, 'eval_recall': 0.37209302325581395, 'eval_f1': 0.26337448559670784, 'eval_accuracy': 0.7529739306504682, 'eval_runtime': 0.5389, 'eval_samples_per_second': 92.776, 'eval_steps_per_second': 7.422, 'epoch': 1.3}
{'loss': 0.0491, 'learning_rate': 1.7103296448641448e-05, 'epoch': 1.45}
              precision    recall  f1-score   support

       NSWER       0.18      0.17      0.18        40
     UESTION       0.59      0.28      0.38        46

   micro avg       0.33      0.23      0.27        86
   macro avg       0.39      0.23      0.28        86
weighted avg       0.40      0.23      0.29        86

{'eval_loss': 1.4741390943527222, 'eval_precision': 0.32786885245901637, 'eval_recall': 0.23255813953488372, 'eval_f1': 0.27210884353741494, 'eval_accuracy': 0.6332574031890661, 'eval_runtime': 0.5339, 'eval_samples_per_second': 93.644, 'eval_steps_per_second': 7.492, 'epoch': 1.45}
{'loss': 0.0453, 'learning_rate': 1.6813626093505592e-05, 'epoch': 1.59}
              precision    recall  f1-score   support

       NSWER       0.12      0.23      0.15        40
     UESTION       0.18      0.37      0.24        46

   micro avg       0.15      0.30      0.20        86
   macro avg       0.15      0.30      0.20        86
weighted avg       0.15      0.30      0.20        86

{'eval_loss': 0.5980815887451172, 'eval_precision': 0.14857142857142858, 'eval_recall': 0.3023255813953488, 'eval_f1': 0.1992337164750958, 'eval_accuracy': 0.7228549734244495, 'eval_runtime': 0.5828, 'eval_samples_per_second': 85.793, 'eval_steps_per_second': 6.863, 'epoch': 1.59}
{'loss': 0.051, 'learning_rate': 1.6523955738369737e-05, 'epoch': 1.74}
              precision    recall  f1-score   support

       NSWER       0.16      0.25      0.19        40
     UESTION       0.29      0.41      0.34        46

   micro avg       0.22      0.34      0.27        86
   macro avg       0.22      0.33      0.27        86
weighted avg       0.23      0.34      0.27        86

{'eval_loss': 0.7805923223495483, 'eval_precision': 0.2248062015503876, 'eval_recall': 0.3372093023255814, 'eval_f1': 0.2697674418604651, 'eval_accuracy': 0.7084282460136674, 'eval_runtime': 0.5253, 'eval_samples_per_second': 95.176, 'eval_steps_per_second': 7.614, 'epoch': 1.74}
{'loss': 0.0471, 'learning_rate': 1.623428538323388e-05, 'epoch': 1.88}
              precision    recall  f1-score   support

       NSWER       0.26      0.55      0.35        40
     UESTION       0.21      0.41      0.28        46

   micro avg       0.24      0.48      0.32        86
   macro avg       0.24      0.48      0.32        86
weighted avg       0.23      0.48      0.31        86

{'eval_loss': 0.5634579658508301, 'eval_precision': 0.23563218390804597, 'eval_recall': 0.47674418604651164, 'eval_f1': 0.31538461538461543, 'eval_accuracy': 0.7978992660086054, 'eval_runtime': 0.5437, 'eval_samples_per_second': 91.966, 'eval_steps_per_second': 7.357, 'epoch': 1.88}
{'loss': 0.0431, 'learning_rate': 1.5944615028098025e-05, 'epoch': 2.03}
              precision    recall  f1-score   support

       NSWER       0.26      0.23      0.24        40
     UESTION       0.61      0.37      0.46        46

   micro avg       0.41      0.30      0.35        86
   macro avg       0.43      0.30      0.35        86
weighted avg       0.44      0.30      0.36        86

{'eval_loss': 0.9568522572517395, 'eval_precision': 0.4126984126984127, 'eval_recall': 0.3023255813953488, 'eval_f1': 0.348993288590604, 'eval_accuracy': 0.6433814224247026, 'eval_runtime': 0.5266, 'eval_samples_per_second': 94.949, 'eval_steps_per_second': 7.596, 'epoch': 2.03}
{'loss': 0.0341, 'learning_rate': 1.5654944672962173e-05, 'epoch': 2.17}
              precision    recall  f1-score   support

       NSWER       0.20      0.42      0.27        40
     UESTION       0.25      0.46      0.33        46

   micro avg       0.22      0.44      0.30        86
   macro avg       0.23      0.44      0.30        86
weighted avg       0.23      0.44      0.30        86

{'eval_loss': 0.5220099091529846, 'eval_precision': 0.22485207100591717, 'eval_recall': 0.4418604651162791, 'eval_f1': 0.2980392156862745, 'eval_accuracy': 0.7863831941280689, 'eval_runtime': 0.5434, 'eval_samples_per_second': 92.018, 'eval_steps_per_second': 7.361, 'epoch': 2.17}
{'loss': 0.0381, 'learning_rate': 1.5365274317826314e-05, 'epoch': 2.32}
              precision    recall  f1-score   support

       NSWER       0.27      0.38      0.31        40
     UESTION       0.41      0.39      0.40        46

   micro avg       0.33      0.38      0.35        86
   macro avg       0.34      0.38      0.36        86
weighted avg       0.34      0.38      0.36        86

{'eval_loss': 0.7657216787338257, 'eval_precision': 0.33, 'eval_recall': 0.38372093023255816, 'eval_f1': 0.3548387096774193, 'eval_accuracy': 0.7517084282460137, 'eval_runtime': 1.5897, 'eval_samples_per_second': 31.452, 'eval_steps_per_second': 2.516, 'epoch': 2.32}
{'loss': 0.0334, 'learning_rate': 1.507560396269046e-05, 'epoch': 2.46}
              precision    recall  f1-score   support

       NSWER       0.18      0.33      0.23        40
     UESTION       0.53      0.46      0.49        46

   micro avg       0.31      0.40      0.35        86
   macro avg       0.35      0.39      0.36        86
weighted avg       0.37      0.40      0.37        86

{'eval_loss': 0.6956514120101929, 'eval_precision': 0.3063063063063063, 'eval_recall': 0.3953488372093023, 'eval_f1': 0.3451776649746192, 'eval_accuracy': 0.731586940015186, 'eval_runtime': 0.5454, 'eval_samples_per_second': 91.677, 'eval_steps_per_second': 7.334, 'epoch': 2.46}
{'loss': 0.0334, 'learning_rate': 1.4785933607554604e-05, 'epoch': 2.61}
              precision    recall  f1-score   support

       NSWER       0.21      0.47      0.29        40
     UESTION       0.28      0.48      0.35        46

   micro avg       0.24      0.48      0.32        86
   macro avg       0.24      0.48      0.32        86
weighted avg       0.25      0.48      0.32        86

{'eval_loss': 0.5968358516693115, 'eval_precision': 0.24260355029585798, 'eval_recall': 0.47674418604651164, 'eval_f1': 0.3215686274509804, 'eval_accuracy': 0.7615793470007594, 'eval_runtime': 0.5354, 'eval_samples_per_second': 93.393, 'eval_steps_per_second': 7.471, 'epoch': 2.61}
{'loss': 0.0353, 'learning_rate': 1.449626325241875e-05, 'epoch': 2.75}
              precision    recall  f1-score   support

       NSWER       0.17      0.47      0.25        40
     UESTION       0.24      0.46      0.31        46

   micro avg       0.20      0.47      0.28        86
   macro avg       0.20      0.47      0.28        86
weighted avg       0.21      0.47      0.28        86

{'eval_loss': 0.762187659740448, 'eval_precision': 0.19900497512437812, 'eval_recall': 0.46511627906976744, 'eval_f1': 0.2787456445993031, 'eval_accuracy': 0.7018476335105037, 'eval_runtime': 0.9894, 'eval_samples_per_second': 50.536, 'eval_steps_per_second': 4.043, 'epoch': 2.75}
{'loss': 0.0354, 'learning_rate': 1.4206592897282894e-05, 'epoch': 2.9}
              precision    recall  f1-score   support

       NSWER       0.38      0.38      0.38        40
     UESTION       0.34      0.35      0.34        46

   micro avg       0.36      0.36      0.36        86
   macro avg       0.36      0.36      0.36        86
weighted avg       0.36      0.36      0.36        86

{'eval_loss': 1.0566767454147339, 'eval_precision': 0.36046511627906974, 'eval_recall': 0.36046511627906974, 'eval_f1': 0.36046511627906974, 'eval_accuracy': 0.7180460642875222, 'eval_runtime': 0.5247, 'eval_samples_per_second': 95.287, 'eval_steps_per_second': 7.623, 'epoch': 2.9}
{'train_runtime': 9396.0847, 'train_samples_per_second': 146.957, 'train_steps_per_second': 18.37, 'train_loss': 0.055361212158203124, 'epoch': 2.9}
              precision    recall  f1-score   support

       NSWER       0.29      0.47      0.36        59
     UESTION       0.42      0.64      0.51        73

   micro avg       0.36      0.57      0.44       132
   macro avg       0.36      0.56      0.44       132
weighted avg       0.37      0.57      0.45       132

{'epoch': 2.9,
 'eval_accuracy': 0.8645234279249552,
 'eval_f1': 0.44378698224852076,
 'eval_loss': 0.3626936078071594,
 'eval_precision': 0.3640776699029126,
 'eval_recall': 0.5681818181818182,
 'eval_runtime': 0.8092,
 'eval_samples_per_second': 84.034,
 'eval_steps_per_second': 6.179}
Accuracy: 0.8645234279249552
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	2e-5	num_train_epochs	10	END 4744833: Thu 12 Oct 2023 01:58:11 PM EEST
