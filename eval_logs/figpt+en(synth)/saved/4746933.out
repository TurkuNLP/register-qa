
START 4746933: Thu 12 Oct 2023 02:33:47 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/annotated/cleaned2_train_annotated_dataset.jsonl', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl'], test='../../data/qa_token_classification/dataset_punct2', dev='../../data/qa_token_classification/dataset_punct2', batch=8, epochs=10, lr=5e-05, save='figpt_en_5e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3524
    })
})
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3524
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.8535, 'learning_rate': 4.71655328798186e-05, 'epoch': 0.57}
              precision    recall  f1-score   support

       NSWER       0.02      0.15      0.03      1659
     UESTION       0.04      0.18      0.06      1683

   micro avg       0.03      0.16      0.05      3342
   macro avg       0.03      0.16      0.05      3342
weighted avg       0.03      0.16      0.05      3342

{'eval_loss': 0.7969417572021484, 'eval_precision': 0.02673849651559334, 'eval_recall': 0.16187911430281268, 'eval_f1': 0.04589607635206786, 'eval_accuracy': 0.6392346344055042, 'eval_runtime': 21.8161, 'eval_samples_per_second': 77.145, 'eval_steps_per_second': 4.859, 'epoch': 0.57}
{'loss': 0.6973, 'learning_rate': 4.433106575963719e-05, 'epoch': 1.13}
              precision    recall  f1-score   support

       NSWER       0.10      0.31      0.15      1659
     UESTION       0.12      0.33      0.18      1683

   micro avg       0.11      0.32      0.16      3342
   macro avg       0.11      0.32      0.16      3342
weighted avg       0.11      0.32      0.16      3342

{'eval_loss': 0.6057602763175964, 'eval_precision': 0.10734177215189873, 'eval_recall': 0.31717534410532616, 'eval_f1': 0.1603994855110842, 'eval_accuracy': 0.8229054605911785, 'eval_runtime': 22.8287, 'eval_samples_per_second': 73.723, 'eval_steps_per_second': 4.643, 'epoch': 1.13}
{'loss': 0.6278, 'learning_rate': 4.149659863945579e-05, 'epoch': 1.7}
              precision    recall  f1-score   support

       NSWER       0.07      0.25      0.11      1659
     UESTION       0.13      0.38      0.20      1683

   micro avg       0.10      0.32      0.15      3342
   macro avg       0.10      0.32      0.16      3342
weighted avg       0.10      0.32      0.16      3342

{'eval_loss': 0.7183510065078735, 'eval_precision': 0.10170792554212243, 'eval_recall': 0.31717534410532616, 'eval_f1': 0.15402499273467016, 'eval_accuracy': 0.7855623015946438, 'eval_runtime': 21.6162, 'eval_samples_per_second': 77.858, 'eval_steps_per_second': 4.904, 'epoch': 1.7}
{'loss': 0.5385, 'learning_rate': 3.8662131519274384e-05, 'epoch': 2.27}
              precision    recall  f1-score   support

       NSWER       0.12      0.34      0.18      1659
     UESTION       0.12      0.31      0.17      1683

   micro avg       0.12      0.33      0.18      3342
   macro avg       0.12      0.33      0.18      3342
weighted avg       0.12      0.33      0.18      3342

{'eval_loss': 0.5648478269577026, 'eval_precision': 0.12013704686118479, 'eval_recall': 0.32525433871932974, 'eval_f1': 0.1754640839386602, 'eval_accuracy': 0.8370148732981083, 'eval_runtime': 22.0461, 'eval_samples_per_second': 76.34, 'eval_steps_per_second': 4.808, 'epoch': 2.27}
{'loss': 0.5069, 'learning_rate': 3.5827664399092974e-05, 'epoch': 2.83}
              precision    recall  f1-score   support

       NSWER       0.04      0.16      0.07      1659
     UESTION       0.08      0.25      0.13      1683

   micro avg       0.06      0.20      0.09      3342
   macro avg       0.06      0.20      0.10      3342
weighted avg       0.06      0.20      0.10      3342

{'eval_loss': 1.1523035764694214, 'eval_precision': 0.06093189964157706, 'eval_recall': 0.20347097546379414, 'eval_f1': 0.0937801682526548, 'eval_accuracy': 0.5665122155584161, 'eval_runtime': 21.048, 'eval_samples_per_second': 79.96, 'eval_steps_per_second': 5.036, 'epoch': 2.83}
{'loss': 0.4346, 'learning_rate': 3.2993197278911564e-05, 'epoch': 3.4}
              precision    recall  f1-score   support

       NSWER       0.10      0.29      0.15      1659
     UESTION       0.12      0.34      0.17      1683

   micro avg       0.11      0.31      0.16      3342
   macro avg       0.11      0.31      0.16      3342
weighted avg       0.11      0.31      0.16      3342

{'eval_loss': 0.5358873009681702, 'eval_precision': 0.10935386536260534, 'eval_recall': 0.31448234590065827, 'eval_f1': 0.16227900872384773, 'eval_accuracy': 0.804635647809182, 'eval_runtime': 21.8963, 'eval_samples_per_second': 76.862, 'eval_steps_per_second': 4.841, 'epoch': 3.4}
{'loss': 0.3903, 'learning_rate': 3.0158730158730158e-05, 'epoch': 3.97}
              precision    recall  f1-score   support

       NSWER       0.10      0.24      0.14      1659
     UESTION       0.14      0.32      0.20      1683

   micro avg       0.12      0.28      0.17      3342
   macro avg       0.12      0.28      0.17      3342
weighted avg       0.12      0.28      0.17      3342

{'eval_loss': 0.9637091159820557, 'eval_precision': 0.11824410048211113, 'eval_recall': 0.2788749251944943, 'eval_f1': 0.16607270135424088, 'eval_accuracy': 0.7204787367608616, 'eval_runtime': 21.4902, 'eval_samples_per_second': 78.315, 'eval_steps_per_second': 4.932, 'epoch': 3.97}
{'loss': 0.3047, 'learning_rate': 2.732426303854875e-05, 'epoch': 4.54}
              precision    recall  f1-score   support

       NSWER       0.15      0.38      0.22      1659
     UESTION       0.14      0.33      0.20      1683

   micro avg       0.15      0.35      0.21      3342
   macro avg       0.15      0.35      0.21      3342
weighted avg       0.15      0.35      0.21      3342

{'eval_loss': 0.6548269391059875, 'eval_precision': 0.14896291640477688, 'eval_recall': 0.35457809694793535, 'eval_f1': 0.20979020979020976, 'eval_accuracy': 0.8229768270473583, 'eval_runtime': 21.7733, 'eval_samples_per_second': 77.296, 'eval_steps_per_second': 4.868, 'epoch': 4.54}
{'loss': 0.2717, 'learning_rate': 2.448979591836735e-05, 'epoch': 5.1}
              precision    recall  f1-score   support

       NSWER       0.08      0.23      0.12      1659
     UESTION       0.11      0.32      0.16      1683

   micro avg       0.10      0.27      0.14      3342
   macro avg       0.10      0.27      0.14      3342
weighted avg       0.10      0.27      0.14      3342

{'eval_loss': 0.8339211940765381, 'eval_precision': 0.09716470213443772, 'eval_recall': 0.2737881508078995, 'eval_f1': 0.1434281683517517, 'eval_accuracy': 0.7845737440164513, 'eval_runtime': 21.7731, 'eval_samples_per_second': 77.297, 'eval_steps_per_second': 4.868, 'epoch': 5.1}
{'loss': 0.2255, 'learning_rate': 2.1655328798185942e-05, 'epoch': 5.67}
              precision    recall  f1-score   support

       NSWER       0.09      0.26      0.13      1659
     UESTION       0.11      0.33      0.17      1683

   micro avg       0.10      0.30      0.15      3342
   macro avg       0.10      0.30      0.15      3342
weighted avg       0.10      0.30      0.15      3342

{'eval_loss': 0.8511521816253662, 'eval_precision': 0.10114755763176601, 'eval_recall': 0.2980251346499102, 'eval_f1': 0.15103495337023273, 'eval_accuracy': 0.775409762402565, 'eval_runtime': 21.7441, 'eval_samples_per_second': 77.4, 'eval_steps_per_second': 4.875, 'epoch': 5.67}
{'loss': 0.193, 'learning_rate': 1.8820861678004536e-05, 'epoch': 6.24}
              precision    recall  f1-score   support

       NSWER       0.13      0.32      0.19      1659
     UESTION       0.16      0.36      0.22      1683

   micro avg       0.14      0.34      0.20      3342
   macro avg       0.14      0.34      0.20      3342
weighted avg       0.14      0.34      0.20      3342

{'eval_loss': 0.8482562303543091, 'eval_precision': 0.1445248064966375, 'eval_recall': 0.3408138839018552, 'eval_f1': 0.2029760313641629, 'eval_accuracy': 0.8086083805365172, 'eval_runtime': 21.8412, 'eval_samples_per_second': 77.056, 'eval_steps_per_second': 4.853, 'epoch': 6.24}
{'train_runtime': 746.6765, 'train_samples_per_second': 47.196, 'train_steps_per_second': 5.906, 'train_loss': 0.4585275351784446, 'epoch': 6.24}
saved model
              precision    recall  f1-score   support

       NSWER       0.11      0.31      0.16      5623
     UESTION       0.13      0.36      0.19      5693

   micro avg       0.12      0.33      0.18     11316
   macro avg       0.12      0.33      0.18     11316
weighted avg       0.12      0.33      0.18     11316

{'epoch': 6.24,
 'eval_accuracy': 0.8185651462057971,
 'eval_f1': 0.17556446507702048,
 'eval_loss': 0.5028007626533508,
 'eval_precision': 0.11948300622307324,
 'eval_recall': 0.33085896076352067,
 'eval_runtime': 74.8114,
 'eval_samples_per_second': 76.098,
 'eval_steps_per_second': 4.759}
Accuracy: 0.8185651462057971
END 4746933: Thu 12 Oct 2023 02:48:28 PM EEST
