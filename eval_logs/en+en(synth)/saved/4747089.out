
START 4747089: Thu 12 Oct 2023 02:52:55 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2'], test='../../data/qa_token_classification/dataset_punct2', dev='../../data/qa_token_classification/dataset_punct2', batch=8, epochs=10, lr=3e-05, save='en_en_3e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1198, 'learning_rate': 2.95544466227054e-05, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.55      0.78      0.64      1659
     UESTION       0.55      0.79      0.65      1683

   micro avg       0.55      0.79      0.65      3342
   macro avg       0.55      0.79      0.65      3342
weighted avg       0.55      0.79      0.65      3342

{'eval_loss': 0.10745374113321304, 'eval_precision': 0.5485284909204758, 'eval_recall': 0.7863554757630161, 'eval_f1': 0.6462559940981187, 'eval_accuracy': 0.9652207470217721, 'eval_runtime': 24.5582, 'eval_samples_per_second': 68.531, 'eval_steps_per_second': 4.316, 'epoch': 0.15}
{'loss': 0.0763, 'learning_rate': 2.91088932454108e-05, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.72      0.84      0.78      1659
     UESTION       0.73      0.84      0.78      1683

   micro avg       0.72      0.84      0.78      3342
   macro avg       0.72      0.84      0.78      3342
weighted avg       0.72      0.84      0.78      3342

{'eval_loss': 0.12908314168453217, 'eval_precision': 0.7249224405377456, 'eval_recall': 0.83901855176541, 'eval_f1': 0.7778085991678224, 'eval_accuracy': 0.9631458333884001, 'eval_runtime': 24.4518, 'eval_samples_per_second': 68.829, 'eval_steps_per_second': 4.335, 'epoch': 0.3}
{'loss': 0.0669, 'learning_rate': 2.86633398681162e-05, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.80      0.87      0.84      1659
     UESTION       0.79      0.86      0.82      1683

   micro avg       0.79      0.87      0.83      3342
   macro avg       0.79      0.87      0.83      3342
weighted avg       0.79      0.87      0.83      3342

{'eval_loss': 0.10722443461418152, 'eval_precision': 0.7941822173435785, 'eval_recall': 0.8659485338120886, 'eval_f1': 0.828514171199542, 'eval_accuracy': 0.9746939832791036, 'eval_runtime': 24.3809, 'eval_samples_per_second': 69.03, 'eval_steps_per_second': 4.348, 'epoch': 0.45}
{'loss': 0.0645, 'learning_rate': 2.82177864908216e-05, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.79      0.87      0.83      1659
     UESTION       0.79      0.87      0.83      1683

   micro avg       0.79      0.87      0.83      3342
   macro avg       0.79      0.87      0.83      3342
weighted avg       0.79      0.87      0.83      3342

{'eval_loss': 0.08640608191490173, 'eval_precision': 0.7909189777052746, 'eval_recall': 0.8704368641532017, 'eval_f1': 0.8287749287749289, 'eval_accuracy': 0.9787486552709415, 'eval_runtime': 24.3614, 'eval_samples_per_second': 69.085, 'eval_steps_per_second': 4.351, 'epoch': 0.59}
{'loss': 0.0573, 'learning_rate': 2.7772233113527e-05, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.83      0.88      0.85      1659
     UESTION       0.83      0.88      0.85      1683

   micro avg       0.83      0.88      0.85      3342
   macro avg       0.83      0.88      0.85      3342
weighted avg       0.83      0.88      0.85      3342

{'eval_loss': 0.11424379795789719, 'eval_precision': 0.8283624085537422, 'eval_recall': 0.8809096349491322, 'eval_f1': 0.8538283062645011, 'eval_accuracy': 0.9749292282642885, 'eval_runtime': 24.5014, 'eval_samples_per_second': 68.69, 'eval_steps_per_second': 4.326, 'epoch': 0.74}
{'loss': 0.0508, 'learning_rate': 2.7326679736232404e-05, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.82      0.88      0.85      1659
     UESTION       0.82      0.87      0.84      1683

   micro avg       0.82      0.88      0.85      3342
   macro avg       0.82      0.88      0.85      3342
weighted avg       0.82      0.88      0.85      3342

{'eval_loss': 0.0791822001338005, 'eval_precision': 0.8180803571428571, 'eval_recall': 0.8773189706762418, 'eval_f1': 0.8466647415535663, 'eval_accuracy': 0.9796552735846313, 'eval_runtime': 24.5188, 'eval_samples_per_second': 68.641, 'eval_steps_per_second': 4.323, 'epoch': 0.89}
{'loss': 0.0443, 'learning_rate': 2.68811263589378e-05, 'epoch': 1.04}
              precision    recall  f1-score   support

       NSWER       0.85      0.90      0.87      1659
     UESTION       0.85      0.89      0.87      1683

   micro avg       0.85      0.89      0.87      3342
   macro avg       0.85      0.89      0.87      3342
weighted avg       0.85      0.89      0.87      3342

{'eval_loss': 0.0834711417555809, 'eval_precision': 0.8508821855435401, 'eval_recall': 0.8946738479952124, 'eval_f1': 0.8722287047841307, 'eval_accuracy': 0.978685218421004, 'eval_runtime': 24.3759, 'eval_samples_per_second': 69.044, 'eval_steps_per_second': 4.349, 'epoch': 1.04}
{'loss': 0.0426, 'learning_rate': 2.64355729816432e-05, 'epoch': 1.19}
              precision    recall  f1-score   support

       NSWER       0.86      0.90      0.88      1659
     UESTION       0.86      0.90      0.88      1683

   micro avg       0.86      0.90      0.88      3342
   macro avg       0.86      0.90      0.88      3342
weighted avg       0.86      0.90      0.88      3342

{'eval_loss': 0.10396682471036911, 'eval_precision': 0.8579172610556348, 'eval_recall': 0.8997606223818073, 'eval_f1': 0.8783408792171754, 'eval_accuracy': 0.9783072405234597, 'eval_runtime': 24.8103, 'eval_samples_per_second': 67.835, 'eval_steps_per_second': 4.272, 'epoch': 1.19}
{'loss': 0.0434, 'learning_rate': 2.59900196043486e-05, 'epoch': 1.34}
              precision    recall  f1-score   support

       NSWER       0.84      0.89      0.86      1659
     UESTION       0.84      0.89      0.86      1683

   micro avg       0.84      0.89      0.86      3342
   macro avg       0.84      0.89      0.86      3342
weighted avg       0.84      0.89      0.86      3342

{'eval_loss': 0.08597126603126526, 'eval_precision': 0.8397962071893574, 'eval_recall': 0.8877917414721723, 'eval_f1': 0.8631272727272727, 'eval_accuracy': 0.9790367642977409, 'eval_runtime': 24.3653, 'eval_samples_per_second': 69.074, 'eval_steps_per_second': 4.35, 'epoch': 1.34}
{'loss': 0.0432, 'learning_rate': 2.5544466227054e-05, 'epoch': 1.49}
              precision    recall  f1-score   support

       NSWER       0.87      0.90      0.88      1659
     UESTION       0.86      0.89      0.88      1683

   micro avg       0.87      0.90      0.88      3342
   macro avg       0.87      0.90      0.88      3342
weighted avg       0.87      0.90      0.88      3342

{'eval_loss': 0.081691674888134, 'eval_precision': 0.866262276140959, 'eval_recall': 0.8973668461998803, 'eval_f1': 0.8815402704291594, 'eval_accuracy': 0.9820579442760138, 'eval_runtime': 24.405, 'eval_samples_per_second': 68.961, 'eval_steps_per_second': 4.343, 'epoch': 1.49}
{'loss': 0.0416, 'learning_rate': 2.5098912849759405e-05, 'epoch': 1.63}
              precision    recall  f1-score   support

       NSWER       0.87      0.91      0.89      1659
     UESTION       0.86      0.90      0.88      1683

   micro avg       0.86      0.90      0.88      3342
   macro avg       0.86      0.90      0.88      3342
weighted avg       0.86      0.90      0.88      3342

{'eval_loss': 0.07553743571043015, 'eval_precision': 0.8635973691735773, 'eval_recall': 0.9036505086774387, 'eval_f1': 0.8831700541014768, 'eval_accuracy': 0.9820288690531257, 'eval_runtime': 24.4624, 'eval_samples_per_second': 68.8, 'eval_steps_per_second': 4.333, 'epoch': 1.63}
{'loss': 0.0403, 'learning_rate': 2.46533594724648e-05, 'epoch': 1.78}
              precision    recall  f1-score   support

       NSWER       0.82      0.89      0.85      1659
     UESTION       0.82      0.89      0.85      1683

   micro avg       0.82      0.89      0.85      3342
   macro avg       0.82      0.89      0.85      3342
weighted avg       0.82      0.89      0.85      3342

{'eval_loss': 0.10207623988389969, 'eval_precision': 0.817931793179318, 'eval_recall': 0.8898862956313585, 'eval_f1': 0.8523932358842076, 'eval_accuracy': 0.9765362951293716, 'eval_runtime': 23.2008, 'eval_samples_per_second': 72.54, 'eval_steps_per_second': 4.569, 'epoch': 1.78}
{'loss': 0.0394, 'learning_rate': 2.42078060951702e-05, 'epoch': 1.93}
              precision    recall  f1-score   support

       NSWER       0.87      0.90      0.89      1659
     UESTION       0.87      0.90      0.89      1683

   micro avg       0.87      0.90      0.89      3342
   macro avg       0.87      0.90      0.89      3342
weighted avg       0.87      0.90      0.89      3342

{'eval_loss': 0.08418600261211395, 'eval_precision': 0.8741991846243448, 'eval_recall': 0.8982645122681029, 'eval_f1': 0.8860684769775679, 'eval_accuracy': 0.9821319539342741, 'eval_runtime': 23.1505, 'eval_samples_per_second': 72.698, 'eval_steps_per_second': 4.579, 'epoch': 1.93}
{'loss': 0.0296, 'learning_rate': 2.37622527178756e-05, 'epoch': 2.08}
              precision    recall  f1-score   support

       NSWER       0.84      0.89      0.86      1659
     UESTION       0.83      0.88      0.86      1683

   micro avg       0.84      0.89      0.86      3342
   macro avg       0.84      0.89      0.86      3342
weighted avg       0.84      0.89      0.86      3342

{'eval_loss': 0.09658260643482208, 'eval_precision': 0.8351617440225035, 'eval_recall': 0.8883901855176541, 'eval_f1': 0.8609540379875308, 'eval_accuracy': 0.9792640796766835, 'eval_runtime': 22.4618, 'eval_samples_per_second': 74.927, 'eval_steps_per_second': 4.719, 'epoch': 2.08}
{'loss': 0.0266, 'learning_rate': 2.3316699340581e-05, 'epoch': 2.23}
              precision    recall  f1-score   support

       NSWER       0.88      0.91      0.89      1659
     UESTION       0.88      0.90      0.89      1683

   micro avg       0.88      0.90      0.89      3342
   macro avg       0.88      0.90      0.89      3342
weighted avg       0.88      0.90      0.89      3342

{'eval_loss': 0.09313150495290756, 'eval_precision': 0.8769587928032502, 'eval_recall': 0.9042489527229204, 'eval_f1': 0.8903948143783147, 'eval_accuracy': 0.9798402977302824, 'eval_runtime': 22.8978, 'eval_samples_per_second': 73.5, 'eval_steps_per_second': 4.629, 'epoch': 2.23}
{'loss': 0.0275, 'learning_rate': 2.2871145963286405e-05, 'epoch': 2.38}
              precision    recall  f1-score   support

       NSWER       0.86      0.91      0.89      1659
     UESTION       0.86      0.91      0.88      1683

   micro avg       0.86      0.91      0.88      3342
   macro avg       0.86      0.91      0.88      3342
weighted avg       0.86      0.91      0.88      3342

{'eval_loss': 0.08311744034290314, 'eval_precision': 0.8622941510505394, 'eval_recall': 0.9087372830640336, 'eval_f1': 0.8849067599067599, 'eval_accuracy': 0.9825998007025631, 'eval_runtime': 22.5054, 'eval_samples_per_second': 74.782, 'eval_steps_per_second': 4.71, 'epoch': 2.38}
{'train_runtime': 7410.6145, 'train_samples_per_second': 181.71, 'train_steps_per_second': 22.715, 'train_loss': 0.05088081531524658, 'epoch': 2.38}
saved model
              precision    recall  f1-score   support

       NSWER       0.85      0.89      0.87      5623
     UESTION       0.85      0.89      0.87      5693

   micro avg       0.85      0.89      0.87     11316
   macro avg       0.85      0.89      0.87     11316
weighted avg       0.85      0.89      0.87     11316

{'epoch': 2.38,
 'eval_accuracy': 0.9831774572911662,
 'eval_f1': 0.8695577427257489,
 'eval_loss': 0.07051581144332886,
 'eval_precision': 0.8464563634842273,
 'eval_recall': 0.8939554612937434,
 'eval_runtime': 76.3915,
 'eval_samples_per_second': 74.524,
 'eval_steps_per_second': 4.66}
Accuracy: 0.9831774572911662
END 4747089: Thu 12 Oct 2023 05:02:08 PM EEST
