
START 4747180: Thu 12 Oct 2023 02:56:32 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/cleaned2_train_annotated_dataset.jsonl', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl'], test='../../data/qa_token_classification/annotated/cleaned2_test_annotated_dataset.jsonl', dev='../../data/qa_token_classification/annotated/cleaned2_dev_annotated_dataset.jsonl', batch=8, epochs=10, lr=1e-05, save='enfigpt_fi_1e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
in dictionary: 2
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138182
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 138182
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 50
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 68
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1389, 'learning_rate': 9.855265443177214e-06, 'epoch': 0.14}
              precision    recall  f1-score   support

       NSWER       0.02      0.12      0.04        40
     UESTION       0.04      0.13      0.06        46

   micro avg       0.03      0.13      0.05        86
   macro avg       0.03      0.13      0.05        86
weighted avg       0.03      0.13      0.05        86

{'eval_loss': 0.6977710723876953, 'eval_precision': 0.02925531914893617, 'eval_recall': 0.12790697674418605, 'eval_f1': 0.047619047619047616, 'eval_accuracy': 0.6677105080027835, 'eval_runtime': 0.5815, 'eval_samples_per_second': 85.983, 'eval_steps_per_second': 6.879, 'epoch': 0.14}
{'loss': 0.0844, 'learning_rate': 9.710530886354427e-06, 'epoch': 0.29}
              precision    recall  f1-score   support

       NSWER       0.01      0.03      0.02        40
     UESTION       0.02      0.04      0.03        46

   micro avg       0.02      0.03      0.02        86
   macro avg       0.02      0.03      0.02        86
weighted avg       0.02      0.03      0.02        86

{'eval_loss': 0.8423144817352295, 'eval_precision': 0.016574585635359115, 'eval_recall': 0.03488372093023256, 'eval_f1': 0.02247191011235955, 'eval_accuracy': 0.5679656692182788, 'eval_runtime': 0.5405, 'eval_samples_per_second': 92.513, 'eval_steps_per_second': 7.401, 'epoch': 0.29}
{'loss': 0.0725, 'learning_rate': 9.56579632953164e-06, 'epoch': 0.43}
              precision    recall  f1-score   support

       NSWER       0.05      0.15      0.08        40
     UESTION       0.12      0.20      0.15        46

   micro avg       0.08      0.17      0.11        86
   macro avg       0.09      0.17      0.12        86
weighted avg       0.09      0.17      0.12        86

{'eval_loss': 0.8085693120956421, 'eval_precision': 0.08064516129032258, 'eval_recall': 0.1744186046511628, 'eval_f1': 0.11029411764705882, 'eval_accuracy': 0.6363952679192763, 'eval_runtime': 0.5511, 'eval_samples_per_second': 90.734, 'eval_steps_per_second': 7.259, 'epoch': 0.43}
{'loss': 0.0716, 'learning_rate': 9.421061772708852e-06, 'epoch': 0.58}
              precision    recall  f1-score   support

       NSWER       0.09      0.20      0.12        40
     UESTION       0.11      0.26      0.15        46

   micro avg       0.10      0.23      0.14        86
   macro avg       0.10      0.23      0.14        86
weighted avg       0.10      0.23      0.14        86

{'eval_loss': 0.6695780158042908, 'eval_precision': 0.1, 'eval_recall': 0.23255813953488372, 'eval_f1': 0.13986013986013987, 'eval_accuracy': 0.7266295523080492, 'eval_runtime': 0.669, 'eval_samples_per_second': 74.743, 'eval_steps_per_second': 5.979, 'epoch': 0.58}
{'loss': 0.0603, 'learning_rate': 9.276327215886066e-06, 'epoch': 0.72}
              precision    recall  f1-score   support

       NSWER       0.13      0.17      0.15        40
     UESTION       0.38      0.26      0.31        46

   micro avg       0.22      0.22      0.22        86
   macro avg       0.25      0.22      0.23        86
weighted avg       0.26      0.22      0.23        86

{'eval_loss': 1.1825186014175415, 'eval_precision': 0.22093023255813954, 'eval_recall': 0.22093023255813954, 'eval_f1': 0.22093023255813954, 'eval_accuracy': 0.5839712363720715, 'eval_runtime': 0.545, 'eval_samples_per_second': 91.742, 'eval_steps_per_second': 7.339, 'epoch': 0.72}
{'loss': 0.062, 'learning_rate': 9.131592659063279e-06, 'epoch': 0.87}
              precision    recall  f1-score   support

       NSWER       0.18      0.35      0.24        40
     UESTION       0.32      0.46      0.38        46

   micro avg       0.24      0.41      0.30        86
   macro avg       0.25      0.40      0.31        86
weighted avg       0.25      0.41      0.31        86

{'eval_loss': 0.6592655181884766, 'eval_precision': 0.24305555555555555, 'eval_recall': 0.4069767441860465, 'eval_f1': 0.30434782608695654, 'eval_accuracy': 0.751681744374855, 'eval_runtime': 0.5643, 'eval_samples_per_second': 88.603, 'eval_steps_per_second': 7.088, 'epoch': 0.87}
{'loss': 0.0574, 'learning_rate': 8.986858102240492e-06, 'epoch': 1.01}
              precision    recall  f1-score   support

       NSWER       0.19      0.55      0.28        40
     UESTION       0.31      0.57      0.40        46

   micro avg       0.24      0.56      0.33        86
   macro avg       0.25      0.56      0.34        86
weighted avg       0.25      0.56      0.34        86

{'eval_loss': 0.4959779381752014, 'eval_precision': 0.23880597014925373, 'eval_recall': 0.5581395348837209, 'eval_f1': 0.33449477351916374, 'eval_accuracy': 0.8174437485502204, 'eval_runtime': 0.5749, 'eval_samples_per_second': 86.978, 'eval_steps_per_second': 6.958, 'epoch': 1.01}
{'loss': 0.0476, 'learning_rate': 8.842123545417704e-06, 'epoch': 1.16}
              precision    recall  f1-score   support

       NSWER       0.07      0.12      0.09        40
     UESTION       0.22      0.33      0.27        46

   micro avg       0.14      0.23      0.18        86
   macro avg       0.15      0.23      0.18        86
weighted avg       0.15      0.23      0.18        86

{'eval_loss': 0.8734058141708374, 'eval_precision': 0.14184397163120568, 'eval_recall': 0.23255813953488372, 'eval_f1': 0.1762114537444934, 'eval_accuracy': 0.6344235676177221, 'eval_runtime': 0.5434, 'eval_samples_per_second': 92.008, 'eval_steps_per_second': 7.361, 'epoch': 1.16}
{'loss': 0.0471, 'learning_rate': 8.697388988594919e-06, 'epoch': 1.3}
              precision    recall  f1-score   support

       NSWER       0.27      0.62      0.38        40
     UESTION       0.32      0.57      0.41        46

   micro avg       0.29      0.59      0.39        86
   macro avg       0.30      0.60      0.39        86
weighted avg       0.30      0.59      0.39        86

{'eval_loss': 0.4247617721557617, 'eval_precision': 0.2947976878612717, 'eval_recall': 0.5930232558139535, 'eval_f1': 0.39382239382239387, 'eval_accuracy': 0.8087450707492461, 'eval_runtime': 0.6377, 'eval_samples_per_second': 78.402, 'eval_steps_per_second': 6.272, 'epoch': 1.3}
{'loss': 0.0447, 'learning_rate': 8.55265443177213e-06, 'epoch': 1.45}
              precision    recall  f1-score   support

       NSWER       0.24      0.30      0.27        40
     UESTION       0.42      0.50      0.46        46

   micro avg       0.33      0.41      0.37        86
   macro avg       0.33      0.40      0.36        86
weighted avg       0.34      0.41      0.37        86

{'eval_loss': 0.6394511461257935, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.4069767441860465, 'eval_f1': 0.36649214659685864, 'eval_accuracy': 0.6999536070517282, 'eval_runtime': 0.5576, 'eval_samples_per_second': 89.67, 'eval_steps_per_second': 7.174, 'epoch': 1.45}
{'loss': 0.0453, 'learning_rate': 8.407919874949344e-06, 'epoch': 1.59}
              precision    recall  f1-score   support

       NSWER       0.20      0.38      0.26        40
     UESTION       0.29      0.43      0.35        46

   micro avg       0.25      0.41      0.31        86
   macro avg       0.25      0.40      0.31        86
weighted avg       0.25      0.41      0.31        86

{'eval_loss': 0.7295927405357361, 'eval_precision': 0.24647887323943662, 'eval_recall': 0.4069767441860465, 'eval_f1': 0.30701754385964913, 'eval_accuracy': 0.7221062398515425, 'eval_runtime': 0.5594, 'eval_samples_per_second': 89.378, 'eval_steps_per_second': 7.15, 'epoch': 1.59}
{'loss': 0.0439, 'learning_rate': 8.263185318126557e-06, 'epoch': 1.74}
              precision    recall  f1-score   support

       NSWER       0.17      0.42      0.25        40
     UESTION       0.36      0.57      0.44        46

   micro avg       0.25      0.50      0.33        86
   macro avg       0.26      0.50      0.34        86
weighted avg       0.27      0.50      0.35        86

{'eval_loss': 0.6455949544906616, 'eval_precision': 0.25146198830409355, 'eval_recall': 0.5, 'eval_f1': 0.3346303501945525, 'eval_accuracy': 0.756437021572721, 'eval_runtime': 0.5517, 'eval_samples_per_second': 90.625, 'eval_steps_per_second': 7.25, 'epoch': 1.74}
{'loss': 0.0441, 'learning_rate': 8.11845076130377e-06, 'epoch': 1.88}
              precision    recall  f1-score   support

       NSWER       0.11      0.15      0.12        40
     UESTION       0.25      0.33      0.29        46

   micro avg       0.18      0.24      0.21        86
   macro avg       0.18      0.24      0.21        86
weighted avg       0.19      0.24      0.21        86

{'eval_loss': 1.0500178337097168, 'eval_precision': 0.1826086956521739, 'eval_recall': 0.2441860465116279, 'eval_f1': 0.208955223880597, 'eval_accuracy': 0.6228253305497564, 'eval_runtime': 0.5192, 'eval_samples_per_second': 96.309, 'eval_steps_per_second': 7.705, 'epoch': 1.88}
{'loss': 0.0444, 'learning_rate': 7.973716204480982e-06, 'epoch': 2.03}
              precision    recall  f1-score   support

       NSWER       0.39      0.47      0.43        40
     UESTION       0.39      0.54      0.45        46

   micro avg       0.39      0.51      0.44        86
   macro avg       0.39      0.51      0.44        86
weighted avg       0.39      0.51      0.44        86

{'eval_loss': 0.4892599880695343, 'eval_precision': 0.3893805309734513, 'eval_recall': 0.5116279069767442, 'eval_f1': 0.44221105527638194, 'eval_accuracy': 0.7858965437253538, 'eval_runtime': 0.5292, 'eval_samples_per_second': 94.474, 'eval_steps_per_second': 7.558, 'epoch': 2.03}
{'train_runtime': 6349.3731, 'train_samples_per_second': 217.631, 'train_steps_per_second': 27.204, 'train_loss': 0.061722208949497766, 'epoch': 2.03}
saved model
              precision    recall  f1-score   support

       NSWER       0.37      0.62      0.46        58
     UESTION       0.56      0.62      0.58        73

   micro avg       0.46      0.62      0.52       131
   macro avg       0.46      0.62      0.52       131
weighted avg       0.47      0.62      0.53       131

{'epoch': 2.03,
 'eval_accuracy': 0.8502126182417773,
 'eval_f1': 0.5242718446601943,
 'eval_loss': 0.3810960352420807,
 'eval_precision': 0.4550561797752809,
 'eval_recall': 0.6183206106870229,
 'eval_runtime': 0.7947,
 'eval_samples_per_second': 85.572,
 'eval_steps_per_second': 6.292}
Accuracy: 0.8502126182417773
END 4747180: Thu 12 Oct 2023 04:46:50 PM EEST
