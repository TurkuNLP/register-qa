
START 4746751: Thu 12 Oct 2023 02:27:47 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/annotated/cleaned2_train_annotated_dataset.jsonl', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl'], test='../../data/qa_token_classification/annotated/cleaned2_test_annotated_dataset.jsonl', dev='../../data/qa_token_classification/annotated/cleaned2_dev_annotated_dataset.jsonl', batch=8, epochs=10, lr=5e-05, save='figpt_fi_5e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3524
    })
})
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3524
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 50
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 68
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.8612, 'learning_rate': 4.71655328798186e-05, 'epoch': 0.57}
              precision    recall  f1-score   support

       NSWER       0.03      0.15      0.05        40
     UESTION       0.12      0.20      0.15        46

   micro avg       0.05      0.17      0.08        86
   macro avg       0.08      0.17      0.10        86
weighted avg       0.08      0.17      0.10        86

{'eval_loss': 0.6643987894058228, 'eval_precision': 0.05154639175257732, 'eval_recall': 0.1744186046511628, 'eval_f1': 0.07957559681697612, 'eval_accuracy': 0.6807005335189051, 'eval_runtime': 0.5216, 'eval_samples_per_second': 95.862, 'eval_steps_per_second': 7.669, 'epoch': 0.57}
{'loss': 0.7249, 'learning_rate': 4.433106575963719e-05, 'epoch': 1.13}
              precision    recall  f1-score   support

       NSWER       0.05      0.12      0.08        40
     UESTION       0.26      0.33      0.29        46

   micro avg       0.13      0.23      0.17        86
   macro avg       0.16      0.23      0.18        86
weighted avg       0.16      0.23      0.19        86

{'eval_loss': 0.6336123943328857, 'eval_precision': 0.13245033112582782, 'eval_recall': 0.23255813953488372, 'eval_f1': 0.1687763713080169, 'eval_accuracy': 0.7139874739039666, 'eval_runtime': 0.5129, 'eval_samples_per_second': 97.493, 'eval_steps_per_second': 7.799, 'epoch': 1.13}
{'loss': 0.6667, 'learning_rate': 4.149659863945579e-05, 'epoch': 1.7}
              precision    recall  f1-score   support

       NSWER       0.09      0.28      0.13        40
     UESTION       0.15      0.35      0.21        46

   micro avg       0.11      0.31      0.17        86
   macro avg       0.12      0.31      0.17        86
weighted avg       0.12      0.31      0.17        86

{'eval_loss': 0.522650957107544, 'eval_precision': 0.11392405063291139, 'eval_recall': 0.313953488372093, 'eval_f1': 0.1671826625386997, 'eval_accuracy': 0.7615402458826258, 'eval_runtime': 0.5187, 'eval_samples_per_second': 96.386, 'eval_steps_per_second': 7.711, 'epoch': 1.7}
{'loss': 0.5488, 'learning_rate': 3.8662131519274384e-05, 'epoch': 2.27}
              precision    recall  f1-score   support

       NSWER       0.12      0.17      0.14        40
     UESTION       0.18      0.24      0.21        46

   micro avg       0.15      0.21      0.18        86
   macro avg       0.15      0.21      0.18        86
weighted avg       0.15      0.21      0.18        86

{'eval_loss': 1.20646333694458, 'eval_precision': 0.15254237288135594, 'eval_recall': 0.20930232558139536, 'eval_f1': 0.1764705882352941, 'eval_accuracy': 0.643586174901415, 'eval_runtime': 0.512, 'eval_samples_per_second': 97.653, 'eval_steps_per_second': 7.812, 'epoch': 2.27}
{'loss': 0.5355, 'learning_rate': 3.5827664399092974e-05, 'epoch': 2.83}
              precision    recall  f1-score   support

       NSWER       0.13      0.40      0.20        40
     UESTION       0.22      0.46      0.30        46

   micro avg       0.17      0.43      0.25        86
   macro avg       0.18      0.43      0.25        86
weighted avg       0.18      0.43      0.25        86

{'eval_loss': 0.5006653666496277, 'eval_precision': 0.1712962962962963, 'eval_recall': 0.43023255813953487, 'eval_f1': 0.2450331125827815, 'eval_accuracy': 0.7875202969148689, 'eval_runtime': 0.5263, 'eval_samples_per_second': 94.995, 'eval_steps_per_second': 7.6, 'epoch': 2.83}
{'loss': 0.4528, 'learning_rate': 3.2993197278911564e-05, 'epoch': 3.4}
              precision    recall  f1-score   support

       NSWER       0.31      0.40      0.35        40
     UESTION       0.30      0.50      0.38        46

   micro avg       0.30      0.45      0.36        86
   macro avg       0.31      0.45      0.36        86
weighted avg       0.30      0.45      0.36        86

{'eval_loss': 0.5773902535438538, 'eval_precision': 0.3046875, 'eval_recall': 0.45348837209302323, 'eval_f1': 0.36448598130841126, 'eval_accuracy': 0.7840408257944792, 'eval_runtime': 0.5167, 'eval_samples_per_second': 96.777, 'eval_steps_per_second': 7.742, 'epoch': 3.4}
{'loss': 0.4153, 'learning_rate': 3.0158730158730158e-05, 'epoch': 3.97}
              precision    recall  f1-score   support

       NSWER       0.21      0.35      0.26        40
     UESTION       0.22      0.30      0.26        46

   micro avg       0.21      0.33      0.26        86
   macro avg       0.21      0.33      0.26        86
weighted avg       0.21      0.33      0.26        86

{'eval_loss': 0.8295215368270874, 'eval_precision': 0.21374045801526717, 'eval_recall': 0.32558139534883723, 'eval_f1': 0.25806451612903225, 'eval_accuracy': 0.6537926235212248, 'eval_runtime': 0.5089, 'eval_samples_per_second': 98.25, 'eval_steps_per_second': 7.86, 'epoch': 3.97}
{'loss': 0.326, 'learning_rate': 2.732426303854875e-05, 'epoch': 4.54}
              precision    recall  f1-score   support

       NSWER       0.22      0.40      0.29        40
     UESTION       0.27      0.46      0.34        46

   micro avg       0.25      0.43      0.31        86
   macro avg       0.24      0.43      0.31        86
weighted avg       0.25      0.43      0.31        86

{'eval_loss': 0.5494483709335327, 'eval_precision': 0.24503311258278146, 'eval_recall': 0.43023255813953487, 'eval_f1': 0.3122362869198312, 'eval_accuracy': 0.8205752725585711, 'eval_runtime': 0.5251, 'eval_samples_per_second': 95.212, 'eval_steps_per_second': 7.617, 'epoch': 4.54}
{'loss': 0.2982, 'learning_rate': 2.448979591836735e-05, 'epoch': 5.1}
              precision    recall  f1-score   support

       NSWER       0.20      0.45      0.27        40
     UESTION       0.28      0.46      0.35        46

   micro avg       0.24      0.45      0.31        86
   macro avg       0.24      0.45      0.31        86
weighted avg       0.24      0.45      0.32        86

{'eval_loss': 0.7114103436470032, 'eval_precision': 0.23636363636363636, 'eval_recall': 0.45348837209302323, 'eval_f1': 0.3107569721115538, 'eval_accuracy': 0.7774298306657388, 'eval_runtime': 0.5181, 'eval_samples_per_second': 96.506, 'eval_steps_per_second': 7.72, 'epoch': 5.1}
{'loss': 0.2522, 'learning_rate': 2.1655328798185942e-05, 'epoch': 5.67}
              precision    recall  f1-score   support

       NSWER       0.35      0.50      0.41        40
     UESTION       0.41      0.52      0.46        46

   micro avg       0.38      0.51      0.44        86
   macro avg       0.38      0.51      0.44        86
weighted avg       0.38      0.51      0.44        86

{'eval_loss': 0.7534502148628235, 'eval_precision': 0.3826086956521739, 'eval_recall': 0.5116279069767442, 'eval_f1': 0.43781094527363185, 'eval_accuracy': 0.7893760148457435, 'eval_runtime': 0.5168, 'eval_samples_per_second': 96.758, 'eval_steps_per_second': 7.741, 'epoch': 5.67}
{'train_runtime': 463.8093, 'train_samples_per_second': 75.979, 'train_steps_per_second': 9.508, 'train_loss': 0.5081592132568359, 'epoch': 5.67}
saved model
              precision    recall  f1-score   support

       NSWER       0.23      0.40      0.29        58
     UESTION       0.36      0.59      0.45        73

   micro avg       0.30      0.50      0.38       131
   macro avg       0.29      0.49      0.37       131
weighted avg       0.30      0.50      0.38       131

{'epoch': 5.67,
 'eval_accuracy': 0.846307385229541,
 'eval_f1': 0.37606837606837606,
 'eval_loss': 0.3773097097873688,
 'eval_precision': 0.3,
 'eval_recall': 0.5038167938931297,
 'eval_runtime': 0.7406,
 'eval_samples_per_second': 91.815,
 'eval_steps_per_second': 6.751}
Accuracy: 0.846307385229541
END 4746751: Thu 12 Oct 2023 02:36:00 PM EEST
