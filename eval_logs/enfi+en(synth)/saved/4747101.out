
START 4747101: Thu 12 Oct 2023 02:53:37 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/cleaned2_train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/dataset_punct2', dev='../../data/qa_token_classification/dataset_punct2', batch=8, epochs=10, lr=2e-05, save='enfi_en_2e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1123, 'learning_rate': 1.9703176016622146e-05, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.70      0.83      0.76      1659
     UESTION       0.70      0.84      0.76      1683

   micro avg       0.70      0.83      0.76      3342
   macro avg       0.70      0.83      0.76      3342
weighted avg       0.70      0.83      0.76      3342

{'eval_loss': 0.10227137058973312, 'eval_precision': 0.7025731584258325, 'eval_recall': 0.8333333333333334, 'eval_f1': 0.7623870791130577, 'eval_accuracy': 0.971709808129961, 'eval_runtime': 24.1878, 'eval_samples_per_second': 69.58, 'eval_steps_per_second': 4.382, 'epoch': 0.15}
{'loss': 0.0694, 'learning_rate': 1.9406352033244288e-05, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.77      0.86      0.82      1659
     UESTION       0.77      0.86      0.81      1683

   micro avg       0.77      0.86      0.82      3342
   macro avg       0.77      0.86      0.82      3342
weighted avg       0.77      0.86      0.82      3342

{'eval_loss': 0.08033271878957748, 'eval_precision': 0.7740112994350282, 'eval_recall': 0.8608617594254937, 'eval_f1': 0.8151296217594559, 'eval_accuracy': 0.9746701944603771, 'eval_runtime': 24.0755, 'eval_samples_per_second': 69.905, 'eval_steps_per_second': 4.403, 'epoch': 0.3}
{'loss': 0.0596, 'learning_rate': 1.910952804986643e-05, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.80      0.89      0.84      1659
     UESTION       0.80      0.88      0.84      1683

   micro avg       0.80      0.88      0.84      3342
   macro avg       0.80      0.88      0.84      3342
weighted avg       0.80      0.88      0.84      3342

{'eval_loss': 0.07375562936067581, 'eval_precision': 0.7997286295793758, 'eval_recall': 0.8818073010173548, 'eval_f1': 0.8387647644798634, 'eval_accuracy': 0.9786799320168424, 'eval_runtime': 24.218, 'eval_samples_per_second': 69.494, 'eval_steps_per_second': 4.377, 'epoch': 0.45}
{'loss': 0.0545, 'learning_rate': 1.8812704066488574e-05, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.82      0.89      0.85      1659
     UESTION       0.82      0.88      0.85      1683

   micro avg       0.82      0.88      0.85      3342
   macro avg       0.82      0.88      0.85      3342
weighted avg       0.82      0.88      0.85      3342

{'eval_loss': 0.07613060623407364, 'eval_precision': 0.8192904656319291, 'eval_recall': 0.8845002992220228, 'eval_f1': 0.8506474820143886, 'eval_accuracy': 0.9795839071284517, 'eval_runtime': 24.3729, 'eval_samples_per_second': 69.052, 'eval_steps_per_second': 4.349, 'epoch': 0.59}
{'loss': 0.0476, 'learning_rate': 1.851588008311072e-05, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.84      0.89      0.86      1659
     UESTION       0.83      0.89      0.86      1683

   micro avg       0.83      0.89      0.86      3342
   macro avg       0.83      0.89      0.86      3342
weighted avg       0.83      0.89      0.86      3342

{'eval_loss': 0.07307752221822739, 'eval_precision': 0.8345485137408861, 'eval_recall': 0.8904847396768402, 'eval_f1': 0.8616097278517661, 'eval_accuracy': 0.9820500146697716, 'eval_runtime': 24.1913, 'eval_samples_per_second': 69.571, 'eval_steps_per_second': 4.382, 'epoch': 0.74}
{'loss': 0.0521, 'learning_rate': 1.821905609973286e-05, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.84      0.90      0.87      1659
     UESTION       0.84      0.89      0.86      1683

   micro avg       0.84      0.90      0.87      3342
   macro avg       0.84      0.90      0.87      3342
weighted avg       0.84      0.90      0.87      3342

{'eval_loss': 0.0757853239774704, 'eval_precision': 0.8384658454647257, 'eval_recall': 0.8961699581089169, 'eval_f1': 0.8663581139716517, 'eval_accuracy': 0.9786349975814701, 'eval_runtime': 24.2082, 'eval_samples_per_second': 69.522, 'eval_steps_per_second': 4.379, 'epoch': 0.89}
{'loss': 0.0461, 'learning_rate': 1.7922232116355002e-05, 'epoch': 1.04}
              precision    recall  f1-score   support

       NSWER       0.85      0.91      0.88      1659
     UESTION       0.84      0.90      0.87      1683

   micro avg       0.85      0.90      0.87      3342
   macro avg       0.85      0.90      0.87      3342
weighted avg       0.85      0.90      0.87      3342

{'eval_loss': 0.059463486075401306, 'eval_precision': 0.8472573839662447, 'eval_recall': 0.9012567324955116, 'eval_f1': 0.8734232274902132, 'eval_accuracy': 0.9841910083551618, 'eval_runtime': 24.0928, 'eval_samples_per_second': 69.855, 'eval_steps_per_second': 4.4, 'epoch': 1.04}
{'loss': 0.0371, 'learning_rate': 1.7625408132977147e-05, 'epoch': 1.19}
              precision    recall  f1-score   support

       NSWER       0.87      0.91      0.89      1659
     UESTION       0.87      0.90      0.88      1683

   micro avg       0.87      0.91      0.89      3342
   macro avg       0.87      0.91      0.89      3342
weighted avg       0.87      0.91      0.89      3342

{'eval_loss': 0.0744844451546669, 'eval_precision': 0.8662092624356775, 'eval_recall': 0.9066427289048474, 'eval_f1': 0.8859649122807018, 'eval_accuracy': 0.9856104078725131, 'eval_runtime': 25.2899, 'eval_samples_per_second': 66.548, 'eval_steps_per_second': 4.191, 'epoch': 1.19}
{'loss': 0.0358, 'learning_rate': 1.732858414959929e-05, 'epoch': 1.34}
              precision    recall  f1-score   support

       NSWER       0.83      0.90      0.86      1659
     UESTION       0.84      0.90      0.87      1683

   micro avg       0.84      0.90      0.87      3342
   macro avg       0.84      0.90      0.87      3342
weighted avg       0.84      0.90      0.87      3342

{'eval_loss': 0.06670653074979782, 'eval_precision': 0.8356012218828104, 'eval_recall': 0.900359066427289, 'eval_f1': 0.8667722886360364, 'eval_accuracy': 0.9830570746625292, 'eval_runtime': 24.5717, 'eval_samples_per_second': 68.494, 'eval_steps_per_second': 4.314, 'epoch': 1.34}
{'loss': 0.0375, 'learning_rate': 1.7031760166221433e-05, 'epoch': 1.48}
              precision    recall  f1-score   support

       NSWER       0.86      0.91      0.88      1659
     UESTION       0.86      0.90      0.88      1683

   micro avg       0.86      0.91      0.88      3342
   macro avg       0.86      0.91      0.88      3342
weighted avg       0.86      0.91      0.88      3342

{'eval_loss': 0.08287353813648224, 'eval_precision': 0.8594104308390023, 'eval_recall': 0.9072411729503291, 'eval_f1': 0.8826783114992722, 'eval_accuracy': 0.9807892072772639, 'eval_runtime': 24.0883, 'eval_samples_per_second': 69.868, 'eval_steps_per_second': 4.4, 'epoch': 1.48}
{'loss': 0.0341, 'learning_rate': 1.6734936182843574e-05, 'epoch': 1.63}
              precision    recall  f1-score   support

       NSWER       0.88      0.91      0.90      1659
     UESTION       0.88      0.91      0.89      1683

   micro avg       0.88      0.91      0.89      3342
   macro avg       0.88      0.91      0.89      3342
weighted avg       0.88      0.91      0.89      3342

{'eval_loss': 0.08863440155982971, 'eval_precision': 0.8771271993077588, 'eval_recall': 0.909934171154997, 'eval_f1': 0.8932295491261566, 'eval_accuracy': 0.9819019953532507, 'eval_runtime': 24.8252, 'eval_samples_per_second': 67.794, 'eval_steps_per_second': 4.27, 'epoch': 1.63}
{'loss': 0.0346, 'learning_rate': 1.643811219946572e-05, 'epoch': 1.78}
              precision    recall  f1-score   support

       NSWER       0.88      0.92      0.90      1659
     UESTION       0.87      0.91      0.89      1683

   micro avg       0.88      0.91      0.89      3342
   macro avg       0.88      0.91      0.89      3342
weighted avg       0.88      0.91      0.89      3342

{'eval_loss': 0.07382016628980637, 'eval_precision': 0.8756818834338215, 'eval_recall': 0.9126271693596649, 'eval_f1': 0.8937728937728939, 'eval_accuracy': 0.984851808875344, 'eval_runtime': 23.2486, 'eval_samples_per_second': 72.391, 'eval_steps_per_second': 4.559, 'epoch': 1.78}
{'train_runtime': 6039.3849, 'train_samples_per_second': 223.132, 'train_steps_per_second': 27.892, 'train_loss': 0.051710409037272136, 'epoch': 1.78}
saved model
              precision    recall  f1-score   support

       NSWER       0.85      0.90      0.87      5623
     UESTION       0.85      0.89      0.87      5693

   micro avg       0.85      0.90      0.87     11316
   macro avg       0.85      0.90      0.87     11316
weighted avg       0.85      0.90      0.87     11316

{'epoch': 1.78,
 'eval_accuracy': 0.9844393047455653,
 'eval_f1': 0.8706367266326049,
 'eval_loss': 0.06099769100546837,
 'eval_precision': 0.8466805845511483,
 'eval_recall': 0.8959879816189467,
 'eval_runtime': 79.0275,
 'eval_samples_per_second': 72.038,
 'eval_steps_per_second': 4.505}
Accuracy: 0.9844393047455653
END 4747101: Thu 12 Oct 2023 04:40:08 PM EEST
