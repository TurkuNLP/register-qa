START 4744705: Thu 12 Oct 2023 10:59:55 AM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/dataset_punct2', dev='../../data/qa_token_classification/dataset_punct2', batch=8, epochs=10, lr=2e-05, save=None, dataset=None)
0
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
1
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1073, 'learning_rate': 1.9703176016622146e-05, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.67      0.85      0.75      1659
     UESTION       0.66      0.83      0.74      1683

   micro avg       0.66      0.84      0.74      3342
   macro avg       0.66      0.84      0.74      3342
weighted avg       0.66      0.84      0.74      3342

{'eval_loss': 0.09970436990261078, 'eval_precision': 0.6643076197216324, 'eval_recall': 0.8426092160383004, 'eval_f1': 0.7429099063448094, 'eval_accuracy': 0.9709062746974194, 'eval_runtime': 25.4839, 'eval_samples_per_second': 66.042, 'eval_steps_per_second': 4.159, 'epoch': 0.15}
{'loss': 0.0712, 'learning_rate': 1.9406352033244288e-05, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.80      0.87      0.83      1659
     UESTION       0.79      0.86      0.83      1683

   micro avg       0.80      0.87      0.83      3342
   macro avg       0.80      0.87      0.83      3342
weighted avg       0.80      0.87      0.83      3342

{'eval_loss': 0.0821240171790123, 'eval_precision': 0.7951045104510451, 'eval_recall': 0.865050867743866, 'eval_f1': 0.828604184580109, 'eval_accuracy': 0.9761107395943742, 'eval_runtime': 25.1459, 'eval_samples_per_second': 66.929, 'eval_steps_per_second': 4.215, 'epoch': 0.3}
{'loss': 0.0639, 'learning_rate': 1.910952804986643e-05, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.81      0.88      0.84      1659
     UESTION       0.81      0.88      0.84      1683

   micro avg       0.81      0.88      0.84      3342
   macro avg       0.81      0.88      0.84      3342
weighted avg       0.81      0.88      0.84      3342

{'eval_loss': 0.07751230895519257, 'eval_precision': 0.8067619571192963, 'eval_recall': 0.8782166367444644, 'eval_f1': 0.8409742120343839, 'eval_accuracy': 0.9800253218759334, 'eval_runtime': 24.3735, 'eval_samples_per_second': 69.05, 'eval_steps_per_second': 4.349, 'epoch': 0.45}
{'loss': 0.0543, 'learning_rate': 1.8812704066488574e-05, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.83      0.90      0.86      1659
     UESTION       0.82      0.89      0.86      1683

   micro avg       0.83      0.89      0.86      3342
   macro avg       0.83      0.89      0.86      3342
weighted avg       0.83      0.89      0.86      3342

{'eval_loss': 0.0885816290974617, 'eval_precision': 0.8252561617280532, 'eval_recall': 0.8916816277678037, 'eval_f1': 0.8571839493743708, 'eval_accuracy': 0.9809795178270765, 'eval_runtime': 24.8113, 'eval_samples_per_second': 67.832, 'eval_steps_per_second': 4.272, 'epoch': 0.59}
{'loss': 0.053, 'learning_rate': 1.851588008311072e-05, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.81      0.89      0.85      1659
     UESTION       0.81      0.88      0.85      1683

   micro avg       0.81      0.88      0.85      3342
   macro avg       0.81      0.88      0.85      3342
weighted avg       0.81      0.88      0.85      3342

{'eval_loss': 0.08280358463525772, 'eval_precision': 0.8141007986780501, 'eval_recall': 0.8845002992220228, 'eval_f1': 0.8478416750322673, 'eval_accuracy': 0.9785504151148868, 'eval_runtime': 24.3665, 'eval_samples_per_second': 69.07, 'eval_steps_per_second': 4.35, 'epoch': 0.74}
{'loss': 0.051, 'learning_rate': 1.821905609973286e-05, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.85      0.91      0.88      1659
     UESTION       0.85      0.90      0.87      1683

   micro avg       0.85      0.90      0.87      3342
   macro avg       0.85      0.90      0.87      3342
weighted avg       0.85      0.90      0.87      3342

{'eval_loss': 0.07402504235506058, 'eval_precision': 0.8460028050490883, 'eval_recall': 0.9024536205864752, 'eval_f1': 0.8733169248588388, 'eval_accuracy': 0.9812544108434722, 'eval_runtime': 24.8739, 'eval_samples_per_second': 67.661, 'eval_steps_per_second': 4.261, 'epoch': 0.89}
{'loss': 0.0426, 'learning_rate': 1.7922232116355002e-05, 'epoch': 1.04}
              precision    recall  f1-score   support

       NSWER       0.84      0.90      0.87      1659
     UESTION       0.84      0.89      0.86      1683

   micro avg       0.84      0.90      0.87      3342
   macro avg       0.84      0.90      0.87      3342
weighted avg       0.84      0.90      0.87      3342

{'eval_loss': 0.11380592733621597, 'eval_precision': 0.8409090909090909, 'eval_recall': 0.8967684021543986, 'eval_f1': 0.8679409209383145, 'eval_accuracy': 0.9786085655606628, 'eval_runtime': 25.3755, 'eval_samples_per_second': 66.324, 'eval_steps_per_second': 4.177, 'epoch': 1.04}
{'loss': 0.0391, 'learning_rate': 1.7625408132977147e-05, 'epoch': 1.19}
              precision    recall  f1-score   support

       NSWER       0.84      0.90      0.87      1659
     UESTION       0.84      0.89      0.87      1683

   micro avg       0.84      0.89      0.87      3342
   macro avg       0.84      0.90      0.87      3342
weighted avg       0.84      0.89      0.87      3342

{'eval_loss': 0.08532632887363434, 'eval_precision': 0.8427726120033813, 'eval_recall': 0.8949730700179533, 'eval_f1': 0.868088811493252, 'eval_accuracy': 0.9768614089853012, 'eval_runtime': 24.8797, 'eval_samples_per_second': 67.645, 'eval_steps_per_second': 4.26, 'epoch': 1.19}
{'loss': 0.0364, 'learning_rate': 1.732858414959929e-05, 'epoch': 1.34}
              precision    recall  f1-score   support

       NSWER       0.84      0.90      0.87      1659
     UESTION       0.84      0.90      0.87      1683

   micro avg       0.84      0.90      0.87      3342
   macro avg       0.84      0.90      0.87      3342
weighted avg       0.84      0.90      0.87      3342

{'eval_loss': 0.10075349360704422, 'eval_precision': 0.8427249789739276, 'eval_recall': 0.8994614003590664, 'eval_f1': 0.870169344333478, 'eval_accuracy': 0.9796076959471782, 'eval_runtime': 25.508, 'eval_samples_per_second': 65.979, 'eval_steps_per_second': 4.156, 'epoch': 1.34}
{'loss': 0.0344, 'learning_rate': 1.7031760166221433e-05, 'epoch': 1.48}
              precision    recall  f1-score   support

       NSWER       0.84      0.90      0.87      1659
     UESTION       0.83      0.89      0.86      1683

   micro avg       0.83      0.90      0.87      3342
   macro avg       0.83      0.90      0.87      3342
weighted avg       0.83      0.90      0.87      3342

{'eval_loss': 0.07284329831600189, 'eval_precision': 0.8348164627363738, 'eval_recall': 0.8982645122681029, 'eval_f1': 0.8653790717786105, 'eval_accuracy': 0.9809213673813004, 'eval_runtime': 25.3335, 'eval_samples_per_second': 66.434, 'eval_steps_per_second': 4.184, 'epoch': 1.48}
{'loss': 0.0362, 'learning_rate': 1.6734936182843574e-05, 'epoch': 1.63}
              precision    recall  f1-score   support

       NSWER       0.87      0.91      0.89      1659
     UESTION       0.87      0.91      0.89      1683

   micro avg       0.87      0.91      0.89      3342
   macro avg       0.87      0.91      0.89      3342
weighted avg       0.87      0.91      0.89      3342

{'eval_loss': 0.06820505857467651, 'eval_precision': 0.873352435530086, 'eval_recall': 0.9120287253141831, 'eval_f1': 0.892271662763466, 'eval_accuracy': 0.9832235963936151, 'eval_runtime': 24.4113, 'eval_samples_per_second': 68.943, 'eval_steps_per_second': 4.342, 'epoch': 1.63}
{'loss': 0.0366, 'learning_rate': 1.643811219946572e-05, 'epoch': 1.78}
              precision    recall  f1-score   support

       NSWER       0.88      0.92      0.90      1659
     UESTION       0.88      0.90      0.89      1683

   micro avg       0.88      0.91      0.89      3342
   macro avg       0.88      0.91      0.89      3342
weighted avg       0.88      0.91      0.89      3342

{'eval_loss': 0.07503018528223038, 'eval_precision': 0.878429107710078, 'eval_recall': 0.9102333931777379, 'eval_f1': 0.8940484937545922, 'eval_accuracy': 0.9828905529314432, 'eval_runtime': 24.341, 'eval_samples_per_second': 69.143, 'eval_steps_per_second': 4.355, 'epoch': 1.78}
{'loss': 0.0335, 'learning_rate': 1.614128821608786e-05, 'epoch': 1.93}
              precision    recall  f1-score   support

       NSWER       0.88      0.91      0.90      1659
     UESTION       0.88      0.91      0.90      1683

   micro avg       0.88      0.91      0.90      3342
   macro avg       0.88      0.91      0.90      3342
weighted avg       0.88      0.91      0.90      3342

{'eval_loss': 0.06284686923027039, 'eval_precision': 0.8802999711566195, 'eval_recall': 0.9132256134051466, 'eval_f1': 0.8964605668967544, 'eval_accuracy': 0.9836253631098858, 'eval_runtime': 23.4524, 'eval_samples_per_second': 71.762, 'eval_steps_per_second': 4.52, 'epoch': 1.93}
{'loss': 0.0251, 'learning_rate': 1.5844464232710005e-05, 'epoch': 2.08}
              precision    recall  f1-score   support

       NSWER       0.89      0.91      0.90      1659
     UESTION       0.89      0.91      0.90      1683

   micro avg       0.89      0.91      0.90      3342
   macro avg       0.89      0.91      0.90      3342
weighted avg       0.89      0.91      0.90      3342

{'eval_loss': 0.06800656765699387, 'eval_precision': 0.8903790087463557, 'eval_recall': 0.9138240574506283, 'eval_f1': 0.9019492025989367, 'eval_accuracy': 0.9859170193138777, 'eval_runtime': 23.2654, 'eval_samples_per_second': 72.339, 'eval_steps_per_second': 4.556, 'epoch': 2.08}
{'loss': 0.0203, 'learning_rate': 1.5547640249332147e-05, 'epoch': 2.23}
              precision    recall  f1-score   support

       NSWER       0.86      0.92      0.89      1659
     UESTION       0.87      0.91      0.89      1683

   micro avg       0.87      0.91      0.89      3342
   macro avg       0.87      0.91      0.89      3342
weighted avg       0.87      0.91      0.89      3342

{'eval_loss': 0.07803507894277573, 'eval_precision': 0.8652703085196717, 'eval_recall': 0.914721723518851, 'eval_f1': 0.8893090909090909, 'eval_accuracy': 0.9851663499229507, 'eval_runtime': 24.4016, 'eval_samples_per_second': 68.971, 'eval_steps_per_second': 4.344, 'epoch': 2.23}
{'loss': 0.0239, 'learning_rate': 1.5250816265954292e-05, 'epoch': 2.37}
              precision    recall  f1-score   support

       NSWER       0.91      0.92      0.91      1659
     UESTION       0.90      0.92      0.91      1683

   micro avg       0.90      0.92      0.91      3342
   macro avg       0.90      0.92      0.91      3342
weighted avg       0.90      0.92      0.91      3342

{'eval_loss': 0.052519477903842926, 'eval_precision': 0.9028840494408475, 'eval_recall': 0.9180131657690006, 'eval_f1': 0.9103857566765579, 'eval_accuracy': 0.9870298073898643, 'eval_runtime': 25.2797, 'eval_samples_per_second': 66.575, 'eval_steps_per_second': 4.193, 'epoch': 2.37}
{'loss': 0.0241, 'learning_rate': 1.4953992282576433e-05, 'epoch': 2.52}
              precision    recall  f1-score   support

       NSWER       0.88      0.92      0.90      1659
     UESTION       0.88      0.91      0.89      1683

   micro avg       0.88      0.91      0.90      3342
   macro avg       0.88      0.91      0.90      3342
weighted avg       0.88      0.91      0.90      3342

{'eval_loss': 0.06370633095502853, 'eval_precision': 0.8784133371658522, 'eval_recall': 0.9144225014961102, 'eval_f1': 0.8960562967306848, 'eval_accuracy': 0.9869055768920701, 'eval_runtime': 22.9433, 'eval_samples_per_second': 73.355, 'eval_steps_per_second': 4.62, 'epoch': 2.52}
{'loss': 0.0249, 'learning_rate': 1.4657168299198576e-05, 'epoch': 2.67}
              precision    recall  f1-score   support

       NSWER       0.89      0.92      0.90      1659
     UESTION       0.89      0.92      0.90      1683

   micro avg       0.89      0.92      0.90      3342
   macro avg       0.89      0.92      0.90      3342
weighted avg       0.89      0.92      0.90      3342

{'eval_loss': 0.07388050109148026, 'eval_precision': 0.885937048801617, 'eval_recall': 0.9180131657690006, 'eval_f1': 0.9016899338721528, 'eval_accuracy': 0.9848544520774247, 'eval_runtime': 22.6429, 'eval_samples_per_second': 74.328, 'eval_steps_per_second': 4.681, 'epoch': 2.67}
{'loss': 0.025, 'learning_rate': 1.436034431582072e-05, 'epoch': 2.82}
              precision    recall  f1-score   support

       NSWER       0.91      0.93      0.92      1659
     UESTION       0.91      0.93      0.92      1683

   micro avg       0.91      0.93      0.92      3342
   macro avg       0.91      0.93      0.92      3342
weighted avg       0.91      0.93      0.92      3342

{'eval_loss': 0.06798025220632553, 'eval_precision': 0.9117127722189523, 'eval_recall': 0.9269898264512269, 'eval_f1': 0.9192878338278931, 'eval_accuracy': 0.9874500765207003, 'eval_runtime': 24.4254, 'eval_samples_per_second': 68.904, 'eval_steps_per_second': 4.34, 'epoch': 2.82}
{'loss': 0.0241, 'learning_rate': 1.406352033244286e-05, 'epoch': 2.97}
              precision    recall  f1-score   support

       NSWER       0.89      0.92      0.91      1659
     UESTION       0.90      0.92      0.91      1683

   micro avg       0.90      0.92      0.91      3342
   macro avg       0.90      0.92      0.91      3342
weighted avg       0.90      0.92      0.91      3342

{'eval_loss': 0.07859679311513901, 'eval_precision': 0.8951212386795209, 'eval_recall': 0.9168162776780371, 'eval_f1': 0.9058388765705838, 'eval_accuracy': 0.9852297867728882, 'eval_runtime': 24.4974, 'eval_samples_per_second': 68.701, 'eval_steps_per_second': 4.327, 'epoch': 2.97}
{'loss': 0.0138, 'learning_rate': 1.3766696349065006e-05, 'epoch': 3.12}
              precision    recall  f1-score   support

       NSWER       0.91      0.93      0.92      1659
     UESTION       0.90      0.92      0.91      1683

   micro avg       0.91      0.93      0.92      3342
   macro avg       0.91      0.93      0.92      3342
weighted avg       0.91      0.93      0.92      3342

{'eval_loss': 0.07038737088441849, 'eval_precision': 0.9052631578947369, 'eval_recall': 0.926391382405745, 'eval_f1': 0.9157054125998225, 'eval_accuracy': 0.9857901456140026, 'eval_runtime': 23.0615, 'eval_samples_per_second': 72.979, 'eval_steps_per_second': 4.596, 'epoch': 3.12}
{'train_runtime': 10111.6861, 'train_samples_per_second': 133.27, 'train_steps_per_second': 16.659, 'train_loss': 0.04002946116129557, 'epoch': 3.12}
              precision    recall  f1-score   support

       NSWER       0.89      0.91      0.90      5623
     UESTION       0.89      0.91      0.90      5693

   micro avg       0.89      0.91      0.90     11316
   macro avg       0.89      0.91      0.90     11316
weighted avg       0.89      0.91      0.90     11316

{'epoch': 3.12,
 'eval_accuracy': 0.9867427641669808,
 'eval_f1': 0.897918299799669,
 'eval_loss': 0.054796308279037476,
 'eval_precision': 0.8851966340374378,
 'eval_recall': 0.9110109579356663,
 'eval_runtime': 80.2612,
 'eval_samples_per_second': 70.931,
 'eval_steps_per_second': 4.436}
Accuracy: 0.9867427641669808
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	2e-5	num_train_epochs	10	END 4744705: Thu 12 Oct 2023 01:55:32 PM EEST
