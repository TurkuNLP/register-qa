START 4744704: Thu 12 Oct 2023 10:59:48 AM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/dataset_punct2', dev='../../data/qa_token_classification/dataset_punct2', batch=8, epochs=10, lr=3e-05, save=None, dataset=None)
0
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
1
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.12, 'learning_rate': 2.9554764024933216e-05, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.71      0.83      0.76      1659
     UESTION       0.70      0.81      0.75      1683

   micro avg       0.70      0.82      0.76      3342
   macro avg       0.70      0.82      0.76      3342
weighted avg       0.70      0.82      0.76      3342

{'eval_loss': 0.1399884819984436, 'eval_precision': 0.7038659793814434, 'eval_recall': 0.8171753441053261, 'eval_f1': 0.7563001938521187, 'eval_accuracy': 0.9638568547481161, 'eval_runtime': 25.1146, 'eval_samples_per_second': 67.013, 'eval_steps_per_second': 4.221, 'epoch': 0.15}
{'loss': 0.0781, 'learning_rate': 2.910952804986643e-05, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.77      0.86      0.81      1659
     UESTION       0.78      0.85      0.81      1683

   micro avg       0.78      0.85      0.81      3342
   macro avg       0.78      0.85      0.81      3342
weighted avg       0.78      0.85      0.81      3342

{'eval_loss': 0.0987396240234375, 'eval_precision': 0.7755712731229597, 'eval_recall': 0.853081986834231, 'eval_f1': 0.8124821886577372, 'eval_accuracy': 0.9735441903739867, 'eval_runtime': 25.034, 'eval_samples_per_second': 67.229, 'eval_steps_per_second': 4.234, 'epoch': 0.3}
{'loss': 0.0651, 'learning_rate': 2.8664292074799644e-05, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.77      0.88      0.82      1659
     UESTION       0.77      0.86      0.81      1683

   micro avg       0.77      0.87      0.82      3342
   macro avg       0.77      0.87      0.82      3342
weighted avg       0.77      0.87      0.82      3342

{'eval_loss': 0.09926251322031021, 'eval_precision': 0.7665964172813488, 'eval_recall': 0.8707360861759426, 'eval_f1': 0.8153544410198935, 'eval_accuracy': 0.9733988142595466, 'eval_runtime': 25.1075, 'eval_samples_per_second': 67.032, 'eval_steps_per_second': 4.222, 'epoch': 0.45}
{'loss': 0.0621, 'learning_rate': 2.821905609973286e-05, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.76      0.88      0.82      1659
     UESTION       0.76      0.86      0.80      1683

   micro avg       0.76      0.87      0.81      3342
   macro avg       0.76      0.87      0.81      3342
weighted avg       0.76      0.87      0.81      3342

{'eval_loss': 0.12449227273464203, 'eval_precision': 0.7599789915966386, 'eval_recall': 0.8659485338120886, 'eval_f1': 0.8095104895104897, 'eval_accuracy': 0.9682498566062872, 'eval_runtime': 24.0667, 'eval_samples_per_second': 69.931, 'eval_steps_per_second': 4.404, 'epoch': 0.59}
{'loss': 0.0598, 'learning_rate': 2.7773820124666075e-05, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.80      0.86      0.83      1659
     UESTION       0.79      0.85      0.82      1683

   micro avg       0.79      0.85      0.82      3342
   macro avg       0.79      0.85      0.82      3342
weighted avg       0.79      0.85      0.82      3342

{'eval_loss': 0.1139141395688057, 'eval_precision': 0.7940439743946562, 'eval_recall': 0.8536804308797128, 'eval_f1': 0.8227829848594089, 'eval_accuracy': 0.9702692629959638, 'eval_runtime': 24.9175, 'eval_samples_per_second': 67.543, 'eval_steps_per_second': 4.254, 'epoch': 0.74}
{'loss': 0.0589, 'learning_rate': 2.7328584149599287e-05, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.83      0.88      0.86      1659
     UESTION       0.83      0.88      0.85      1683

   micro avg       0.83      0.88      0.85      3342
   macro avg       0.83      0.88      0.85      3342
weighted avg       0.83      0.88      0.85      3342

{'eval_loss': 0.08699475228786469, 'eval_precision': 0.8288212069937958, 'eval_recall': 0.8794135248354279, 'eval_f1': 0.8533681765389082, 'eval_accuracy': 0.9766869576479731, 'eval_runtime': 24.1048, 'eval_samples_per_second': 69.82, 'eval_steps_per_second': 4.397, 'epoch': 0.89}
{'loss': 0.0514, 'learning_rate': 2.6883348174532503e-05, 'epoch': 1.04}
              precision    recall  f1-score   support

       NSWER       0.81      0.88      0.85      1659
     UESTION       0.81      0.88      0.84      1683

   micro avg       0.81      0.88      0.85      3342
   macro avg       0.81      0.88      0.85      3342
weighted avg       0.81      0.88      0.85      3342

{'eval_loss': 0.09065725654363632, 'eval_precision': 0.8136577273983965, 'eval_recall': 0.8806104129263914, 'eval_f1': 0.8458111797672079, 'eval_accuracy': 0.977252602893249, 'eval_runtime': 24.0763, 'eval_samples_per_second': 69.903, 'eval_steps_per_second': 4.403, 'epoch': 1.04}
{'loss': 0.0418, 'learning_rate': 2.6438112199465718e-05, 'epoch': 1.19}
              precision    recall  f1-score   support

       NSWER       0.85      0.90      0.87      1659
     UESTION       0.85      0.90      0.87      1683

   micro avg       0.85      0.90      0.87      3342
   macro avg       0.85      0.90      0.87      3342
weighted avg       0.85      0.90      0.87      3342

{'eval_loss': 0.09198679029941559, 'eval_precision': 0.8488108720271801, 'eval_recall': 0.8970676241771395, 'eval_f1': 0.872272330520803, 'eval_accuracy': 0.9797927200928293, 'eval_runtime': 25.0608, 'eval_samples_per_second': 67.157, 'eval_steps_per_second': 4.23, 'epoch': 1.19}
{'loss': 0.0417, 'learning_rate': 2.5992876224398934e-05, 'epoch': 1.34}
              precision    recall  f1-score   support

       NSWER       0.84      0.90      0.87      1659
     UESTION       0.84      0.89      0.87      1683

   micro avg       0.84      0.89      0.87      3342
   macro avg       0.84      0.89      0.87      3342
weighted avg       0.84      0.89      0.87      3342

{'eval_loss': 0.0812009796500206, 'eval_precision': 0.8414084507042253, 'eval_recall': 0.8937761819269898, 'eval_f1': 0.8668020893789901, 'eval_accuracy': 0.9798455841344438, 'eval_runtime': 24.3453, 'eval_samples_per_second': 69.13, 'eval_steps_per_second': 4.354, 'epoch': 1.34}
{'loss': 0.0425, 'learning_rate': 2.5547640249332146e-05, 'epoch': 1.48}
              precision    recall  f1-score   support

       NSWER       0.84      0.89      0.87      1659
     UESTION       0.84      0.88      0.86      1683

   micro avg       0.84      0.89      0.86      3342
   macro avg       0.84      0.89      0.86      3342
weighted avg       0.84      0.89      0.86      3342

{'eval_loss': 0.07619322091341019, 'eval_precision': 0.8409994321408291, 'eval_recall': 0.886295631358468, 'eval_f1': 0.863053613053613, 'eval_accuracy': 0.9813865709475087, 'eval_runtime': 24.0054, 'eval_samples_per_second': 70.109, 'eval_steps_per_second': 4.416, 'epoch': 1.48}
{'loss': 0.038, 'learning_rate': 2.510240427426536e-05, 'epoch': 1.63}
              precision    recall  f1-score   support

       NSWER       0.84      0.89      0.86      1659
     UESTION       0.84      0.88      0.86      1683

   micro avg       0.84      0.88      0.86      3342
   macro avg       0.84      0.88      0.86      3342
weighted avg       0.84      0.88      0.86      3342

{'eval_loss': 0.09081831574440002, 'eval_precision': 0.8355970571590265, 'eval_recall': 0.8836026331538002, 'eval_f1': 0.8589296102385108, 'eval_accuracy': 0.9806570471732275, 'eval_runtime': 24.038, 'eval_samples_per_second': 70.014, 'eval_steps_per_second': 4.41, 'epoch': 1.63}
{'loss': 0.0409, 'learning_rate': 2.4657168299198577e-05, 'epoch': 1.78}
              precision    recall  f1-score   support

       NSWER       0.86      0.89      0.88      1659
     UESTION       0.87      0.89      0.88      1683

   micro avg       0.87      0.89      0.88      3342
   macro avg       0.87      0.89      0.88      3342
weighted avg       0.87      0.89      0.88      3342

{'eval_loss': 0.0720585510134697, 'eval_precision': 0.86558516801854, 'eval_recall': 0.8940754039497307, 'eval_f1': 0.8795996467471299, 'eval_accuracy': 0.9829249145584927, 'eval_runtime': 23.9362, 'eval_samples_per_second': 70.312, 'eval_steps_per_second': 4.428, 'epoch': 1.78}
{'loss': 0.041, 'learning_rate': 2.421193232413179e-05, 'epoch': 1.93}
              precision    recall  f1-score   support

       NSWER       0.86      0.90      0.88      1659
     UESTION       0.86      0.89      0.88      1683

   micro avg       0.86      0.90      0.88      3342
   macro avg       0.86      0.90      0.88      3342
weighted avg       0.86      0.90      0.88      3342

{'eval_loss': 0.08198479562997818, 'eval_precision': 0.8612866168868466, 'eval_recall': 0.8973668461998803, 'eval_f1': 0.8789566236811253, 'eval_accuracy': 0.9808314985105556, 'eval_runtime': 24.3786, 'eval_samples_per_second': 69.036, 'eval_steps_per_second': 4.348, 'epoch': 1.93}
{'loss': 0.031, 'learning_rate': 2.3766696349065005e-05, 'epoch': 2.08}
              precision    recall  f1-score   support

       NSWER       0.89      0.92      0.90      1659
     UESTION       0.89      0.91      0.90      1683

   micro avg       0.89      0.91      0.90      3342
   macro avg       0.89      0.91      0.90      3342
weighted avg       0.89      0.91      0.90      3342

{'eval_loss': 0.053131911903619766, 'eval_precision': 0.8913551401869159, 'eval_recall': 0.9132256134051466, 'eval_f1': 0.9021578480638486, 'eval_accuracy': 0.9855945486600287, 'eval_runtime': 24.0147, 'eval_samples_per_second': 70.082, 'eval_steps_per_second': 4.414, 'epoch': 2.08}
{'loss': 0.0287, 'learning_rate': 2.332146037399822e-05, 'epoch': 2.23}
              precision    recall  f1-score   support

       NSWER       0.87      0.91      0.89      1659
     UESTION       0.87      0.91      0.89      1683

   micro avg       0.87      0.91      0.89      3342
   macro avg       0.87      0.91      0.89      3342
weighted avg       0.87      0.91      0.89      3342

{'eval_loss': 0.0795898288488388, 'eval_precision': 0.8672768878718535, 'eval_recall': 0.9072411729503291, 'eval_f1': 0.8868090084820123, 'eval_accuracy': 0.9852297867728882, 'eval_runtime': 22.478, 'eval_samples_per_second': 74.873, 'eval_steps_per_second': 4.716, 'epoch': 2.23}
{'loss': 0.0307, 'learning_rate': 2.2876224398931436e-05, 'epoch': 2.37}
              precision    recall  f1-score   support

       NSWER       0.88      0.91      0.89      1659
     UESTION       0.87      0.90      0.89      1683

   micro avg       0.88      0.91      0.89      3342
   macro avg       0.88      0.91      0.89      3342
weighted avg       0.88      0.91      0.89      3342

{'eval_loss': 0.07840459048748016, 'eval_precision': 0.8752520887352349, 'eval_recall': 0.9090365050867744, 'eval_f1': 0.8918244532511376, 'eval_accuracy': 0.9836544383327739, 'eval_runtime': 22.1672, 'eval_samples_per_second': 75.923, 'eval_steps_per_second': 4.782, 'epoch': 2.37}
{'loss': 0.0284, 'learning_rate': 2.2430988423864648e-05, 'epoch': 2.52}
              precision    recall  f1-score   support

       NSWER       0.86      0.90      0.88      1659
     UESTION       0.86      0.90      0.88      1683

   micro avg       0.86      0.90      0.88      3342
   macro avg       0.86      0.90      0.88      3342
weighted avg       0.86      0.90      0.88      3342

{'eval_loss': 0.08162318915128708, 'eval_precision': 0.8613493424814179, 'eval_recall': 0.9015559545182525, 'eval_f1': 0.8809941520467836, 'eval_accuracy': 0.9820447282656101, 'eval_runtime': 22.2428, 'eval_samples_per_second': 75.665, 'eval_steps_per_second': 4.766, 'epoch': 2.52}
{'loss': 0.0293, 'learning_rate': 2.1985752448797863e-05, 'epoch': 2.67}
              precision    recall  f1-score   support

       NSWER       0.87      0.91      0.89      1659
     UESTION       0.87      0.90      0.89      1683

   micro avg       0.87      0.91      0.89      3342
   macro avg       0.87      0.91      0.89      3342
weighted avg       0.87      0.91      0.89      3342

{'eval_loss': 0.08462107181549072, 'eval_precision': 0.8715807659084365, 'eval_recall': 0.9057450628366248, 'eval_f1': 0.8883345561261922, 'eval_accuracy': 0.9830914362895786, 'eval_runtime': 22.1289, 'eval_samples_per_second': 76.055, 'eval_steps_per_second': 4.79, 'epoch': 2.67}
{'loss': 0.0301, 'learning_rate': 2.154051647373108e-05, 'epoch': 2.82}
              precision    recall  f1-score   support

       NSWER       0.87      0.91      0.89      1659
     UESTION       0.87      0.91      0.89      1683

   micro avg       0.87      0.91      0.89      3342
   macro avg       0.87      0.91      0.89      3342
weighted avg       0.87      0.91      0.89      3342

{'eval_loss': 0.08577441424131393, 'eval_precision': 0.8737417313776243, 'eval_recall': 0.9090365050867744, 'eval_f1': 0.8910397418976389, 'eval_accuracy': 0.9831548731395161, 'eval_runtime': 22.0671, 'eval_samples_per_second': 76.267, 'eval_steps_per_second': 4.804, 'epoch': 2.82}
{'train_runtime': 9336.8643, 'train_samples_per_second': 144.329, 'train_steps_per_second': 18.041, 'train_loss': 0.048381172742341695, 'epoch': 2.82}
              precision    recall  f1-score   support

       NSWER       0.87      0.90      0.88      5623
     UESTION       0.87      0.90      0.88      5693

   micro avg       0.87      0.90      0.88     11316
   macro avg       0.87      0.90      0.88     11316
weighted avg       0.87      0.90      0.88     11316

{'epoch': 2.82,
 'eval_accuracy': 0.9842096641839884,
 'eval_f1': 0.8827843596753896,
 'eval_loss': 0.058318234980106354,
 'eval_precision': 0.8673147437537307,
 'eval_recall': 0.8988158359844468,
 'eval_runtime': 75.4323,
 'eval_samples_per_second': 75.472,
 'eval_steps_per_second': 4.719}
Accuracy: 0.9842096641839884
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	3e-5	num_train_epochs	10	END 4744704: Thu 12 Oct 2023 01:41:09 PM EEST
