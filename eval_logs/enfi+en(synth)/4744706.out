START 4744706: Thu 12 Oct 2023 10:59:59 AM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/dataset_punct2', '../../data/qa_token_classification/annotated/train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/dataset_punct2', dev='../../data/qa_token_classification/dataset_punct2', batch=8, epochs=10, lr=1e-05, save=None, dataset=None)
0
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 134658
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
1
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
})
DatasetDict({
    train: Dataset({
        features: ['id', 'tags', 'tokens', 'text'],
        num_rows: 134758
    })
    validation: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 1683
    })
    test: Dataset({
        features: ['id', 'tags', 'tokens'],
        num_rows: 5693
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.1211, 'learning_rate': 9.851588008311073e-06, 'epoch': 0.15}
              precision    recall  f1-score   support

       NSWER       0.68      0.83      0.75      1659
     UESTION       0.68      0.82      0.74      1683

   micro avg       0.68      0.83      0.74      3342
   macro avg       0.68      0.83      0.74      3342
weighted avg       0.68      0.83      0.74      3342

{'eval_loss': 0.1435166746377945, 'eval_precision': 0.6773797841020608, 'eval_recall': 0.8261520047875524, 'eval_f1': 0.7444055001348072, 'eval_accuracy': 0.96220221024558, 'eval_runtime': 24.1354, 'eval_samples_per_second': 69.731, 'eval_steps_per_second': 4.392, 'epoch': 0.15}
{'loss': 0.0711, 'learning_rate': 9.703176016622144e-06, 'epoch': 0.3}
              precision    recall  f1-score   support

       NSWER       0.76      0.87      0.81      1659
     UESTION       0.76      0.86      0.81      1683

   micro avg       0.76      0.86      0.81      3342
   macro avg       0.76      0.86      0.81      3342
weighted avg       0.76      0.86      0.81      3342

{'eval_loss': 0.0786687433719635, 'eval_precision': 0.7568843430369787, 'eval_recall': 0.8635547576301615, 'eval_f1': 0.8067085953878407, 'eval_accuracy': 0.9761979652630383, 'eval_runtime': 24.0147, 'eval_samples_per_second': 70.082, 'eval_steps_per_second': 4.414, 'epoch': 0.3}
{'loss': 0.0594, 'learning_rate': 9.554764024933215e-06, 'epoch': 0.45}
              precision    recall  f1-score   support

       NSWER       0.77      0.89      0.83      1659
     UESTION       0.77      0.87      0.82      1683

   micro avg       0.77      0.88      0.82      3342
   macro avg       0.77      0.88      0.82      3342
weighted avg       0.77      0.88      0.82      3342

{'eval_loss': 0.10124418139457703, 'eval_precision': 0.7694320858414028, 'eval_recall': 0.8797127468581688, 'eval_f1': 0.820885104006701, 'eval_accuracy': 0.9751644732494733, 'eval_runtime': 24.1538, 'eval_samples_per_second': 69.678, 'eval_steps_per_second': 4.389, 'epoch': 0.45}
{'loss': 0.0542, 'learning_rate': 9.406352033244287e-06, 'epoch': 0.59}
              precision    recall  f1-score   support

       NSWER       0.81      0.89      0.85      1659
     UESTION       0.82      0.89      0.85      1683

   micro avg       0.82      0.89      0.85      3342
   macro avg       0.82      0.89      0.85      3342
weighted avg       0.82      0.89      0.85      3342

{'eval_loss': 0.07506739348173141, 'eval_precision': 0.8157822381083311, 'eval_recall': 0.8877917414721723, 'eval_f1': 0.8502650809571572, 'eval_accuracy': 0.9789601114373997, 'eval_runtime': 24.2266, 'eval_samples_per_second': 69.469, 'eval_steps_per_second': 4.375, 'epoch': 0.59}
{'loss': 0.0474, 'learning_rate': 9.25794004155536e-06, 'epoch': 0.74}
              precision    recall  f1-score   support

       NSWER       0.85      0.90      0.87      1659
     UESTION       0.85      0.90      0.87      1683

   micro avg       0.85      0.90      0.87      3342
   macro avg       0.85      0.90      0.87      3342
weighted avg       0.85      0.90      0.87      3342

{'eval_loss': 0.07304812967777252, 'eval_precision': 0.8467832957110609, 'eval_recall': 0.8979652902453621, 'eval_f1': 0.871623584083648, 'eval_accuracy': 0.984032416230318, 'eval_runtime': 24.0851, 'eval_samples_per_second': 69.877, 'eval_steps_per_second': 4.401, 'epoch': 0.74}
{'loss': 0.047, 'learning_rate': 9.10952804986643e-06, 'epoch': 0.89}
              precision    recall  f1-score   support

       NSWER       0.85      0.91      0.88      1659
     UESTION       0.85      0.90      0.88      1683

   micro avg       0.85      0.90      0.88      3342
   macro avg       0.85      0.90      0.88      3342
weighted avg       0.85      0.90      0.88      3342

{'eval_loss': 0.07027678936719894, 'eval_precision': 0.853789592760181, 'eval_recall': 0.9033512866546978, 'eval_f1': 0.8778714742657748, 'eval_accuracy': 0.9828958393356048, 'eval_runtime': 23.9696, 'eval_samples_per_second': 70.214, 'eval_steps_per_second': 4.422, 'epoch': 0.89}
{'loss': 0.0474, 'learning_rate': 8.961116058177501e-06, 'epoch': 1.04}
              precision    recall  f1-score   support

       NSWER       0.86      0.91      0.88      1659
     UESTION       0.85      0.90      0.87      1683

   micro avg       0.85      0.90      0.88      3342
   macro avg       0.85      0.90      0.88      3342
weighted avg       0.85      0.90      0.88      3342

{'eval_loss': 0.07518056780099869, 'eval_precision': 0.854148966298499, 'eval_recall': 0.9024536205864752, 'eval_f1': 0.8776371308016877, 'eval_accuracy': 0.9837390207993572, 'eval_runtime': 23.999, 'eval_samples_per_second': 70.128, 'eval_steps_per_second': 4.417, 'epoch': 1.04}
{'loss': 0.0349, 'learning_rate': 8.812704066488573e-06, 'epoch': 1.19}
              precision    recall  f1-score   support

       NSWER       0.86      0.91      0.88      1659
     UESTION       0.85      0.90      0.88      1683

   micro avg       0.86      0.91      0.88      3342
   macro avg       0.86      0.91      0.88      3342
weighted avg       0.86      0.91      0.88      3342

{'eval_loss': 0.08404537290334702, 'eval_precision': 0.8551256707144874, 'eval_recall': 0.9060442848593656, 'eval_f1': 0.8798489030945807, 'eval_accuracy': 0.9822667572403913, 'eval_runtime': 24.0995, 'eval_samples_per_second': 69.836, 'eval_steps_per_second': 4.398, 'epoch': 1.19}
{'loss': 0.0327, 'learning_rate': 8.664292074799646e-06, 'epoch': 1.34}
              precision    recall  f1-score   support

       NSWER       0.88      0.93      0.90      1659
     UESTION       0.88      0.92      0.90      1683

   micro avg       0.88      0.92      0.90      3342
   macro avg       0.88      0.92      0.90      3342
weighted avg       0.88      0.92      0.90      3342

{'eval_loss': 0.07153501361608505, 'eval_precision': 0.8782087849401027, 'eval_recall': 0.9213046080191503, 'eval_f1': 0.8992406542056076, 'eval_accuracy': 0.9837416640014379, 'eval_runtime': 24.5429, 'eval_samples_per_second': 68.574, 'eval_steps_per_second': 4.319, 'epoch': 1.34}
{'loss': 0.035, 'learning_rate': 8.515880083110716e-06, 'epoch': 1.48}
              precision    recall  f1-score   support

       NSWER       0.86      0.91      0.89      1659
     UESTION       0.86      0.91      0.89      1683

   micro avg       0.86      0.91      0.89      3342
   macro avg       0.86      0.91      0.89      3342
weighted avg       0.86      0.91      0.89      3342

{'eval_loss': 0.07018386572599411, 'eval_precision': 0.8625565610859729, 'eval_recall': 0.9126271693596649, 'eval_f1': 0.8868857225937773, 'eval_accuracy': 0.9856130510745938, 'eval_runtime': 24.0619, 'eval_samples_per_second': 69.944, 'eval_steps_per_second': 4.405, 'epoch': 1.48}
{'loss': 0.0357, 'learning_rate': 8.367468091421787e-06, 'epoch': 1.63}
              precision    recall  f1-score   support

       NSWER       0.86      0.92      0.89      1659
     UESTION       0.87      0.92      0.89      1683

   micro avg       0.87      0.92      0.89      3342
   macro avg       0.87      0.92      0.89      3342
weighted avg       0.87      0.92      0.89      3342

{'eval_loss': 0.06493508070707321, 'eval_precision': 0.8656674208144797, 'eval_recall': 0.9159186116098145, 'eval_f1': 0.8900843268391975, 'eval_accuracy': 0.9854121677164585, 'eval_runtime': 24.0838, 'eval_samples_per_second': 69.881, 'eval_steps_per_second': 4.401, 'epoch': 1.63}
{'loss': 0.0327, 'learning_rate': 8.21905609973286e-06, 'epoch': 1.78}
              precision    recall  f1-score   support

       NSWER       0.87      0.92      0.90      1659
     UESTION       0.87      0.92      0.90      1683

   micro avg       0.87      0.92      0.90      3342
   macro avg       0.87      0.92      0.90      3342
weighted avg       0.87      0.92      0.90      3342

{'eval_loss': 0.06754425913095474, 'eval_precision': 0.8716350240861434, 'eval_recall': 0.9204069419509275, 'eval_f1': 0.8953572987920244, 'eval_accuracy': 0.9867258391505805, 'eval_runtime': 24.0893, 'eval_samples_per_second': 69.865, 'eval_steps_per_second': 4.4, 'epoch': 1.78}
{'loss': 0.0339, 'learning_rate': 8.07064410804393e-06, 'epoch': 1.93}
              precision    recall  f1-score   support

       NSWER       0.89      0.92      0.90      1659
     UESTION       0.89      0.91      0.90      1683

   micro avg       0.89      0.92      0.90      3342
   macro avg       0.89      0.92      0.90      3342
weighted avg       0.89      0.92      0.90      3342

{'eval_loss': 0.07522258162498474, 'eval_precision': 0.8866666666666667, 'eval_recall': 0.9153201675643328, 'eval_f1': 0.9007656065959954, 'eval_accuracy': 0.9846535687192893, 'eval_runtime': 24.088, 'eval_samples_per_second': 69.869, 'eval_steps_per_second': 4.401, 'epoch': 1.93}
{'loss': 0.0282, 'learning_rate': 7.922232116355003e-06, 'epoch': 2.08}
              precision    recall  f1-score   support

       NSWER       0.89      0.92      0.91      1659
     UESTION       0.89      0.92      0.91      1683

   micro avg       0.89      0.92      0.91      3342
   macro avg       0.89      0.92      0.91      3342
weighted avg       0.89      0.92      0.91      3342

{'eval_loss': 0.08479712903499603, 'eval_precision': 0.8932095182820662, 'eval_recall': 0.9210053859964094, 'eval_f1': 0.906894519740719, 'eval_accuracy': 0.9868553560525363, 'eval_runtime': 22.9352, 'eval_samples_per_second': 73.381, 'eval_steps_per_second': 4.622, 'epoch': 2.08}
{'loss': 0.0207, 'learning_rate': 7.773820124666073e-06, 'epoch': 2.23}
              precision    recall  f1-score   support

       NSWER       0.88      0.92      0.90      1659
     UESTION       0.89      0.91      0.90      1683

   micro avg       0.88      0.91      0.90      3342
   macro avg       0.88      0.91      0.90      3342
weighted avg       0.88      0.91      0.90      3342

{'eval_loss': 0.07644419372081757, 'eval_precision': 0.8846711098232396, 'eval_recall': 0.9135248354278875, 'eval_f1': 0.8988664802002061, 'eval_accuracy': 0.9855099661934454, 'eval_runtime': 24.0052, 'eval_samples_per_second': 70.11, 'eval_steps_per_second': 4.416, 'epoch': 2.23}
{'loss': 0.022, 'learning_rate': 7.625408132977146e-06, 'epoch': 2.37}
              precision    recall  f1-score   support

       NSWER       0.88      0.92      0.90      1659
     UESTION       0.88      0.92      0.90      1683

   micro avg       0.88      0.92      0.90      3342
   macro avg       0.88      0.92      0.90      3342
weighted avg       0.88      0.92      0.90      3342

{'eval_loss': 0.06763125211000443, 'eval_precision': 0.8779019776440241, 'eval_recall': 0.9165170556552962, 'eval_f1': 0.8967940272288099, 'eval_accuracy': 0.987325846022906, 'eval_runtime': 24.1048, 'eval_samples_per_second': 69.82, 'eval_steps_per_second': 4.397, 'epoch': 2.37}
{'train_runtime': 7746.8581, 'train_samples_per_second': 173.952, 'train_steps_per_second': 21.744, 'train_loss': 0.04521860055923462, 'epoch': 2.37}
              precision    recall  f1-score   support

       NSWER       0.85      0.91      0.88      5623
     UESTION       0.85      0.91      0.88      5693

   micro avg       0.85      0.91      0.88     11316
   macro avg       0.85      0.91      0.88     11316
weighted avg       0.85      0.91      0.88     11316

{'epoch': 2.37,
 'eval_accuracy': 0.9849126934800106,
 'eval_f1': 0.8775030955125742,
 'eval_loss': 0.055502988398075104,
 'eval_precision': 0.8489054109871954,
 'eval_recall': 0.9080947331212442,
 'eval_runtime': 81.813,
 'eval_samples_per_second': 69.585,
 'eval_steps_per_second': 4.351}
Accuracy: 0.9849126934800106
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	1e-5	num_train_epochs	10	END 4744706: Thu 12 Oct 2023 01:16:12 PM EEST
