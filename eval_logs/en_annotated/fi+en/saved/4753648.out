
START 4753648: Fri 13 Oct 2023 12:56:58 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/annotated/cleaned2_train_annotated_dataset.jsonl'], test='../../data/qa_token_classification/annotated/en_test_dataset.jsonl', dev='../../data/qa_token_classification/annotated/en_dev_dataset.jsonl', batch=8, epochs=10, lr=3e-05, save='fi_en-ann_3e-5')
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 40
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 60
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 1.0145, 'learning_rate': 2.423076923076923e-05, 'epoch': 1.92}
              precision    recall  f1-score   support

       NSWER       0.00      0.03      0.00        40
     UESTION       0.00      0.00      0.00        92

   micro avg       0.00      0.01      0.00       132
   macro avg       0.00      0.01      0.00       132
weighted avg       0.00      0.01      0.00       132

{'eval_loss': 0.8763384819030762, 'eval_precision': 0.0012048192771084338, 'eval_recall': 0.007575757575757576, 'eval_f1': 0.002079002079002079, 'eval_accuracy': 0.5972560975609756, 'eval_runtime': 0.5089, 'eval_samples_per_second': 78.598, 'eval_steps_per_second': 5.895, 'epoch': 1.92}
{'loss': 0.7114, 'learning_rate': 1.8461538461538465e-05, 'epoch': 3.85}
              precision    recall  f1-score   support

       NSWER       0.01      0.07      0.02        40
     UESTION       0.01      0.02      0.01        92

   micro avg       0.01      0.04      0.02       132
   macro avg       0.01      0.05      0.02       132
weighted avg       0.01      0.04      0.02       132

{'eval_loss': 0.7436743974685669, 'eval_precision': 0.010416666666666666, 'eval_recall': 0.03787878787878788, 'eval_f1': 0.016339869281045753, 'eval_accuracy': 0.6669715447154472, 'eval_runtime': 0.4975, 'eval_samples_per_second': 80.403, 'eval_steps_per_second': 6.03, 'epoch': 3.85}
{'loss': 0.3087, 'learning_rate': 1.2692307692307693e-05, 'epoch': 5.77}
              precision    recall  f1-score   support

       NSWER       0.02      0.07      0.03        40
     UESTION       0.12      0.17      0.14        92

   micro avg       0.06      0.14      0.08       132
   macro avg       0.07      0.12      0.08       132
weighted avg       0.09      0.14      0.11       132

{'eval_loss': 0.7364646792411804, 'eval_precision': 0.05864197530864197, 'eval_recall': 0.14393939393939395, 'eval_f1': 0.08333333333333333, 'eval_accuracy': 0.6917682926829268, 'eval_runtime': 0.5098, 'eval_samples_per_second': 78.462, 'eval_steps_per_second': 5.885, 'epoch': 5.77}
{'loss': 0.1265, 'learning_rate': 6.923076923076923e-06, 'epoch': 7.69}
              precision    recall  f1-score   support

       NSWER       0.04      0.20      0.07        40
     UESTION       0.10      0.16      0.13        92

   micro avg       0.07      0.17      0.10       132
   macro avg       0.07      0.18      0.10       132
weighted avg       0.08      0.17      0.11       132

{'eval_loss': 0.7447565197944641, 'eval_precision': 0.06666666666666667, 'eval_recall': 0.17424242424242425, 'eval_f1': 0.09643605870020965, 'eval_accuracy': 0.7204268292682927, 'eval_runtime': 0.5283, 'eval_samples_per_second': 75.717, 'eval_steps_per_second': 5.679, 'epoch': 7.69}
{'loss': 0.054, 'learning_rate': 1.153846153846154e-06, 'epoch': 9.62}
              precision    recall  f1-score   support

       NSWER       0.06      0.28      0.10        40
     UESTION       0.16      0.22      0.18        92

   micro avg       0.10      0.23      0.14       132
   macro avg       0.11      0.25      0.14       132
weighted avg       0.13      0.23      0.16       132

{'eval_loss': 0.8015173077583313, 'eval_precision': 0.1, 'eval_recall': 0.23484848484848486, 'eval_f1': 0.1402714932126697, 'eval_accuracy': 0.7257113821138211, 'eval_runtime': 0.5129, 'eval_samples_per_second': 77.984, 'eval_steps_per_second': 5.849, 'epoch': 9.62}
{'train_runtime': 42.5679, 'train_samples_per_second': 23.492, 'train_steps_per_second': 3.054, 'train_loss': 0.427513824403286, 'epoch': 10.0}
saved model
              precision    recall  f1-score   support

       NSWER       0.06      0.23      0.09        79
     UESTION       0.12      0.25      0.16       109

   micro avg       0.08      0.24      0.12       188
   macro avg       0.09      0.24      0.13       188
weighted avg       0.09      0.24      0.13       188

{'epoch': 10.0,
 'eval_accuracy': 0.6862731302328854,
 'eval_f1': 0.12379642365887207,
 'eval_loss': 0.7596234083175659,
 'eval_precision': 0.08348794063079777,
 'eval_recall': 0.2393617021276596,
 'eval_runtime': 0.7297,
 'eval_samples_per_second': 82.226,
 'eval_steps_per_second': 5.482}
Accuracy: 0.6862731302328854
END 4753648: Fri 13 Oct 2023 12:58:01 PM EEST
