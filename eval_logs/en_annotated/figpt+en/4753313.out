START 4753313: Fri 13 Oct 2023 12:38:35 PM EEST
Namespace(model_name='xlm-roberta-base', train=['../../data/qa_token_classification/annotated/cleaned2_train_annotated_dataset.jsonl', '../../data/qa_token_classification/annotated/cleaned2_chatgpt_annotations_dataset.jsonl'], test='../../data/qa_token_classification/annotated/en_test_dataset.jsonl', dev='../../data/qa_token_classification/annotated/en_dev_dataset.jsonl', batch=8, epochs=10, lr=1e-05, save=None)
in dictionary: 0
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 100
    })
})
in dictionary: 1
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3424
    })
})
final train:
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3524
    })
})
DatasetDict({
    train: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 3524
    })
    validation: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 40
    })
    test: Dataset({
        features: ['tags', 'tokens', 'id', 'text'],
        num_rows: 60
    })
})
['QUESTION', 'ANSWER', 'O']
3
tokenization
training
{'loss': 0.8456, 'learning_rate': 9.43310657596372e-06, 'epoch': 0.57}
              precision    recall  f1-score   support

       NSWER       0.03      0.28      0.06        40
     UESTION       0.10      0.15      0.12        92

   micro avg       0.05      0.19      0.08       132
   macro avg       0.07      0.21      0.09       132
weighted avg       0.08      0.19      0.10       132

{'eval_loss': 0.6272820234298706, 'eval_precision': 0.052742616033755275, 'eval_recall': 0.1893939393939394, 'eval_f1': 0.08250825082508252, 'eval_accuracy': 0.7531504065040651, 'eval_runtime': 0.5526, 'eval_samples_per_second': 72.387, 'eval_steps_per_second': 5.429, 'epoch': 0.57}
{'loss': 0.6397, 'learning_rate': 8.866213151927438e-06, 'epoch': 1.13}
              precision    recall  f1-score   support

       NSWER       0.08      0.38      0.13        40
     UESTION       0.17      0.28      0.22        92

   micro avg       0.12      0.31      0.17       132
   macro avg       0.13      0.33      0.17       132
weighted avg       0.15      0.31      0.19       132

{'eval_loss': 0.5184875726699829, 'eval_precision': 0.12094395280235988, 'eval_recall': 0.3106060606060606, 'eval_f1': 0.17409766454352443, 'eval_accuracy': 0.829369918699187, 'eval_runtime': 0.6132, 'eval_samples_per_second': 65.232, 'eval_steps_per_second': 4.892, 'epoch': 1.13}
{'loss': 0.5653, 'learning_rate': 8.299319727891157e-06, 'epoch': 1.7}
              precision    recall  f1-score   support

       NSWER       0.12      0.30      0.17        40
     UESTION       0.22      0.33      0.26        92

   micro avg       0.18      0.32      0.23       132
   macro avg       0.17      0.31      0.22       132
weighted avg       0.19      0.32      0.24       132

{'eval_loss': 0.5633146166801453, 'eval_precision': 0.17872340425531916, 'eval_recall': 0.3181818181818182, 'eval_f1': 0.22888283378746596, 'eval_accuracy': 0.7943089430894309, 'eval_runtime': 0.5455, 'eval_samples_per_second': 73.324, 'eval_steps_per_second': 5.499, 'epoch': 1.7}
{'loss': 0.5329, 'learning_rate': 7.732426303854876e-06, 'epoch': 2.27}
              precision    recall  f1-score   support

       NSWER       0.10      0.35      0.16        40
     UESTION       0.15      0.21      0.17        92

   micro avg       0.13      0.25      0.17       132
   macro avg       0.13      0.28      0.17       132
weighted avg       0.14      0.25      0.17       132

{'eval_loss': 0.5037094950675964, 'eval_precision': 0.12692307692307692, 'eval_recall': 0.25, 'eval_f1': 0.1683673469387755, 'eval_accuracy': 0.7855691056910569, 'eval_runtime': 0.5042, 'eval_samples_per_second': 79.333, 'eval_steps_per_second': 5.95, 'epoch': 2.27}
{'loss': 0.4643, 'learning_rate': 7.165532879818595e-06, 'epoch': 2.83}
              precision    recall  f1-score   support

       NSWER       0.14      0.40      0.21        40
     UESTION       0.26      0.38      0.31        92

   micro avg       0.20      0.39      0.27       132
   macro avg       0.20      0.39      0.26       132
weighted avg       0.22      0.39      0.28       132

{'eval_loss': 0.5182732343673706, 'eval_precision': 0.20238095238095238, 'eval_recall': 0.38636363636363635, 'eval_f1': 0.26562499999999994, 'eval_accuracy': 0.7914634146341464, 'eval_runtime': 0.5241, 'eval_samples_per_second': 76.326, 'eval_steps_per_second': 5.724, 'epoch': 2.83}
{'loss': 0.422, 'learning_rate': 6.598639455782313e-06, 'epoch': 3.4}
              precision    recall  f1-score   support

       NSWER       0.13      0.38      0.20        40
     UESTION       0.25      0.36      0.30        92

   micro avg       0.20      0.36      0.26       132
   macro avg       0.19      0.37      0.25       132
weighted avg       0.22      0.36      0.27       132

{'eval_loss': 0.5041756629943848, 'eval_precision': 0.19753086419753085, 'eval_recall': 0.36363636363636365, 'eval_f1': 0.25599999999999995, 'eval_accuracy': 0.7742886178861789, 'eval_runtime': 0.5227, 'eval_samples_per_second': 76.521, 'eval_steps_per_second': 5.739, 'epoch': 3.4}
{'loss': 0.4067, 'learning_rate': 6.031746031746032e-06, 'epoch': 3.97}
              precision    recall  f1-score   support

       NSWER       0.10      0.38      0.16        40
     UESTION       0.21      0.28      0.24        92

   micro avg       0.15      0.31      0.20       132
   macro avg       0.16      0.33      0.20       132
weighted avg       0.18      0.31      0.22       132

{'eval_loss': 0.46394315361976624, 'eval_precision': 0.14909090909090908, 'eval_recall': 0.3106060606060606, 'eval_f1': 0.20147420147420145, 'eval_accuracy': 0.7914634146341464, 'eval_runtime': 0.4872, 'eval_samples_per_second': 82.107, 'eval_steps_per_second': 6.158, 'epoch': 3.97}
{'loss': 0.3078, 'learning_rate': 5.464852607709751e-06, 'epoch': 4.54}
              precision    recall  f1-score   support

       NSWER       0.12      0.38      0.19        40
     UESTION       0.17      0.27      0.21        92

   micro avg       0.15      0.30      0.20       132
   macro avg       0.14      0.32      0.20       132
weighted avg       0.15      0.30      0.20       132

{'eval_loss': 0.5152642726898193, 'eval_precision': 0.14705882352941177, 'eval_recall': 0.30303030303030304, 'eval_f1': 0.19801980198019803, 'eval_accuracy': 0.7949186991869919, 'eval_runtime': 0.4927, 'eval_samples_per_second': 81.186, 'eval_steps_per_second': 6.089, 'epoch': 4.54}
{'loss': 0.3381, 'learning_rate': 4.897959183673469e-06, 'epoch': 5.1}
              precision    recall  f1-score   support

       NSWER       0.08      0.30      0.12        40
     UESTION       0.17      0.20      0.18        92

   micro avg       0.11      0.23      0.15       132
   macro avg       0.12      0.25      0.15       132
weighted avg       0.14      0.23      0.16       132

{'eval_loss': 0.5386959314346313, 'eval_precision': 0.11450381679389313, 'eval_recall': 0.22727272727272727, 'eval_f1': 0.15228426395939085, 'eval_accuracy': 0.7767276422764228, 'eval_runtime': 0.4797, 'eval_samples_per_second': 83.393, 'eval_steps_per_second': 6.254, 'epoch': 5.1}
{'loss': 0.2808, 'learning_rate': 4.331065759637189e-06, 'epoch': 5.67}
              precision    recall  f1-score   support

       NSWER       0.09      0.30      0.13        40
     UESTION       0.19      0.21      0.20        92

   micro avg       0.13      0.23      0.17       132
   macro avg       0.14      0.25      0.16       132
weighted avg       0.16      0.23      0.18       132

{'eval_loss': 0.5817726850509644, 'eval_precision': 0.128099173553719, 'eval_recall': 0.23484848484848486, 'eval_f1': 0.1657754010695187, 'eval_accuracy': 0.7664634146341464, 'eval_runtime': 0.5311, 'eval_samples_per_second': 75.309, 'eval_steps_per_second': 5.648, 'epoch': 5.67}
{'loss': 0.2791, 'learning_rate': 3.7641723356009076e-06, 'epoch': 6.24}
              precision    recall  f1-score   support

       NSWER       0.12      0.30      0.17        40
     UESTION       0.19      0.20      0.19        92

   micro avg       0.15      0.23      0.18       132
   macro avg       0.15      0.25      0.18       132
weighted avg       0.17      0.23      0.19       132

{'eval_loss': 0.6413084268569946, 'eval_precision': 0.15228426395939088, 'eval_recall': 0.22727272727272727, 'eval_f1': 0.182370820668693, 'eval_accuracy': 0.7570121951219512, 'eval_runtime': 0.4813, 'eval_samples_per_second': 83.101, 'eval_steps_per_second': 6.233, 'epoch': 6.24}
{'loss': 0.2285, 'learning_rate': 3.1972789115646264e-06, 'epoch': 6.8}
              precision    recall  f1-score   support

       NSWER       0.11      0.35      0.16        40
     UESTION       0.17      0.17      0.17        92

   micro avg       0.13      0.23      0.17       132
   macro avg       0.14      0.26      0.17       132
weighted avg       0.15      0.23      0.17       132

{'eval_loss': 0.6637571454048157, 'eval_precision': 0.13215859030837004, 'eval_recall': 0.22727272727272727, 'eval_f1': 0.1671309192200557, 'eval_accuracy': 0.7603658536585366, 'eval_runtime': 0.482, 'eval_samples_per_second': 82.982, 'eval_steps_per_second': 6.224, 'epoch': 6.8}
{'train_runtime': 572.2488, 'train_samples_per_second': 61.582, 'train_steps_per_second': 7.706, 'train_loss': 0.4425740547180176, 'epoch': 6.8}
              precision    recall  f1-score   support

       NSWER       0.28      0.42      0.34        79
     UESTION       0.51      0.42      0.46       109

   micro avg       0.38      0.42      0.40       188
   macro avg       0.39      0.42      0.40       188
weighted avg       0.41      0.42      0.41       188

{'epoch': 6.8,
 'eval_accuracy': 0.8848941110251178,
 'eval_f1': 0.4000000000000001,
 'eval_loss': 0.3704550862312317,
 'eval_precision': 0.38164251207729466,
 'eval_recall': 0.42021276595744683,
 'eval_runtime': 0.7481,
 'eval_samples_per_second': 80.208,
 'eval_steps_per_second': 5.347}
Accuracy: 0.8848941110251178
PARAMETERS	model	xlm-roberta-base	data_dir	../../data/qa_token_classification	train_batch_size	8	learning_rate	1e-5	num_train_epochs	10	END 4753313: Fri 13 Oct 2023 12:48:47 PM EEST
