learning rate: 8e-6 treshold: 0.5 batch: 8 epochs: 3
Namespace(train_set=['data/CORE-corpus/train.tsv.gz', 'data/FinCORE_full/train.tsv', 'data/SweCORE/swe_train.tsv', 'data/FreCORE/fre_train.tsv'], dev_set=['data/CORE-corpus/dev.tsv.gz', 'data/FinCORE_full/dev.tsv', 'data/SweCORE/swe_dev.tsv', 'data/FreCORE/fre_dev.tsv'], test_set=['data/CORE-corpus/test.tsv.gz', 'data/FinCORE_full/test.tsv', 'data/SweCORE/swe_test.tsv', 'data/FreCORE/fre_test.tsv'], model='xlm-roberta-base', threshold=0.5, batch=8, epochs=3, learning=8e-06, save=True, weights=True)
DatasetDict({
    train: Dataset({
        features: ['text', 'label'],
        num_rows: 45597
    })
    dev: Dataset({
        features: ['text', 'label'],
        num_rows: 7609
    })
    test: Dataset({
        features: ['text', 'label'],
        num_rows: 14377
    })
})
sub-register mapping
filtering
train 44313
test 13915
dev 7349
binarization
tokenization
9
[('IN', tensor(2.3832, device='cuda:0')), ('NA', tensor(1.4511, device='cuda:0')), ('HI', tensor(0.4424, device='cuda:0')), ('LY', tensor(1.3703, device='cuda:0')), ('IP', tensor(9.3963, device='cuda:0')), ('SP', tensor(0.2612, device='cuda:0')), ('ID', tensor(0.5620, device='cuda:0')), ('OP', tensor(3.9046, device='cuda:0')), ('QA_NEW', tensor(8.0848, device='cuda:0'))]
training
{'loss': 0.3709, 'learning_rate': 7.759326113116727e-06, 'epoch': 0.09}
{'eval_loss': 0.3453142046928406, 'eval_f1': 0.0, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_roc_auc': 0.5, 'eval_accuracy': 0.007892230235406177, 'eval_runtime': 72.8368, 'eval_samples_per_second': 100.897, 'eval_steps_per_second': 3.158, 'epoch': 0.09}
{'loss': 0.3149, 'learning_rate': 7.518652226233453e-06, 'epoch': 0.18}
{'eval_loss': 0.26472046971321106, 'eval_f1': 0.1338345864661654, 'eval_precision': 0.6684549356223176, 'eval_recall': 0.07436142277393172, 'eval_roc_auc': 0.5345059888136923, 'eval_accuracy': 0.057014559804054975, 'eval_runtime': 69.21, 'eval_samples_per_second': 106.184, 'eval_steps_per_second': 3.323, 'epoch': 0.18}
{'loss': 0.2524, 'learning_rate': 7.27797833935018e-06, 'epoch': 0.27}
{'eval_loss': 0.23443110287189484, 'eval_f1': 0.47804961213877767, 'eval_precision': 0.836266030420519, 'eval_recall': 0.3346860825972786, 'eval_roc_auc': 0.6625908642995223, 'eval_accuracy': 0.3321540345625255, 'eval_runtime': 69.7515, 'eval_samples_per_second': 105.36, 'eval_steps_per_second': 3.297, 'epoch': 0.27}
{'loss': 0.2164, 'learning_rate': 7.037304452466907e-06, 'epoch': 0.36}
{'eval_loss': 0.21192647516727448, 'eval_f1': 0.5286343612334802, 'eval_precision': 0.8035062089116143, 'eval_recall': 0.393888756266412, 'eval_roc_auc': 0.6899589376263071, 'eval_accuracy': 0.3850864063137842, 'eval_runtime': 69.8779, 'eval_samples_per_second': 105.169, 'eval_steps_per_second': 3.291, 'epoch': 0.36}
{'loss': 0.1966, 'learning_rate': 6.796630565583635e-06, 'epoch': 0.45}
{'eval_loss': 0.20494069159030914, 'eval_f1': 0.5939800306100139, 'eval_precision': 0.762680142242186, 'eval_recall': 0.48639293387443305, 'eval_roc_auc': 0.7322205827206765, 'eval_accuracy': 0.45965437474486326, 'eval_runtime': 69.5409, 'eval_samples_per_second': 105.679, 'eval_steps_per_second': 3.307, 'epoch': 0.45}
{'loss': 0.1905, 'learning_rate': 6.555956678700361e-06, 'epoch': 0.54}
{'eval_loss': 0.18478703498840332, 'eval_f1': 0.617850316129981, 'eval_precision': 0.804364471669219, 'eval_recall': 0.5015516829792314, 'eval_roc_auc': 0.7419293480595653, 'eval_accuracy': 0.4904068580759287, 'eval_runtime': 69.2512, 'eval_samples_per_second': 106.121, 'eval_steps_per_second': 3.321, 'epoch': 0.54}
{'loss': 0.1855, 'learning_rate': 6.315282791817088e-06, 'epoch': 0.63}
{'eval_loss': 0.1836233139038086, 'eval_f1': 0.6331752192036797, 'eval_precision': 0.7957008670520231, 'eval_recall': 0.5257818095010742, 'eval_roc_auc': 0.7531009007687495, 'eval_accuracy': 0.5045584433256225, 'eval_runtime': 75.3729, 'eval_samples_per_second': 97.502, 'eval_steps_per_second': 3.051, 'epoch': 0.63}
{'loss': 0.1739, 'learning_rate': 6.074608904933814e-06, 'epoch': 0.72}
{'eval_loss': 0.17633338272571564, 'eval_f1': 0.6458617962177321, 'eval_precision': 0.8122626153011394, 'eval_recall': 0.5360467892098353, 'eval_roc_auc': 0.7590384042131444, 'eval_accuracy': 0.5226561436930195, 'eval_runtime': 70.2134, 'eval_samples_per_second': 104.667, 'eval_steps_per_second': 3.276, 'epoch': 0.72}
{'loss': 0.1757, 'learning_rate': 5.8339350180505415e-06, 'epoch': 0.81}
{'eval_loss': 0.17908218502998352, 'eval_f1': 0.6385147433563888, 'eval_precision': 0.8185551614709725, 'eval_recall': 0.5233946049176414, 'eval_roc_auc': 0.7532836120341544, 'eval_accuracy': 0.5057830997414614, 'eval_runtime': 69.2184, 'eval_samples_per_second': 106.171, 'eval_steps_per_second': 3.323, 'epoch': 0.81}
{'loss': 0.1761, 'learning_rate': 5.593261131167268e-06, 'epoch': 0.9}
{'eval_loss': 0.17289887368679047, 'eval_f1': 0.660859631586463, 'eval_precision': 0.822316986496091, 'eval_recall': 0.55239914060635, 'eval_roc_auc': 0.7675435101954936, 'eval_accuracy': 0.5339501973057559, 'eval_runtime': 69.0782, 'eval_samples_per_second': 106.387, 'eval_steps_per_second': 3.33, 'epoch': 0.9}
{'loss': 0.1773, 'learning_rate': 5.352587244283995e-06, 'epoch': 0.99}
{'eval_loss': 0.16881917417049408, 'eval_f1': 0.6461283415072183, 'eval_precision': 0.7668470241023119, 'eval_recall': 0.5582477918357603, 'eval_roc_auc': 0.7668149784447571, 'eval_accuracy': 0.5227922166281127, 'eval_runtime': 69.1703, 'eval_samples_per_second': 106.245, 'eval_steps_per_second': 3.325, 'epoch': 0.99}
{'loss': 0.1573, 'learning_rate': 5.111913357400721e-06, 'epoch': 1.08}
{'eval_loss': 0.17334666848182678, 'eval_f1': 0.6563515613960718, 'eval_precision': 0.8041897506925207, 'eval_recall': 0.5544282645022679, 'eval_roc_auc': 0.7674241282693463, 'eval_accuracy': 0.5358552183970609, 'eval_runtime': 69.864, 'eval_samples_per_second': 105.19, 'eval_steps_per_second': 3.292, 'epoch': 1.08}
{'loss': 0.1569, 'learning_rate': 4.8712394705174485e-06, 'epoch': 1.17}
{'eval_loss': 0.1726042926311493, 'eval_f1': 0.6526826484018264, 'eval_precision': 0.8112805959560128, 'eval_recall': 0.5459536882310814, 'eval_roc_auc': 0.7637667961609677, 'eval_accuracy': 0.5238808001088584, 'eval_runtime': 69.1138, 'eval_samples_per_second': 106.332, 'eval_steps_per_second': 3.328, 'epoch': 1.17}
{'loss': 0.1639, 'learning_rate': 4.630565583634176e-06, 'epoch': 1.26}
{'eval_loss': 0.16755610704421997, 'eval_f1': 0.6712754925682682, 'eval_precision': 0.7976014457039593, 'eval_recall': 0.5794939126283123, 'eval_roc_auc': 0.7790826902614927, 'eval_accuracy': 0.552183970608246, 'eval_runtime': 69.1351, 'eval_samples_per_second': 106.299, 'eval_steps_per_second': 3.327, 'epoch': 1.26}
{'loss': 0.1544, 'learning_rate': 4.389891696750903e-06, 'epoch': 1.35}
{'eval_loss': 0.16931307315826416, 'eval_f1': 0.678596295780532, 'eval_precision': 0.8143382352941176, 'eval_recall': 0.5816423967534018, 'eval_roc_auc': 0.7812043155970668, 'eval_accuracy': 0.5592597632330929, 'eval_runtime': 73.7497, 'eval_samples_per_second': 99.648, 'eval_steps_per_second': 3.119, 'epoch': 1.35}
{'loss': 0.1452, 'learning_rate': 4.149217809867629e-06, 'epoch': 1.44}
{'eval_loss': 0.1678510159254074, 'eval_f1': 0.6975231769752317, 'eval_precision': 0.8296576695194207, 'eval_recall': 0.6016949152542372, 'eval_roc_auc': 0.7918884354156684, 'eval_accuracy': 0.5837528915498708, 'eval_runtime': 70.7659, 'eval_samples_per_second': 103.849, 'eval_steps_per_second': 3.25, 'epoch': 1.44}
{'loss': 0.1473, 'learning_rate': 3.908543922984356e-06, 'epoch': 1.53}
{'eval_loss': 0.1612691879272461, 'eval_f1': 0.6741946657429857, 'eval_precision': 0.8033680039623576, 'eval_recall': 0.5808068751492003, 'eval_roc_auc': 0.7800940699863517, 'eval_accuracy': 0.5495985848414751, 'eval_runtime': 72.6174, 'eval_samples_per_second': 101.202, 'eval_steps_per_second': 3.167, 'epoch': 1.53}
{'loss': 0.1426, 'learning_rate': 3.667870036101083e-06, 'epoch': 1.62}
{'eval_loss': 0.16720595955848694, 'eval_f1': 0.6855236639099311, 'eval_precision': 0.8204957577774081, 'eval_recall': 0.5886846502745285, 'eval_roc_auc': 0.7850024362810761, 'eval_accuracy': 0.5700095251054565, 'eval_runtime': 71.1881, 'eval_samples_per_second': 103.233, 'eval_steps_per_second': 3.231, 'epoch': 1.62}
{'loss': 0.1448, 'learning_rate': 3.4271961492178097e-06, 'epoch': 1.71}
{'eval_loss': 0.16577427089214325, 'eval_f1': 0.6796156770581323, 'eval_precision': 0.8073575299720808, 'eval_recall': 0.5867748866077823, 'eval_roc_auc': 0.7832338847975809, 'eval_accuracy': 0.5600762008436522, 'eval_runtime': 69.3987, 'eval_samples_per_second': 105.895, 'eval_steps_per_second': 3.314, 'epoch': 1.71}
{'loss': 0.1493, 'learning_rate': 3.1865222623345365e-06, 'epoch': 1.81}
{'eval_loss': 0.16153806447982788, 'eval_f1': 0.6983037156704361, 'eval_precision': 0.800710095708552, 'eval_recall': 0.6191215087132967, 'eval_roc_auc': 0.7983857807576317, 'eval_accuracy': 0.5876990066675738, 'eval_runtime': 73.6266, 'eval_samples_per_second': 99.814, 'eval_steps_per_second': 3.124, 'epoch': 1.81}
{'loss': 0.1495, 'learning_rate': 2.9458483754512636e-06, 'epoch': 1.9}
{'eval_loss': 0.1599772572517395, 'eval_f1': 0.688229638785881, 'eval_precision': 0.8103169469598965, 'eval_recall': 0.5981141083790881, 'eval_roc_auc': 0.7889034956832338, 'eval_accuracy': 0.5659273370526602, 'eval_runtime': 69.4763, 'eval_samples_per_second': 105.777, 'eval_steps_per_second': 3.31, 'epoch': 1.9}
{'loss': 0.1543, 'learning_rate': 2.7051744885679904e-06, 'epoch': 1.99}
{'eval_loss': 0.1597902923822403, 'eval_f1': 0.698961937716263, 'eval_precision': 0.8097783367395064, 'eval_recall': 0.6148245404631177, 'eval_roc_auc': 0.7969384375012645, 'eval_accuracy': 0.5851136209008029, 'eval_runtime': 69.4963, 'eval_samples_per_second': 105.747, 'eval_steps_per_second': 3.31, 'epoch': 1.99}
{'loss': 0.1345, 'learning_rate': 2.464500601684717e-06, 'epoch': 2.08}
{'eval_loss': 0.1622508317232132, 'eval_f1': 0.6831451390801432, 'eval_precision': 0.8071916693784575, 'eval_recall': 0.5921460969205061, 'eval_roc_auc': 0.7858156172326507, 'eval_accuracy': 0.5697373792352701, 'eval_runtime': 74.0071, 'eval_samples_per_second': 99.301, 'eval_steps_per_second': 3.108, 'epoch': 2.08}
{'loss': 0.1389, 'learning_rate': 2.223826714801444e-06, 'epoch': 2.17}
{'eval_loss': 0.1617133915424347, 'eval_f1': 0.7008500877074618, 'eval_precision': 0.8060211049037864, 'eval_recall': 0.6199570303174982, 'eval_roc_auc': 0.7991584400241474, 'eval_accuracy': 0.5920533405905566, 'eval_runtime': 69.2921, 'eval_samples_per_second': 106.058, 'eval_steps_per_second': 3.319, 'epoch': 2.17}
{'loss': 0.1328, 'learning_rate': 1.983152827918171e-06, 'epoch': 2.26}
{'eval_loss': 0.16168291866779327, 'eval_f1': 0.6965390630312096, 'eval_precision': 0.8092905672302101, 'eval_recall': 0.6113630938171402, 'eval_roc_auc': 0.7952336823585987, 'eval_accuracy': 0.5853857667709893, 'eval_runtime': 69.1071, 'eval_samples_per_second': 106.342, 'eval_steps_per_second': 3.328, 'epoch': 2.26}
{'loss': 0.1338, 'learning_rate': 1.7424789410348978e-06, 'epoch': 2.35}
{'eval_loss': 0.1608772724866867, 'eval_f1': 0.7004677014844438, 'eval_precision': 0.8105098039215686, 'eval_recall': 0.616734304129864, 'eval_roc_auc': 0.7979106314548529, 'eval_accuracy': 0.5874268607973874, 'eval_runtime': 74.6941, 'eval_samples_per_second': 98.388, 'eval_steps_per_second': 3.079, 'epoch': 2.35}
{'loss': 0.1344, 'learning_rate': 1.5018050541516245e-06, 'epoch': 2.44}
{'eval_loss': 0.16155292093753815, 'eval_f1': 0.6971428571428572, 'eval_precision': 0.8105030053780449, 'eval_recall': 0.6116018142754834, 'eval_roc_auc': 0.7954309471287393, 'eval_accuracy': 0.5851136209008029, 'eval_runtime': 69.1898, 'eval_samples_per_second': 106.215, 'eval_steps_per_second': 3.324, 'epoch': 2.44}
{'loss': 0.1312, 'learning_rate': 1.2611311672683514e-06, 'epoch': 2.53}
{'eval_loss': 0.1607234627008438, 'eval_f1': 0.7007644949597457, 'eval_precision': 0.8088396064344838, 'eval_recall': 0.6181666268799236, 'eval_roc_auc': 0.7984882958681597, 'eval_accuracy': 0.5889236630834127, 'eval_runtime': 69.1089, 'eval_samples_per_second': 106.339, 'eval_steps_per_second': 3.328, 'epoch': 2.53}
{'loss': 0.1335, 'learning_rate': 1.0204572803850782e-06, 'epoch': 2.62}
{'eval_loss': 0.16071254014968872, 'eval_f1': 0.7003811598148652, 'eval_precision': 0.8148558758314856, 'eval_recall': 0.6141083790880878, 'eval_roc_auc': 0.7969352552781643, 'eval_accuracy': 0.5857939855762688, 'eval_runtime': 69.2004, 'eval_samples_per_second': 106.199, 'eval_steps_per_second': 3.324, 'epoch': 2.62}
{'train_runtime': 7650.5909, 'train_samples_per_second': 17.376, 'train_steps_per_second': 2.172, 'train_loss': 0.1736130723624394, 'epoch': 2.62}
F1: 0.7069285714285715
              precision    recall  f1-score   support

          IN       0.62      0.72      0.67       673
          NA       0.86      0.76      0.80      1088
          HI       0.84      0.54      0.65      3531
          LY       0.73      0.72      0.73      1423
          IP       0.91      0.82      0.86       168
          SP       0.89      0.71      0.79      5735
          ID       0.78      0.41      0.54      2647
          OP       0.64      0.66      0.65       376
      QA_NEW       0.58      0.74      0.65       186

   micro avg       0.81      0.63      0.71     15827
   macro avg       0.76      0.67      0.70     15827
weighted avg       0.82      0.63      0.70     15827
 samples avg       0.68      0.65      0.66     15827

saved
END: ma 5.6.2023 17.17.24 +0300
